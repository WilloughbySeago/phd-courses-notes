% !TeX program = lualatex
\documentclass[fleqn]{NotesClass}

\strictpagecheck

\usepackage{csquotes}
\usepackage{subcaption}

\usepackage[language=british]{biblatex}
\addbibresource{ref.bib}

\usepackage{tikz}
\usetikzlibrary{external}
\tikzexternalize[prefix=tikz-external/]

\usepackage{tikz-cd}
\AtBeginEnvironment{tikzcd}{\tikzexternaldisable}
\AtEndEnvironment{tikzcd}{\tikzexternalenable}

\usepackage[pdfauthor={Willoughby Seago},pdftitle={Notes from Algebraic Geometry Course},pdfkeywords={algebraic geometry},pdfsubject={Algebraic Geometry}]{hyperref}  % Should be loaded second last (cleveref last)
\colorlet{hyperrefcolor}{blue!60!black}
\hypersetup{colorlinks=true, linkcolor=hyperrefcolor, urlcolor=hyperrefcolor}
\usepackage[
capitalize,
nameinlink,
noabbrev
]{cleveref} % Should be loaded last

% My packages
\usepackage{NotesBoxes}
\usepackage{NotesMaths2}

\setmathfont[range={\int, \oint, \otimes, \oplus, \bigotimes, \bigoplus}]{Latin Modern Math}

\setmathfont[range={\mathscr}]{XITS Math}

% Highlight colour
\definecolor{my blue}{HTML}{084887}
\definecolor{my red}{HTML}{CA1551}
\definecolor{my green}{HTML}{17C3B2}
\definecolor{my yellow}{HTML}{F58A07}
\definecolor{my purple}{HTML}{CB9CF2}
\colorlet{highlight}{my green}

% Title page info
\title{Algebraic Geometry}
\author{Willoughby Seago}
\date{October 6th, 2025}
\subtitle{Notes from}
\subsubtitle{University of Glasgow}
\renewcommand{\abstracttext}{These are my notes from the SMSTC course \emph{Algebraic Geometry} taught by Dr Giulia Gugiatti and Prof Ivan Cheltsov. The lectures, and hence these notes, follow the \textit{Algebraic Geometry} notes of Andreas Gathmann. These notes were last updated at \printtime{} on \today{}.}

% Commands
% Maths
\newcommand{\subideal}{\trianglelefteq}
\newcommand{\affine}{\symbb{A}}
\newcommand{\projective}{\symbb{P}}
\newcommand{\ideal}[1]{\symfrak{#1}}
\newcommand{\isomorphic}{\cong}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\Kdim}{Kdim}
\newcommand{\sheaf}[1]{\symscr{#1}}
\newcommand{\id}{\symrm{id}}
\makeatletter
\newcommand{\c@egory}[1]{\symsfup{#1}}
\newcommand{\cat}[1]{\c@egory{#1}}
\newcommand{\Ring}{\c@egory{Ring}}
\newcommand{\CRing}{\c@egory{CRing}}
\newcommand{\affvar}{\c@egory{AffVar}}
\newcommand{\CAlg}[1]{\c@egory{CAlg}_{#1}}
\makeatother
\newcommand{\op}{\symrm{op}}
\newcommand{\Gr}{\symrm{Gr}}

\ExplSyntaxOn
% Create LaTeX interface command
\NewDocumentCommand{\projCoord}{ O{\mathord{:}} m }{  % optional arg is separator, mandatory
    %arg is comma separated list
    [
    \willoughby_projCoord:nn { #1 } { #2 }
    ]
}

\clist_new:N \l_willougbhy_projCoord_clist  % Create new clist variable
\cs_new_protected:Npn \willoughby_projCoord:nn #1 #2 {  % create LaTeX3 function
    \clist_set:Nn \l_willougbhy_projCoord_clist { #2 }  % set clist variable with
    %clist #2 passed by user
    \clist_use:Nn \l_willougbhy_projCoord_clist { #1 }  % print list separated by #1
}
\ExplSyntaxOff

\includeonly{appendices/comm-alg, appendices/topology}

\begin{document}
    \frontmatter
    \titlepage
    \innertitlepage{}
    \tableofcontents
    \listoffigures
    \mainmatter
    
    \chapter{Introduction}
    
    \section{Conventions and Notation}
    Throughout the notes the ground field, \(K\), will always be assumed to be \emph{algebraically closed}, up to the point where we introduce schemes.
    Taking \(K = \complex\) is usually reasonable.
    
    All rings, \(R\), are assumed to be \emph{commutative} with \emph{unity}.
    That \(J\) is an ideal of \(R\) will be denoted \(J \subideal R\).
    The ideal generated by a subset, \(S \subseteq R\), is denoted \(\langle S \rangle\).
    
    We write \(K[x_1, \dotsc, x_n]\) for the ring of polynomials with coefficients in \(K\) in the variables \(x_1, \dotsc, x_n\).
    We write \(f(a)\) to mean the evaluation of an element of this ring at the point \(a = (a_1, \dotsc, a_n) \in K^n\), and where no confusion may arise we'll usually call this point \(x = (x_1, \dotsc, x_n)\).
    
    The natural numbers, \(\naturals\), are assumed to contain \(0\).
    
    \section{Motivation}
    This section contains various motivating examples of algebro-geometric thinking, in varying levels of precision.
    Since the goal is to motivate some precision may be lacking.
    
    \subsection{Systems of Polynomial Equations}
    When we first learned algebra in high school it was to study the zeros of polynomials.
    Later we learned linear algebra, which it can be argued is the study of the zeros of systems of linear equations.
    Algebraic geometry combines these two fundamental fields into the study of zeros of systems of polynomials.
    
    Given \(f_1, \dotsc, f_m \in K[x_1, \dotsc, x_n]\) the basic object of study of algebraic geometry is the \defineindex{affine variety}
    \begin{equation}
        X = \{x \in K^n \mid f_i(x) = 0 \text{ for } i = 1, \dotsc, m\}.
    \end{equation}
    What questions can we ask about this set?
    Just as a single complex polynomial, \(f \in \complex[x]\), cannot be solved exactly for \(\deg f > 4\) we cannot possibly hope to explicitly list the points in \(X\).
    Instead we reason about the geometric structure of the solutions.
    We will ask geometric questions about \(X\), which we then aim to answer by an algebraic study of the \(f_i\).
    
    In the following sections we will give several examples of the sorts of geometric objects which can arise.
    We will focus on the existence of connections to other areas of mathematics.
    
    \subsection{Riemann Surfaces}
    Fix some positive integer, \(n\).
    We can define a curve\footnote{Note that this is a \enquote{curve} since it's complex dimension is \(1\) (we'll define dimension of affine varieties later, for now just use your intuition for the dimension of a manifold). Of course, in our pictures this single complex dimension is drawn as two real dimensions.}
    \begin{equation}
        c_n = \{(x, y) \in \complex^2 \mid y^2 = (x - 1)(x - 2)(x - 3) \dotsm (x - 2n)\} \subseteq \complex^2.
    \end{equation}
    We can view the defining equation as defining the quantity \(y\).
    Since we have \(y^2 = \dotso\) to find the value of \(y\) we have to take a square root.
    What we get depends on the value of \(x\).
    For most cases, specifically \(x \ne 1, 2, \dotsc, 2n\), we have
    \begin{equation}
        y = \pm \sqrt{(x - 1)(x - 2) \dotsm (x - 2n)}.
    \end{equation}
    For \(x = 1, 2, \dotsc, 2n\) we have
    \begin{equation}
        y = 0.
    \end{equation}
    Consider what values \(y\) can take.
    For \(x \ne 1, \dotsc, 2n\) we have two copies of \(\complex\), one for \(+ \sqrt{(x-1) \dotsm (x - 2n)}\) and one for \(-\sqrt{(x - 1) \dotsm (x - 2n)}\).
    For \(x = 1, \dotsc, 2n\) we only have one possible value, \(0\).
    The picture this suggests is two copies of \(\complex\) identified at the points \(1, \dotsc, 2n\).
    
    However, this isn't quite right.
    We know that \(z \in \complex^{\times}\) doesn't have a distinguished choice of \(\sqrt{z}\).
    Upon passing once around the origin they are exchanged.
    For example, if we take the path \(x = r\e^{i\theta}\), with \(r \ge 0\) fixed and \(\theta \in [0, 2\pi]\) then \(\sqrt{x} = \sqrt{r} \e^{i\theta/2}\).
    Then at \(\theta = 0\) we get \(\sqrt{r}\) and at \(\theta = 2\pi\) we get \(-\sqrt{r}\).
    The result is that as we go around the points \(x = 1, \dotsc, 2n\) we move from one copy of \(\complex\) to the other.
    
    Fortunately, we know how to deal with this, we take branch cuts between zeros.
    Take both copies of \(\complex\), and perform branch cuts along alternate intervals, \([1, 2], [3, 4], \dotsc, [2n - 1, 2n]\).
    For \(n = 3\) this produces \cref{fig:complex planes with branch cuts}.
    Now glue these along the cuts, which gives the picture \cref{fig:complex planes with branch cuts glued}.
    Finally, because it makes things nicer, add two points at infinity, one for each copy of \(\complex\), compactifying everything to get the picture \cref{fig:complex planes with branch cuts glued and compactified}.
    We see that this leaves us with a Riemann surface of genus \(g = n - 1\).
    This relates algebraic geometry to the theory of Riemann surfaces.
    
    \begin{figure}
        \centering
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{riemann-surface-1}
            \begin{tikzpicture}
                \draw [very thick, rounded corners=1, my blue, fill=my blue!50] (0, -2) -- (8, -2) -- (9, 0) -- (1, 0) -- cycle;
                \draw [very thick, rounded corners=1, my blue, fill=my blue!50] (0, -0.5) -- (8, -0.5) -- (9, 1.5) -- (1, 1.5) -- cycle;
                
                \foreach \i in {1, 3, 5} {
                    \fill [white]  (1 + \i, 0.5) .. controls (1.3 + \i, 0.7) and (1.7 + \i, 0.7) .. (2 + \i, 0.5) .. controls (1.7 + \i, 0.3) and (1.3 + \i, 0.3) .. (1 + \i, 0.5);
                    \fill [white] (1 + \i, -1) .. controls (1.3 + \i, -0.8) and (1.7 + \i, -0.8) .. (2 + \i, -1) .. controls (1.7 + \i, -1.2) and (1.3 + \i, -1.2) .. (1 + \i, -1);
                    \draw [thick, my red] (1 + \i, 0.5) .. controls (1.3 + \i, 0.7) and (1.7 + \i, 0.7) .. (2 + \i, 0.5);
                    \draw [thick, my red] (1 + \i, 0.5) .. controls (1.3 + \i, 0.3) and (1.7 + \i, 0.3) .. (2 + \i, 0.5);
                    \draw [thick, my red] (1 + \i, -1) .. controls (1.3 + \i, -0.8) and (1.7 + \i, -0.8) .. (2 + \i, -1);
                    \draw [thick, my red] (1 + \i, -1) .. controls (1.3 + \i, -1.2) and (1.7 + \i, -1.2) .. (2 + \i, -1);
                }
                \foreach \i in {1, 2, 3, 4, 5, 6} {
                    \fill [my red] (1 + \i, 0.5) circle [radius=0.05];
                    \fill [my red] (1 + \i, -1) circle [radius=0.05];
                }
            \end{tikzpicture}
            \caption{Branch cuts along alternate intervals.}
            \label{fig:complex planes with branch cuts}
        \end{subfigure}
        
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{riemann-surface-2}
            \begin{tikzpicture}
                \fill [my blue!50] (0, 0) arc (180:270:1) arc (90:0:1) arc (360:270:1) arc (90:180:1) -- ++ (10, 0) arc (0:90:1) arc (270:180:1) arc (180:90:1) arc (270:360:1) -- cycle;
                \draw [very thick, my blue] (0, 0) arc (180:270:1) arc (90:0:1) arc (360:270:1) arc (90:180:1);
                \draw [very thick, my blue] (10, -4) arc (0:90:1) arc (270:180:1) arc (180:90:1) arc (270:360:1);
                \draw [very thick, my blue, fill=white] (3.75, -2) circle [x radius = 0.5, y radius = 0.75];
                \draw [very thick, my blue, fill=white] (6.25, -2) circle [x radius = 0.5, y radius = 0.75];
                \draw [my red, very thick] (2, -2) .. controls (2.4, -2.2) and (2.85, -2.2) .. (3.25, -2);
                \draw [my red, very thick] (4.25, -2) .. controls (4.8, -2.2) and (5.2, -2.2) .. (5.75, -2);
                \draw [my red, very thick] (6.75, -2) .. controls (7.15, -2.2) and (7.6, -2.2) .. (8, -2);
                \draw [my red, very thick, dashed] (2, -2) .. controls (2.4, -1.8) and (2.85, -1.8) .. (3.25, -2);
                \draw [my red, very thick, dashed] (4.25, -2) .. controls (4.8, -1.8) and (5.2, -1.8) .. (5.75, -2);
                \draw [my red, very thick, dashed] (6.75, -2) .. controls (7.15, -1.8) and (7.6, -1.8) .. (8, -2);
            \end{tikzpicture}
            \caption{Gluing along branch cuts.}
            \label{fig:complex planes with branch cuts glued}
        \end{subfigure}
        
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{riemann-surface-3}
            \begin{tikzpicture}
                \draw [very thick, my blue, fill=my blue!50] (0.5, 0.5) arc (90:180:0.5) arc (180:270:1) arc (90:0:1) arc (360:270:1) arc (90:180:1) arc (180:270:0.5) -- ++ (9, 0) arc (270:360:0.5) arc (0:90:1) arc (270:180:1) arc (180:90:1) arc (270:360:1) arc (0:90:0.5) -- cycle;
                \draw [very thick, my blue, fill=white] (3.75, -2) circle [x radius = 0.5, y radius = 0.75];
                \draw [very thick, my blue, fill=white] (6.25, -2) circle [x radius = 0.5, y radius = 0.75];
            \end{tikzpicture}
            \caption{Compactification by adding a point at infinity for each plane.}
            \label{fig:complex planes with branch cuts glued and compactified}
        \end{subfigure}
        \caption{Producing a Riemann surface from a curve}
    \end{figure}
    
    We can change our curve to
    \begin{equation}
        \{(x, y) \in \complex^2 \mid y^2 = (x - 1)^2(x - 2)(x - 3) \dotsm (x - 2n)\} \subseteq \complex^2.
    \end{equation}
    Then the same analysis can be applied, except that we have a singular point at the repeated root, \(x = 1\).
    This relates algebraic geometry to singularity theory.
    
    \subsection{Lines on Spaces}
    Consider the surface
    \begin{equation}
        X = \{(x_1, x_2, x_3) \in \reals^3 \mid 1 + x_1^3 + x_2^3 + x_3^3 - (1 + x_1 + x_2 + x_3)\} \subseteq \reals^3.
    \end{equation}
    This is called the \defineindex{Clebsch surface}.
    It's plotted in \cref{fig:clebsch surface}.
    This is a cubic surface because it's defined by a single cubic equation.
    It's possible to draw straight lines on this surface.
    One can ask how many such straight lines exist.
    The answer over \(\complex\), surprisingly, is always 27, at least under some mild conditions.
    The Clebsch surface has the nice property that all of these lines are real.
    Cubic surfaces are actually a weird middle ground, between the infinite families of lines on a quadratic surface, and the general absence of lines on surfaces defined by any higher degree equation.
    
    \begin{figure}
        \centering
        \includegraphics[width=0.8\textwidth]{images/clebsch-surface}
        \caption{The Clebsch surface, as well as the 27 lines which lie on it.}
    \end{figure}
    
    The question of how many geometric objects of a certain type exist is one of enumerative geometry, which makes heavy use of algebraic geometry.
    
    \subsection{String Theory}
    Strings, world sheets, those are surfaces, physicists should care about algebraic geometry.
    
    \subsection{Curves in Space}
    Consider the following curve
    \begin{equation}
        X = \{(x_1, x_2, x_3) = (t^3, t^4, t^5) \mid t \in \complex\} \subseteq \complex^3.
    \end{equation}
    This is a parametric definition of this surface.
    We can equally define it explicitly as
    \begin{equation}
        X = \{(x_1, x_2, x_3) \mid x_1^3 = x_2x_3, x_2^2 = x_1x_3, x_3^2 = x_1^2x_2\} \subseteq \complex^3.
    \end{equation}
    This is a surface, so it's two (complex) dimensional.
    However, we need all three of these equations to define it, if we remove any of them we don't get the same surface.
    This is very different to the world of linear algebra, where we'd have linear defining relations.
    There any codimension \(d\) subspace can be defined by \(d\) (linear) equations.
    Here \(X\) is one-dimensional, so it has codimension \(2\), but we need three equations to define it.
    
    The general problem of taking an affine variety, \(X\), defined as the vanishing set of some polynomials, and determining its dimension is actually very hard.
    We can use Gr\"obner bases to do this, but the algebra is pretty unwieldy, and we're forced to use computers to solve it most of the time.
    A Gr\"obner basis is a certain generating set of the ideal generated by the polynomials defining the affine variety.
    Actually, even defining dimension for an arbitrary affine variety is not that straight forward, but for now the intuition from manifolds and vector spaces should be enough.
    
    \subsection{Different Fields}
    Over \(\reals\) or \(\complex\) we can use real or complex analytic methods to study the zeros of polynomials, and hence affine varieties.
    
    Over \(\rationals\) or finite fields we can use number theoretic techniques to study the zeros of polynomials, and hence affine varieties.
    
    For example, Fermat's last theorem can be stated as the study of the affine variety
    \begin{equation}
        X = \{(x_1, x_2, x_3) \in \rationals^3 \mid x_1^n + x_2^n = x_3^n\},
    \end{equation}
    where the question we ask is if this has any non-trivial points.
    
    \chapter{Affine Varieties}
    \section{Affine Varieties}
    \begin{dfn}{Affine Space}{}
        \define{Affine \(\symbb{n}\)-space}\index{affine n-space@affine \(n\)-space} over \(K\) is the set
        \begin{equation}
            \affine^n = \affine_K^n \coloneq \{(a_1, \dotsc, a_n) \mid a_i \in K \forall i = 1, \dotsc, n\}.
        \end{equation}
    \end{dfn}
    
    Note that as sets \(\affine^n = K^n\).
    However, we write \(\affine^n\) when we wish to forget the additional algebraic structure of \(K^n\), specifically the vector space and ring, that is, we want to forget about the ability to scale, add and multiply elements.
    
    For the time being we will take \(\affine^n\) as our ambient space.
    Then a polynomial, \(f \in K[x_1, \dotsc, x_n]\), defines a \defineindex{polynomial function}
    \begin{align}
        \affine^n &\to K\\
        a &\mapsto f(a).
    \end{align}
    We'll usually call this function \(f\) as well.
    
    \begin{dfn}{Affine Variety}{}
        Let \(S \subseteq K[x_1, \dotsc, x_n]\) be some set of polynomials.
        The \defineindex{zero locus} or \defineindex{vanishing set} of \(S\), denoted \(V(S)\), is all points of \(\affine^n\) on which the polynomial functions defined by polynomials in \(S\) vanish.
        That is,
        \begin{equation}
            V(S) \coloneq \{x \in \affine^n \mid f(x) = 0 \forall f \in S\} \subseteq \affine^n
        \end{equation}
        Any subset of \(\affine^n\) of this form is called an \defineindex{affine variety}.
    \end{dfn}
    
    \begin{wrn}
        Note that some authors require that affine varieties have the additional property of being irreducible.
        These authors would then call all sets like \(V(S)\) \define{affine algebraic sets}\index{affine algebraic set}.
    \end{wrn}
    
    \begin{ntn}{}{}
        If \(S = \{f_1, \dotsc, f_n\}\) is a finite set we write
        \begin{equation}
            V(S) = V(\{f_1, \dotsc, f_n\}) = V(f_1, \dotsc, f_n).
        \end{equation}
    \end{ntn}
    
    There are some properties we can immediately prove about affine varieties.
    
    \begin{lma}{Reversal of Inclusion}{lma:V reverses inclusion}
        If \(S_1 \subseteq S_2 \subseteq K[x_1, \dotsc, x_n]\) then \(V(S_2) \subseteq V(S_1)\).
        \begin{proof}
            Suppose \(x \in V(S_2)\).
            Then \(f(x) = 0\) for all \(f \in S_2\), and so certainly \(f(x) = 0\) for \(f \in S_1 \subseteq S_2\), and thus \(x \in V(S_1)\).
        \end{proof}
    \end{lma}
    
    \begin{lma}{Union}{lma:union of defining equations}
        If \(S_1, S_2 \subseteq K[x_1, \dotsc, x_n]\) then \(V(S_1) \cup V(S_2) = V(S_1 S_2)\) where
        \begin{equation}
            S_1 S_2 = \{fg \mid f \in S_1, g \in S_2\}.
        \end{equation}
        \begin{proof}
            We start by showing that \(V(S_1) \cup V(S_2) \subseteq V(S_1 S_2)\).
            Suppose that \(x \in V(S_1) \cup V(S_2)\).
            Then \(x \in V(S_1)\), so \(f(x) = 0\) for all \(f \in S_1\), and \(x \in V(S_2)\), so \(g(x) = 0\) for all \(g \in S_2\).
            Thus, for \(f \in S_1\) and \(g \in S_2\) we have \((fg)(x) = f(x)g(x) = 0 \cdot 0 = 0\), so \(x \in V(S_1S_2)\).
            
            We now show that \(V(S_1S_2) \subseteq V(S_1) \cup V(S_2)\).
            We do so by supposing that \(x \notin V(S_1) \cup V(S_2)\).
            Then there exist polynomials, \(f \in S_1\) and \(g \in S_2\), for which \(f(x) \ne 0\) and \(g(x) \ne 0\).
            Thus, \((fg)(x) = f(x)g(x) \ne 0\) (since we work in a field, so have no nonzero zero divisors).
            Thus, \(x \notin V(S_1S_2)\) since \(fg \in S_1S_2\).
            By the contrapositive then we have that if \(x \in V(S_1S_2)\) then \(x \in V(S_1) \cup V(S_2)\).
        \end{proof}
    \end{lma}
    
    \begin{lma}{Intersection}{lma:intersection of defining equations}
        Let \(J\) be an index set, and \(\{S_j\}_{j \in J}\) an indexed family of subsets of \(K[x_1, \dotsc, x_n]\).
        Then
        \begin{equation}
            \bigcap_{j \in J} V(S_j) = V\left( \bigcup_{j \in J} S_j \right).
        \end{equation}
        \begin{proof}
            Suppose \(x \in \bigcap_{j \in J} V(S_j)\).
            Then \(x \in V(S_j)\) for all \(j \in J\).
            Thus, \(f(x) = 0\) for all \(f \in S_j\) for all \(j \in J\).
            Thus, \(x \in V\left( \bigcup_{j \in J} S_j \right)\).
            
            Conversely, suppose \(x \in V\left( \bigcup_{j \in J} S_j \right)\).
            Then \(f(x) = 0\) for all \(f \in \bigcup_{j \in J} S_j\), which means \(f(x) = 0\) for all \(f \in S_j\) for any \(j \in J\), and therefore \(x \in \bigcap_{j \in J} V(S_j)\).
        \end{proof}
    \end{lma}
    
    We can also give some examples of simple affine varieties.
    
    \begin{exm}{Affine Varieties}{exm:affine varieties}
        \begin{enumerate}
            \item Affine \(n\)-space is itself an affine variety.
            Specifically, \(\affine^n = V(0)\), since the zero polynomial vanishes.
            \item The empty set is an affine variety.
            Specifically, \(\emptyset = V(1)\), since the constant polynomial at \(1\) vanishes nowhere.
            \item Any linear subspace of \(K^n = \affine^n\) is an affine variety since a linear subspace is defined by the vanishing of linear equations.
            \item If \(X \subseteq \affine^n\) and \(Y \subseteq \affine^m\) are affine varieties then \(X \times Y\) is too when viewed as a subspace of \(\affine^{m + n}\).
            The defining equations of \(X \times Y\) are those of \(X\) and \(Y\) where we view those of \(X\) as a function of \(x_1, \dotsc, x_m\) and those of \(Y\) as a function of \(x_{m + 1}, \dotsc, x_{m + n}\).
        \end{enumerate}
    \end{exm}
    
    \begin{remark}{}{}
        The above results say that \(\emptyset\) and \(\affine^n\) are both affine varieties, and that affine varieties are closed under finite union and arbitrary intersections.
        This is very close to the definition of a topology on \(\affine^n\) in terms of open sets, \(\emptyset\) and \(X\) should be open, and the topology should be closed under finite intersections and arbitrary unions.
        Notice how unions and intersections exchange roles.
        Instead what we have is actually the requirements to define a topology on \(\affine^n\) via the \emph{closed} sets.
        We'll do exactly this in \cref{chap:zariski topology}.
    \end{remark}
    
    \begin{exm}{Affine {\normalsize \(1\)}-Space}{exm:affine varieties of A1}
        The only affine varieties in \(\affine^1\) are \(\affine^1\), \(\emptyset\), and all finite sets.
        Any finite set, \(\{\alpha_1, \dotsc, \alpha_n\}\), is the vanishing set of \((x - \alpha_1) \dotsm (x - \alpha_n)\).
        To show that infinite sets cannot be affine varieties here (other than \(\affine^1\)) suppose \(X = V(S)\) is infinite for some \(S \subseteq K[x]\).
        Fix some \(f \in S\).
        Then \(\{f\} \subseteq S\), so by \cref{lma:V reverses inclusion} \(V(S) \subseteq V(f)\), and so \(x \in V(f)\) for all \(x \in X\), which means that \(f(x) = 0\) for all \(x \in X\), and so \(f\) has infinitely many roots, which is not possible for a polynomial.
    \end{exm}
    
    If \(f, g \in K[x_1, \dotsc, x_n]\) vanish on \(X \subseteq \affine^n\) then so do \(f + g\) and \(f h\) for any \(h \in K[x_1, \dotsc, x_n]\).
    Thus, the set, \(S\), defining an affine variety, \(X = V(S)\), is certainly not unique.
    We can always add \(f + g\) and \(fh\).
    From this we see that \(V(S) = V(\langle S \rangle)\) where \(\langle S \rangle \subideal K[x_1, \dotsc, x_n]\) is the ideal generated by \(S\).
    This means that any affine variety can be expressed as the vanishing set of some ideal of a polynomial ring.
    
    Hilbert's basis theorem (\cref{thm:hilberts basis theorem,crl:poly ring over noetherian is noetherian}) along with a standard characterisation of noetherian rings (\cref{lma:noetherian iff all ideals finitely generated}) tells us that all ideals of \(K[x_1, \dotsc, x_n]\) are finitely generated.
    Given an affine variety, \(X = V(S)\), we can then take \(X = V(\langle S \rangle)\), and then we can find some finite generating set for this ideal, \(S'\).
    Then \(X = V(S')\).
    Thus, every affine variety is the zero locus of a finite set of polynomials.
    
    \begin{dfn}{Radical}{}
        Let \(R\) be a ring with ideal \(J\).
        The \defineindex{radical} of \(J\) is
        \begin{equation}
            \sqrt{J} = \{f \in R \mid f^k \in J \text{ for some } k \in \naturals\}.
        \end{equation}
        We say \(J\) is \define{radical} if \(J = \sqrt{J}\).
    \end{dfn}
    
    \begin{lma}{}{lma:ideal is subset of its radical}
        Let \(J \subideal R\).
        Then \(J \subseteq \sqrt{J}\).
        \begin{proof}
            Suppose that \(f \in J\), then \(f^1 \in J\), and so \(f \in \sqrt{J}\).
        \end{proof}
    \end{lma}
    
    We can now state some results which are the analogues of \cref{lma:V reverses inclusion,lma:union of defining equations,lma:intersection of defining equations} when we work with zero loci of ideals.
    
    \begin{lma}{}{}
        Let \(J \subideal K[x_1, \dotsc, x_n]\).
        Then \(V(\sqrt{J}) = V(J)\).
        \begin{proof}
            First, \cref{lma:ideal is subset of its radical} gives us \(J \subseteq \sqrt{J}\).
            Thus, by \cref{lma:V reverses inclusion} we have that \(V(\sqrt{J}) \subseteq V(J)\).
            
            Now suppose that \(x \in V(J)\) and \(f \in \sqrt{J}\).
            Then \(f^k \in J\), so \(f^k(x) = 0\), and since we're in a field with no nonzero zero divisors we must have that \(f(x) = 0\), and so \(x \in V(\sqrt{J})\).
        \end{proof}
    \end{lma}
    
    This result, combined with our earlier analysis, means that every affine variety is the zero locus of a radical ideal.
    
    \begin{lma}{Union}{lma:union of ideals with V}
        If \(J_1, J_2 \subideal K[x_1, \dotsc, x_n]\) then \(V(J_1) \cup V(J_2) = V(J_1 J_2) = V(J_1 \cap J_2)\).
        \begin{proof}
            That \(V(J_1) \cup V(J_2) = V(J_1 J_2)\) is \cref{lma:union of defining equations}.
            It remains to show that \(V(J_1 J_2) = V(J_1 \cap J_2)\).
            Note that it is not generally true that \(J_1 J_2 \stackrel{!}{=} J_1 \cap J_2\).
            However, it is true that \(\sqrt{J_1J_2} = \sqrt{J_1 \cap J_2}\) (\cref{lma:radical of product is radical of intersection}), and the result follows from this.
        \end{proof}
    \end{lma}
    
    \begin{lma}{Intersection}{}
        If \(J_1, J_2 \subideal K[x_1, \dotsc, x_n]\) then \(V(J_1) \cap V(J_2) = V(J_1 + J_2)\).
        \begin{proof}
            From \cref{lma:intersection of defining equations} we have that \(V(J_1) \cap V(J_2) = V(J_1 \cup J_2)\).
            We also have that \(\langle J_1 \cup J_2 \rangle = J_1 + J_2\), so \(V(J_1 \cup J_2) = V(\langle J_1 \cup J_2 \rangle) = V(J_1 + J_2)\).
        \end{proof}
    \end{lma}
    
    \begin{remark}{}{}
        With these results we have set up a pairing between geometric objects and algebraic objects.
        Specifically, we've defined a map
        \begin{align}
            V \colon \{\text{algebraic objects}\} &\to \{\text{geometric objects}\}\\
            \text{ideal} &\mapsto \text{affine variety}.
        \end{align}
        Studying the map going in the opposite direction will be the focus of the next section.
    \end{remark}
    
    \section{Ideal of an Affine Variety}
    \begin{dfn}{Ideal}{}
        Let \(X\) be a subset of \(\affine^n\).
        The \defineindex{ideal} of \(X\) is
        \begin{equation}
            I(X) \coloneq \{f \in K[x_1, \dotsc, x_n] \mid f(x) = 0 \forall x \in X\}.
        \end{equation}
    \end{dfn}
    
    This is indeed an ideal, if \(f, g \in I(X)\) then \(f(x) = g(x) = 0\) for all \(x \in X\) and \(f(x) + g(x) = 0\), so \(f + g \in I(X)\), and \(-f(x) = 0\) so \(-f \in I(X)\), and if \(h \in K[x_1,\dotsc, x_n]\) then \(f(x)h(x) = 0h(x) = 0\) so \(fh \in I(X)\).
    
    \begin{lma}{Reversal of Inclusion}{lma:I reverses inclusion}
        Suppose \(X_1 \subseteq X_2 \subseteq \affine^n\).
        Then \(I(X_2) \subseteq I(X_1)\).
        \begin{proof}
            Suppose that \(f \in I(X_2)\), that is, \(f(x) = 0\) for all \(x \in X_2\).
            Then \(f(x) = 0\) for all \(x \in X_1 \subseteq X_2\), and so \(f \in I(X_1)\).
        \end{proof}
    \end{lma}
    
    \begin{lma}{Ideal is Radical}{}
        If \(X \subseteq \affine^n\) then \(I(X)\) is radical.
        \begin{proof}
            Suppose \(f \in \sqrt{I(X)}\).
            Then \(f^k \in I(X)\) for some \(k \in \naturals\).
            Then \(f^k(x) = 0\) for all \(x \in X\), and since we're in a field \(f(x) = 0\) for all \(x \in X\), and thus \(f \in I(X)\), and hence \(\sqrt{I(X)} \subseteq I(X)\).
            We also have \(I(X) \subseteq \sqrt{I(X)}\) by \cref{lma:ideal is subset of its radical}.
            Thus, \(I(X) = \sqrt{I(X)}\).
        \end{proof}
    \end{lma}
    
    \begin{remark}{}{}
        This gives us the other side of the pairing between algebraic objects and geometric objects:
        \begin{equation}
            I \colon \{\text{subsets of } \affine^n\} \to \{\text{radical ideals of } K[x_1, \dotsc, x_n]\}.
        \end{equation}
        These aren't quite inverses, since in this direction we only produce radical ideals.
        However, as we've seen radical ideals are good enough if we're applying \(V\).
        The following important theorem tells us that these maps, while not quite inverses, are essentially inverses, so long as we're happy to only deal with radical ideals, which we can do by liberally taking radicals.
    \end{remark}
    
    \begin{thm}{Hilbert's Nullstellensatz}{thm:hilberts nullstellensatz}
        \begin{enumerate}
            \item For any affine variety, \(X \subseteq \affine^n\), we have \(V(II(X)) = X\).
            \item For any ideal, \(J \subideal K[x_1, \dotsc, x_n]\), we have \(I(V(J)) = \sqrt{J}\).
        \end{enumerate}
        \begin{proof}
            We first prove that \(X \subseteq V(I(X))\).
            If \(x \in X\) then \(f(x) = 0\) for all \(f \in I(X)\), and thus \(x \in V(I(X))\).
            
            Next, we prove that \(\sqrt{J} \subseteq I(V(J))\).
            If \(f \in \sqrt{J}\) then \(f^k \in J\) for some \(k \in \naturals\).
            Thus, \(f^k(x) = 0\) for all \(x \in V(J)\), and so \(f(x) = 0\) for all \(x \in V(J)\), and so \(f \in I(V(J))\).
            
            Third, we prove that \(V(I(X)) \subseteq X\).
            Since \(X\) is an affine variety we know that there is some ideal, \(J \subideal K[x_1, \dotsc, x_n]\), for which \(X = V(J)\).
            Then \(\sqrt{J} \subseteq I(V(J))\) by the previous step, and \(J \subseteq \sqrt{J}\), so \(J \subseteq I(V(J))\).
            Taking the zero locus, which reverses the inclusion (\cref{lma:V reverses inclusion}), we have \(V(I(V(J))) \subseteq V(J)\).
            Since \(X = V(J)\) this is then exactly \(V(I(X)) \subseteq X\), and so combined with the first step we have that \(V(I(X)) = X\).
            
            The only hard step of the proof is showing that \(I(V(J)) \subseteq \sqrt{J}\).
            This requires some pretty heavy commutative algebra, so we'll skip it.
            It is this step of the proof which requires that \(K\) is algebraically closed.
        \end{proof}
    \end{thm}
    
    \begin{remark}{}{}
        Nullstellensatz means \enquote{theorem of the zeroes}.
    \end{remark}
    
    \begin{exm}{}{}
        Consider a nonzero ideal, \(J \subideal K[x]\).
        Since \(K[x]\) is a PID we have that \(J = \langle f \rangle\) for some \(f \in K[x]\).
        Over an algebraically closed field we can always write \(f\) as
        \begin{equation}
            f(x) = (x - a_1)^{k_1} \dotsm (x - a_r)^{k_r}
        \end{equation}
        for some \(a_i \in K\) and \(k_i, r \in \naturals\).
        Note that \(J = \langle f \rangle\) the consists of all polynomials vanishing at \(a_i\) with order at least \(k_i\).
        We therefore have \(V(J) = V(f) = \{a_1, \dotsc, a_n\} \subseteq \affine^1\).
        This affine variety captures the zeros of \(f\), but loses information about their multiplicities.
        
        Hilbert's Nullstellensatz (\cref{thm:hilberts nullstellensatz}) tells us that \(I(V(J)) = \sqrt{J}\), and in this case we have
        \begin{equation}
            \sqrt{J} = \langle (x - a_1) \dotsm (x - a_r) \rangle,
        \end{equation}
        consisting of all polynomials vanishing at \(a_i\) with \emph{any} order.
        So, \(\sqrt{J}\) too contains the information of the zeros of \(f\) while losing the information on their multiplicities.
        In this way the algebraic object, \(\sqrt{J}\), and the geometric object, \(V(J)\), contain exactly the same information.
    \end{exm}
    
    \begin{exm}{Not Algebraically Closed}{}
        Note that the fact \(K\) is algebraically closed is essential.
        In this example we'll consider the field \(\reals\), which is not algebraically closed.
        The ideal \(\langle x^2 + 1 \rangle \subideal \reals[x]\) is prime, and hence radical (\cref{lma:prime ideal is radical}).
        However, \(V(x^2 + 1) = \emptyset \ne \sqrt{\langle{x^2 + 1}}\).
        Thus, Hilbert's Nullstellensatz doesn't hold as \(I(V( x^2 + 1 )) = I(\emptyset) = \reals[x]\), when the Nullstellensatz would have \(I(V(\langle x^2 + 1)) \stackrel{!}{=} \sqrt{\langle x^2 + 1 \rangle} = \langle x^2 + 1 \rangle\), which is a proper ideal.
    \end{exm}
    
    \begin{exm}{}{exm:points of affine space 1 to 1 max ideals}
        Consider the ideal \(J = \langle x - a_1, \dotsc, x - a_n \rangle \subideal K[x_1, \dotsc, x_n]\) for some \(a_i \in K\).
        This is a maximal ideal since \(K[x_1, \dotsc, x_n]/J \isomorphic K\) (setting \(x_i = a_i\)).
        Hence, it is also prime, and so radical (\cref{lma:prime ideal is radical}).
        The vanishing set of this ideal is \(V(J) = \{a\}\) for \(a = (a_1, \dotsc, a_n) \in \affine^n\).
        Then by Hilbert's Nullstellensatz (\cref{thm:hilberts nullstellensatz}) we have
        \begin{equation}
            I(\{a\}) = I(V(J)) = \sqrt{J} = J = \langle x_1 - a_1, \dotsc, x_n - a_n \rangle.
        \end{equation}
        This lets us identify points in \(\affine^n\) with minimal non-empty affine varieties.
        By the inclusion-reversing pairings of the Nullstellensatz points in \(\affine^n\) are in one-to-one correspondence with maximal ideals in \(K[x_1, \dotsc, x_n]\).
        This gives us another pairing of algebraic and geometric objects,
        \begin{equation}
            \{\text{maximal ideals of } K[x_1, \dotsc, x_n]\} \xleftrightarrow{1:1} \{\text{points in } \affine^n\}.
        \end{equation}
        This also shows that maximal ideals of the form of \(J\) above are actually the only maximal ideals of \(K[x_1, \dotsc, x_n]\), a fact which can be proven purely algebraically, but this proof passes through geometry.
    \end{exm}
    
    We can now prove a couple of results about how \(I\) interacts with unions and intersections.
    These are analogous to the results \cref{lma:intersection of defining equations,lma:union of defining equations} for \(V\). 
    
    \begin{lma}{}{lma:ideal of union}
        Let \(X_1\) and \(X_2\) be affine varieties in \(\affine^n\).
        Then \(I(X_1 \cup X_2) = I(X_1) \cap I(X_2)\).
        \begin{proof}
            Suppose \(f \in I(X_1 \cup X_2)\).
            Then \(f\) vanishes on any point of \(X_1\) or \(X_2\), and thus \(f \in I(X_1)\) and \(f \in I(X_2)\), so \(f \in I(X_1) \cap I(X_2)\).
            
            Conversely, suppose \(f \in I(X_1) \cap I(X_2)\).
            Then \(f\) vanishes on \(X_1\) and \(X_2\), and so it vanishes on \(X_1 \cup X_2\), and hence \(f \in I(X_1 \cup X_2)\).
        \end{proof}
    \end{lma}
    
    \begin{crl}{}{}
        The intersection of two radical ideals of \(K[x_1, \dotsc, x_n]\) is again radical.
        \begin{proof}
            If \(J_1\) and \(J_2\) are radical ideals then there exist affine varieties, \(X_1\) and \(X_2\), such that \(J_1 = I(X_1)\) and \(J_2 = I(X_2)\).
            Then \(J_1 \cap J_2 = I(X_1 \cup X_2)\), which is radical since the ideal of any affine variety is radical.
        \end{proof}
    \end{crl}
    
    Note that it's possible to prove this corollary purely algebraically as well.
    
    \begin{lma}{}{lma:ideal of intersection}
        Let \(X_1\) and \(X_2\) be affine varieties in \(\affine^n\).
        Then \(I(X_1 \cap X_2) = \sqrt{I(X_1) + I(X_2)}\).
        \begin{proof}
            By Hilbert's Nullstellensatz (\cref{thm:hilberts nullstellensatz}) we have that \(X_1 = V(I(X_1))\) and \(X_2 = V(I(X_2))\).
            Thus, we have
            \begin{equation}
                I(X_1 \cap X_2) = I(V(I(X_1)) \cap V(I(X_2))).
            \end{equation}
            Then, by \cref{lma:intersection of defining equations} we have \(V(J_1) \cap V(J_2) = V(J_1 + J_2)\), and so
            \begin{equation}
                I(X_1 \cap X_2) = I(V(I(X_1) + I(X_2))).
            \end{equation}
            Then by the Nullstellensatz again we have \(I(V(J)) = \sqrt{J}\), and so
            \begin{equation*}
                I(X_1 \cap X_2) = \sqrt{I(X_1) + I(X_2)}. \qedhere
            \end{equation*}
        \end{proof}
    \end{lma}
    
    \begin{remark}{}{}
        It is not, in general, true that the sum of two radical ideals is radical.
        This shouldn't be surprising, the algebraic explanation is that exponentiating a sum doesn't behave particularly simply, we need the binomial theorem.
        This is why we have to take the radical in the lemma above.
        
        There is also a geometric explanation for this, in addition to the algebraic one.
        Consider the affine varieties \(X_1, X_2 \subseteq \affine^2_{\complex}\) with \(I(X_1) = \langle x_2 - x_1^2 \rangle\) and \(I(X_2) = \langle x_2 \rangle\).
        The real points of these varieties are shown in \cref{fig:sum radicals not radical}.
        These correspond to \(y = x^2\) and \(y = 0\), although we're only really able to visualise these for \(x, y \in \reals\).
        
        The intersection of these two varieties is \(X_1 \cap X_2 = \{(0, 0)\}\).
        Thus, \(I(X_1 \cap X_2) = I((0, 0)) = \langle x_1, x_2 \rangle\).
        Here we've used the identification of points of \(\affine_{\complex}^2\) with maximal ideals of \(\complex[x_1, x_2]\) from \cref{exm:points of affine space 1 to 1 max ideals}.
        
        We have that
        \begin{equation}
            I(X_1) + I(X_2) = \langle x_2 - x_1^2 \rangle + \langle x_2 \rangle = \langle x_2 - x_1^2, x_2 \rangle = \langle x_1^2, x_2 \rangle.
        \end{equation}
        This is not a radical ideal, we have
        \begin{equation}
            \sqrt{\langle x_1^2, x_2 \rangle} = \langle x_1, x_2 \rangle.
        \end{equation}
        Which we expect from \cref{lma:ideal of intersection}.
        
        The geometric interpretation is then as follows.
        The varieties \(X_1\) and \(X_2\) are tangent at their intersection point.
        Thus, in a linear approximation their defining equations, \(x_2 = x_1^2\) and \(x_2 = 0\), are the same, and both pick out the \(x_1\) axis.
        This means we can imagine that the intersection, \(X_1 \cap X_2\), actually extends a small distance from the origin, an infinitesimal amount in the \(x_1\) direction.
        But, in this extended region \(x_1\) doesn't vanish, and so it doesn't lie in \(I(X_1) + I(X_2)\).
        
        There are various ways to deal with this problem.
        One is to keep track of the multiplicities of curve intersections.
        The algebraic-geometry approach is to define schemes.
        These enlarge our class of geometric objects to include \enquote{objects extending by infinitesimally small amounts in some direction}.
        Then the result that we get mirroring that of Hilbert's Nullstellensatz (\cref{thm:hilberts nullstellensatz}) is that affine schemes are in one-to-one correspondence with \emph{arbitrary} ideals of \(K[x_1, \dotsc, x_n]\).
        Then the intersection of \(X_1\) and \(X_2\) is replaced with the scheme corresponding to the non-radical ideal \(\langle x_1, x_2^2 \rangle\).
        % TODO: reference to section on schemes
    \end{remark}
    
    \begin{figure}
        \centering
        \tikzsetnextfilename{sum-radicals-not-radical}
        \begin{tikzpicture}
            \draw [very thick, my blue] (-3, 0) -- (3, 0) node [right] {\(X_2\)};
            \draw [very thick, my red, domain=-3:3, samples=100] plot (\x, \x*\x/2) node [below right] {\(X_1\)};
            \fill [my green] (0, 0) circle [radius = 0.1] node [below] {\(X_1 \cap X_2\)};
        \end{tikzpicture}
        \caption[Sum of radicals not radical]{The two varieties used to demonstrate why the sum of radical ideals is not necessarily radical.}
        \label{fig:sum radicals not radical}
    \end{figure}
    
    If \(J \subideal K[x_1, \dotsc, x_n]\) is proper then \(J\) has a zero, that is \(V(J)\) is non-empty.
    Otherwise, we'd have that \(\sqrt{J} = I(V(J)) = I(\emptyset) = K[x_1, \dotsc, x_n]\), which means \(1 \in \sqrt{J}\) and so \(1 \in J\) meaning \(J = K[x_1, \dotsc, x_n]\), violating the assumption that \(J\) is proper.
    
    \begin{prp}{Weak Nullstellensatz}{}
        If \(J\) is a proper ideal of \(K[x_1, \dotsc, x_n]\) then \(V(J)\) is non-empty.
    \end{prp}
    
    \begin{remark}{}{}
        Historically the weak nullstellensatz was proven first.
        This result is the reason for the name, \enquote{theorem of the zeros}.
        Despite the \enquote{weak} in the name of this result the weak Nullstellensatz is actually equivalent to the full Nullstellensatz.
        There's a trick, known as Rabinowitsch's trick, which allows one to reduce the full Nullstellensatz in \(n\) variables to the weak Nullstellensatz in \(n + 1\) variables.
    \end{remark}
    
    \section{Polynomial Functions}
    \begin{dfn}{}{}
        A \defineindex{polynomial function} on \(\affine^n\) is any function \(\affine^n \to K\) determined by \(x \mapsto f(x)\) for some \(f \in K[x_1, \dotsc, x_n]\).
    \end{dfn}
    
    Note that such functions form a ring.
    
    An immediate consequence of the Nullstellensatz is that polynomials and polynomial functions on \(\affine^n\) agree.
    That is, two polynomials in \(K[x_1, \dotsc, x_n]\) are equal if and only if the polynomial functions they determine on \(\affine^n\) are equal.
    
    If \(f, g \in K[x_1, \dotsc, x_n]\) determine the same polynomial function on \(\affine^n\) then \(f(x) = g(x)\) for all \(x \in \affine^n\) by definition of equality of functions.
    Then \((f - g)(x) = 0\) for all \(x \in \affine^n\).
    Then by the Nullstellensatz we have
    \begin{equation}
        f - g \in I(\affine^n) = I(V(0)) = \sqrt{\langle 0 \rangle} = \langle 0 \rangle
    \end{equation}
    and thus \(f - g = 0\) in \(K[x_1, \dotsc, x_n]\), which means \(f = g\) as polynomials.
    
    The trickiest thing here is distinguishing between a polynomial and the polynomial function it determines.
    The solution to this is to use the work above to mostly ignore the distinction.
    We identify \(K[x_1, \dotsc, x_n]\) with the ring of polynomial functions on \(\affine^n\).
    
    We can just as well define polynomial functions on any subset of \(\affine^n\), and the most useful subsets to define them on are affine varieties.
    Note that this subsumes the above definition by considering \(\affine^n\) as an affine variety.
    
    \begin{dfn}{}{}
        Let \(X \subseteq \affine^n\) be an affine variety.
        Then a \defineindex{polynomial function} on \(X\) is any function \(X \to K\) determined by \(x \mapsto f(x)\) for some \(f \in K[x_1, \dotsc, x_n]\).
        
        The ring of all polynomial functions on \(X\) is called the \defineindex{coordinate ring}, denoted \(A(X)\).
    \end{dfn}
    
    \begin{ntn}{}{}
        A common alternative notation for the coordinate ring of \(X\) is \(K[X]\), not to be confused with the polynomial ring in a single variable, \(K[x]\), or say the group algebra or \(K\)-span of \(X\).
    \end{ntn}
    
    \begin{lma}{}{}
        Let \(X \subseteq \affine^n\) be an affine variety.
        Then the coordinate ring is given by
        \begin{equation}
            A(X) \isomorphic K[x_1, \dotsc, x_n] / I(X).
        \end{equation}
        \begin{proof}
            The isomorphism simply identifies the equivalence class of a polynomial, \([f]\), with the corresponding function \(x \mapsto f(x)\), which is clearly a ring homomorphism.
            We need only show that this is independent of choice of representative.
            To do so suppose that \(f, g \in [f]\).
            That is \(f - g \in I(X)\).
            Then \(f(x) - g(x) = 0\) for all \(x \in X\), and thus \(f(x) = g(x)\), so \(f\) and \(g\) determine the same polynomial function on \(X\).
        \end{proof}
    \end{lma}
    
    We will identify \(A(X)\) and \(K[x_1, \dotsc, x_n]/I(X)\) from now on.
    
    The idea here is that as far as \(X\) is concerned two polynomials are the same if they are equal for all \(x \in X\).
    Whether these polynomials differ outside of \(X\) is not a question relevant when we're studying \(X\).
    Thus, the difference of these two polynomials should vanish on \(X\), which is exactly what it means for the difference of these two polynomials to be in \(I(X)\).
    
    Note that as well as being a ring \(A(X)\) is actually a vector space, and the multiplication of two polynomial functions is \(K\)-bilinear.
    This means \(A(X)\) is actually a \(K\)-algebra.
    Despite this, the name coordinate \emph{ring} remains.
    
    \begin{exm}{}{}
        Consider the affine variety \(X = V(y - x^2) \subseteq \affine^2\).
        Then \(A(X) = K[x, y] / I(X)\).
        We have that \(K[x, y] / \langle y - x^2 \rangle \isomorphic K[x, x^2] = K[x]\), which is an integral domain.
        Thus, \(\langle y - x^2 \rangle\) is prime, and so by \cref{lma:prime ideal is radical} we have \(\langle y - x^2 \rangle = \sqrt{\langle y - x^2 \rangle}\).
        Thus, \(I(X) = \sqrt{\langle y - x^2 \rangle} = \langle y - x^2 \rangle\) and so \(A(X) = K[x, y] / I(X) \isomorphic K[x]\).
    \end{exm}
    
    Note that we almost always only identify coordinate rings up to isomorphism.
    
    \section{Affine Subvarieties}
    We will now repeat much of our previous work to define \emph{relative} versions of many concepts.
    These replace the ambient space, \(\affine^n\), with some other affine variety, \(Y \subseteq \affine^n\), and then make the equivalent definitions for \(X \subseteq Y\) given by the vanishing set of some polynomials.
    
    \begin{dfn}{}{}
        Let \(Y \subseteq \affine^n\) be a fixed affine variety.
        For a subset, \(S \subseteq A(Y)\), we define it's \defineindex{relative zero locus} to be
        \begin{equation}
            V_Y(S) = \{x \in Y \mid f(x) = 0 \forall f \in S\} \subseteq Y.
        \end{equation}
        Subsets of this form are called \define{affine subvarieties}\index{affine subvariety} of \(Y\).
    \end{dfn}
    
    \begin{ntn}{}{}
        When no confusion is likely to occur we drop the subscript \(Y\) and just write \(V(S)\).
        This is usually fine due to the following point.
    \end{ntn}
    
    Note that affine subvarieties of \(Y\) are exactly the affine varieties (subsets of \(\affine^n\)) which are also subsets of \(Y\).
    In the definition we're just restricting the polynomial functions determined on \(\affine^n\) to polynomial functions defined on \(Y\) before restricting further to \(X\).
    This doesn't actually change anything\footnote{This is an important part of the definition of a sheaf, which we'll see later}.
    % TODO: reference to definition of sheaf
    
    \begin{dfn}{}{}
        Let \(Y \subseteq \affine^n\) be a fixed affine variety.
        For a subset, \(X \subseteq Y\), we define the \defineindex{relative ideal} of \(X\) in \(Y\) to be
        \begin{equation}
            I_Y(X) = \{f \in A(Y) \mid f(x) = 0 \forall x \in X\} \subideal A(Y).
        \end{equation}
    \end{dfn}
    
    \begin{ntn}{}{}
        When no confusion is likely to occur we drop the subscript \(Y\) and just write \(I(X)\).
    \end{ntn}
    
    \begin{lma}{}{}
        Let \(X \subseteq Y \subseteq \affine^n\) be affine varieties.
        Then
        \begin{equation}
            A(X) \isomorphic A(Y) / I_Y(X).
        \end{equation}
        \begin{proof}
            The isomorphism identifies an equivalence class, \([f]\), of polynomial functions on \(Y\) with the polynomial function on \(X\) defined by \(x \mapsto f(x)\).
            This is clearly an isomorphism.
            It is independent of the choice of representatives because if \(f, g \in [f]\) then \(f - g \in I_Y(X)\), which means \(f(x) - g(x) = 0\) on \(X\), which means \(f(x) = g(x)\) for \(x \in X\) and therefore \(f\) and \(g\) both determine the same polynomial function on \(X\).
        \end{proof}
    \end{lma}
    
    There are many relative results we can now state, but won't prove.
    First, all of the properties of \(V\) and \(Y\) with respect to inclusions, unions, and intersections still hold for the relative versions.
    That is, we get analogous relative results for \cref{lma:V reverses inclusion,lma:union of defining equations,lma:intersection of defining equations,lma:I reverses inclusion,lma:ideal of union,lma:ideal of intersection}.
    
    \begin{thm}{Relative Nullstellensatz}{thm:relative nullstellensatz}
        Let \(X \subseteq Y \subseteq \affine^n\) be affine varieties.
        Then we have \(V_Y(I_Y(X)) = X\).
        Let \(J \subideal A(Y)\), then \(I_Y(V_Y(J)) = \sqrt{J}\).
    \end{thm}
    
    This gives us a bijection
    \begin{equation}
        \{\text{affine subvarieties of } Y\} \xleftrightarrow{1:1} \{\text{radical ideals of } A(Y)\}.
    \end{equation}
    
    \chapter{Zariski Topology}
    \label{chap:zariski topology}
    In this section we see that there is a natural topology on any affine variety, given by declaring all affine subvarieties to be closed.
    
    \section{Topological Preliminaries}
    A topology can be defined by specifying open sets.
    It is also possible to define a topology by specifying closed sets (complements of open sets).
    This gives an equivalent definition of a topology, which is what we will work with.
    
    \begin{lma}{}{}
        Let \(X\) be a set.
        We can declare a \defineindex{topology} on \(X\) by declaring a collection of closed sets so long as
        \begin{enumerate}
            \item the empty set and \(X\) are closed;
            \item arbitrary intersections of closed sets are closed;
            \item finite unions of closed sets are closed.
        \end{enumerate}
    \end{lma}
    
    Notice that the standard definition of a topology has arbitrary unions/finite intersections of open sets.
    These get swapped because taking complements turns unions into intersections and vice versa by De Morgan's laws.
    
    \begin{lma}{}{}
        If \(Y\) is a topological space and \(X \subseteq Y\) is a set then the \defineindex{subspace topology} on \(X\) is given by declaring the closed sets of \(X\) to be those sets, \(A \subseteq X\), of the form \(A = C \cap Y\) for \(C \subseteq Y\) closed in the topology of \(Y\).
    \end{lma}
    
    \begin{lma}{}{}
        A function, \(f \colon X \to Y\), between topological spaces is \defineindex{continuous} if the preimage of a closed set is closed.
    \end{lma}
    
    \section{Zariski Topology}
    \begin{dfn}{Zariski Topology}{}
        Let \(X\) be an affine variety.
        The \defineindex{Zariski topology} on \(X\) is given by declaring the closed sets to be the affine subvarieties of \(X\).
    \end{dfn}
    
    That is, the closed subsets are exactly those of the form \(V_X(S) = V(S)\) where \(S \subseteq A(X)\).
    
    Unless stated otherwise all topological notions for an affine variety will be considered with respect to the Zariski topology.
    Likewise, any topological notions for a subset of an affine variety will be considered with respect to the subspace topology of the affine variety (which is itself considered with respect to the Zariski topology).
    
    \begin{lma}{}{}
        The Zariski topology is really a topology.
        \begin{proof}
            Let \(X\) be an affine variety.
            Since \(X = V(I(X))\) and \(\emptyset = V(1)\) we have that \(X\) and \(\emptyset\) are closed.
            A collection of closed subsets is a collection of affine subvarieties.
            This is closed under arbitrary intersection by the relative version of \cref{lma:intersection of defining equations}, and is closed under finite unions by the relative version of \cref{lma:union of defining equations}.
        \end{proof}
    \end{lma}
    
    Notice that if we have affine varieties, \(X \subseteq Y\), then there are \textit{a priori} two topologies we could consider on \(X\):
    \begin{enumerate}
        \item The Zariski topology;
        \item The subspace topology.
    \end{enumerate}
    However, these are actually exactly the same.
    To see this note that the affine subvarieties of \(X\) (that is, the closed sets of \(X\) in the Zariski topology) are precisely the affine subvarieties of \(Y\) which are a subset of \(X\), that is, they're of the form \(Z \cap Y\) where \(Z \subseteq Y\) is closed, but that's precisely the closed sets of the subspace topology.
    
    To showcase some of the slightly unusual features of the Zariski topology we'll consider \(\affine_{\complex}^1\) and compare things to the standard topology on \(\complex\).
    
    \begin{exm}{}{}
        Consider the unit ball,
        \begin{equation}
            B = \{x \in \affine_{\complex}^1 \mid \abs{x} \le 1\}.
        \end{equation}
        Viewing this as a subset of \(\complex\) in the standard topology it is clearly closed.
        Viewing it as a subset of \(\affine_{\complex}^1\) in the Zariski topology it is not closed, since it is an infinite set and the only affine varieties of \(\affine^1\) are \(\affine^1\) and finite sets (\cref{exm:affine varieties of A1}).
    \end{exm}
    
    This example informs our intuition for closed sets in the Zariski topology.
    Specifically, closed sets are, in a sense, \enquote{small}.
    Meaning that open sets are \enquote{big}.
    Now, in dimensions greater than \(1\) we can have infinite closed sets, so we have to be a bit careful about the meaning of \enquote{small}, but it's a reasonable intuition to have.
    
    Note that any Zariski closed subset of \(\affine_{\complex}^n\) is also closed in the standard topology of \(\complex^n\).
    This is because given \(X = V(f_1, \dotsc, f_n)\) a Zariski-closed subset we have that \(X = (f_1, \dotsc, f_n)^{-1}(0)\), where we're considering a function \((f_1, \dotsc, f_n) \colon \complex^n \to \complex\) and \(\{0\} \subseteq \complex\) is closed in the standard topology and polynomials are clearly continuous (with respect to the standard topology), so \(X\) is the preimage of a closed set under a continuous map and so is closed in the standard topology also.
    
    Only very few closed subsets in the standard topology are also closed in the Zariski topology.
    The Zariski topology is coarser than the standard topology.
    
    \begin{exm}{}{}
        Let \(f \colon \affine_{\complex}^1 \to \affine_{\complex}^1\) be any injective map.
        Then if \(X \subseteq \affine_{\complex}^1\) is finite (i.e., Zariski-closed) then \(f^{-1}(X)\) is also finite, and hence Zariski-closed.
        We also have that \(f^{-1}(\emptyset) = \emptyset\) and any injective polynomial from \(\complex \to \complex\) necessarily has domain \(f^{-1}(\affine_{\complex}^1) = \affine_{\complex}^1\).
        Thus, the preimage of any Zariski-closed subset is again Zariski-closed, and so \(f\) is always continuous.
    \end{exm}
    
    \begin{exm}{Product Topology}{}
        Given topological spaces, \(X\) and \(Y\), their product, \(X \times Y\), can be equipped with a topology by declaring open subsets to be those of the form \(\bigcup_{i \in I} U_i \times V_i\) where \(U_i \subseteq X\) and \(V_i \subseteq Y\) are families of open subsets in their respective topologies.
        
        The standard topology on \(\complex^n\) is precisely the product topology induced by the standard topology on each copy of \(\complex\).
        This is not so for the Zariski topology.
        
        Let \(X \subseteq \affine_{\complex}^n\) and \(Y \subseteq \affine_{\complex}^m\) be affine varieties.
        Then we have seen that \(X \times Y \subseteq \affine_{\complex}^{n+m}\) is an affine variety (\cref{exm:affine varieties}).
        However, the Zarisiki topology on \(X \times Y\) does not coincide with the product topology on \(X \times Y\) induced by the Zariski topology on \(X\) and \(Y\).
        
        To see this note that \(V(x - y) = \{(a, a) \mid a \in K\} \subseteq \affine_{\complex}^2\) is closed in the Zariski topology of \(\affine_{\complex}^2\), but it is not closed in the product topology, since the only way to write it as a union of products is
        \begin{equation}
            \bigcup_{a \in K} \{a\} \times \{a\},
        \end{equation}
        but \(\{a\}\) is not open in the Zariski-topology (its complement is an infinite subset of \(\affine_{\complex}^1\)).
    \end{exm}
    
    Note that the diagonal, \(\Delta = \{(a, a) \mid a \in X\}\), is a closed subset of \(X\) if and only if \(X\) is Hausdorff (\cref{lma:hausdorff iff diagonal closed}).
    This shows that the Zariski topology is not Hausdorff, at least when we're working over an infinite field.
    
    These examples show that the notion of continuous functions and products of spaces aren't that useful when it comes to the Zariski topology.
    In the next section we'll define some much more useful properties.
    
    \section{Irreducible Spaces}
    Consider the affine variety \(X = V(x_1x_2) \subseteq \affine^2\).
    This consists of all points \((x_1, x_2) \in \affine^2\) where \(x_1 = 0\) or \(x_2 = 0\).
    We can see this by just considering the solutions to \(x_1x_2 = 0\), or by noticing that \(V(x_1x_2) = V(x_1) \cup V(x_2)\) by \cref{lma:union of defining equations}.
    When we take \(K = \complex\) we can plot the real points of this affine variety, they're simply the coordinate axes, \(X_1 = V(x_2)\) and \(X_2 = V(x_1)\) (see \cref{fig:affine variety coordinate axes}).
    Note the exchange of indices, the \(x_i\) coordinate axis is where all other coordinates vanish.
    We see that \(X = X_1 \cup X_2\), giving us a way to decompose \(X\) into two \enquote{smaller} affine varieties.
    Notice also that \((0, 0) \in X_1\) and \((0, 0) \in X_2\), so these are not disjoint affine varieties.
    This leads us to make the following definitions.
    
    \begin{figure}
        \centering
        \tikzsetnextfilename{affine-variety-coordinate-axes}
        \begin{tikzpicture}[font=\footnotesize]
            \draw [my blue, ultra thick, ->] (0, -3) -- ++ (0, 6) node [below left] {\(X_2 = V(x_1)\)} node [above] {\(x_2\)};
            \draw [my green, ultra thick, ->] (-3, 0) -- ++ (6, 0) node [above left] {\(X_1 = V(x_2)\)} node [right] {\(x_1\)}; 
            \fill [my red] (0, 0) circle [radius = 0.075] node [below right] {\(X_1 \cap X_2\)};
        \end{tikzpicture}
        \caption[The affine variety \(X = V(x_1x_2)\).]{The real points of the affine variety \(X = V(x_1 x_2)\), which breaks into two components, \(X = X_1 \cup X_2 = V(x_2) \cup V(x_1)\). Note the nonempty intersection \(X_1 \cap X_2 = \{(0, 0)\}\).}
        \label{fig:affine variety coordinate axes}
    \end{figure}
    
    \begin{dfn}{Connected Space}{}
        A topological space, \(X\), is \defineindex{disconnected} if there exist closed proper (i.e., nonempty) subsets, \(X_1, X_2 \subsetneq X\), such that \(X = X_1 \cup X_2\) and \(X_1 \cap X_2 = \emptyset\).
        Otherwise \(X\) is called \defineindex{connected}.
    \end{dfn}
    
    \begin{dfn}{Irreducible Space}{}
        A topological space, \(X\), is \defineindex{reducible} if there exist closed proper (i.e., nonempty) subsets, \(X_1, X_2 \subsetneq X\), such that \(X = X_1 \cup X_2\).
        Otherwise \(X\) is called \defineindex{irreducible}.
    \end{dfn}
    
    Note that the only difference between these is that for a space to be disconnected it needs to split into non-overlapping sets, whereas to be reducible the sets can be overlapping.
    In particular, irreducibility implies connectedness (if it doesn't split as a union it definitely doesn't split as a union of disjoint sets).
    
    We can see that \(X = V(x_1x_2)\) is reducible, since \(X = X_1 \cap X_2 = V(x_2) \cap V(x_1)\) (remembering that \(V(x_1)\) and \(V(x_2)\) are closed in the Zariski topology).
    However, \(X\) is not disconnected, since if it split into two Zariski-closed disjoint subsets then these would also be closed in the standard topology, and we can see from the picture that this space is not disconnected.
    
    \begin{exm}{}{}
        Note that reducibility depends on the topology.
        For example, the complex plane, \(\complex\), is reducible in the standard topology because we can write it as
        \begin{equation}
            \complex = \{z \in \complex \mid \abs{z} \le 1\} \cup \{z \in \complex \mid \abs{z} \ge 1\}.
        \end{equation}
        However, in the Zariski topology any such decomposition would require at least one of the sets to be infinite, and the only infinite affine subvariety of \(\affine_{\complex}^1\) is \(\affine_{\complex}^1\) itself, so there is no way to write \(\affine_{\complex}^1\) as a union of \emph{proper} Zariski-closed subsets.
    \end{exm}
    
    \begin{exm}{}{}
        \begin{enumerate}
            \item Consider a single point, \(p \in \affine^n\).
            The set \(\{p\} = V(x - p)\) is an affine variety.
            This is clearly irreducible, if \(\{p\} = X_1 \cup X_2\) then one of \(X_1\) or \(X_2\) must be \(\{p\}\), so these aren't proper subsets.
            
            \item The emptyset is reducible, since we cannot write it as a union of nonempty sets.
            
            \item Let \(X = \{p_1, \dotsc, p_m\} \subseteq \affine^n\) be any finite set with \(m \ge 2\).
            This is an affine variety, \(X = V((x - p_1) \dotsm (x - p_m))\).
            We can always write \(X = \{p_1, \dotsc, p_{m-1}\} \cup \{p_m\} = V((x - p_1) \dotsm (x - p_{m-1})) \cup V(x - p_m)\), showing that \(X\) is reducible.
        \end{enumerate}
        Combining these three, we see that a finite affine variety is irreducible if and only if it contains exactly one point.
    \end{exm}
    
    Connectedness and reducibility, as stated above, are topological properties.
    It turns out that there are alternative algebraic characterisation of these properties for the Zariski topology.
    
    \begin{prp}{}{}
        Let \(X\) be a disconnected affine variety such that \(X = X_1 \cup X_2\) with \(X_1, X_2 \subsetneq X\) closed subsets.
        Then \(A(X) \isomorphic A(X_1) \times A(X_2)\).
        \begin{proof}
            In \(A(X)\) by \cref{lma:ideal of union} we have that
            \begin{equation}
                I(X_1) \cap I(X_2) = I(X_1 \cup X_2) = I(X) = \langle 0 \rangle.
            \end{equation}
            We also have \(X_1 \cap X_2 = \emptyset\), and so by \cref{lma:ideal of intersection}
            \begin{equation}
                \sqrt{I(X_1) + I(X_2)} = I(X_1 \cap X_2) = I(\emptyset) = A(X).
            \end{equation}
            Since \(1^k = 1\) it must be that \(1 \in I(X_1) + I(X_2)\), and thus \(I(X_1) + I(X_2) = A(X)\).
            Then by the Chinese remainder theorem (\cref{lma:chinese remainder theorem}) we have an isomorphism
            \begin{equation}
                A(X) = \isomorphic \frac{A(X)}{I(X_1)} \times \frac{A(X)}{I(X_2)} = A(X_1) \times A(X_2). \qedhere
            \end{equation}
        \end{proof}
    \end{prp}
    
    \begin{prp}{}{}
        Let \(X\) be a nonempty affine variety.
        Then \(X\) is irreducible if and only if \(A(X)\) is an integral domain.
        \begin{proof}
            Since \(X\) is nonempty \(A(X)\) is not the zero ring, which is required to be an integral domain.
            We will prove that \(X\) is reducible if and only if it \(A(X)\) is not an integral domain.
            
            Suppose that \(A(X)\) is not an integral domain.
            That is, there exist nonzero \(f_1, f_2 \in A(X)\) with \(f_1 f_2 = 0\).
            Then \(X_1 = V(f_1)\) and \(X_2 = V(f_2)\) are closed subsets of \(X\) and since \(f_i\) are nonzero \(X_i \subsetneq X\).
            By \cref{lma:union of defining equations}, \(X_1 \cup X_2 = V(f_1) \cup V(f_2) = V(f_1f_2) = V(0) = X\), and so \(X\) is reducible.
            
            Suppose instead that \(X\) is reducible, so \(X = X_1 \cup X_2\) for some closed proper subsets, \(X_1, X_2 \subsetneq X\).
            By the relative Nullstellensatz (\cref{thm:relative nullstellensatz}) we know that \(I(X_i) \ne \{0\}\), since under the bijection between affine subvarieties and radical ideals of \(A(X)\) the ideal \(\{0\}\) corresponds to \(X\) itself.
            Thus, there exists nonzero \(f_i \in I(X_i)\).
            Then \(f_1 f_2\) vanishes on \(X_1 \cup X_2 = X\) since \(f_1\) vanishes on \(X_1\) and \(f_2\) vanishes on \(X_2\).
            Thus, \(f_1 f_2 = 0\) in \(A(X)\), and so \(A(X)\) is not an integral domain.
        \end{proof}
    \end{prp}
    
    \begin{exm}{}{}
        Affine space, \(\affine^n\), is irreducible (and hence connected) since its coordinate ring, \(A(\affine^n) = K[x_1, \dotsc, x_n]\), is an integral domain.
        
        More generally, any affine variety given as the vanishing set of some linear polynomials is irreducible, since its coordinate ring is again isomorphic to a polynomial ring over a field, which is an integral domain.
    \end{exm}
    
    \begin{remark}{}{rmk:bijection between prime ideals and irreducible subvars}
        Note that \(A(X) = K[x_1, \dotsc, x_n] / I(X)\) being an integral domain means that \(I(X)\) is a prime ideal.
        This gives us yet another bijection between algebraic and geometric objects:
        \begin{equation*}
            \{\text{nonempty irreducible affine subvarieties of } X\} \xleftrightarrow{1:1} \{\text{prime ideals of } A(X)\}.
        \end{equation*}
        In other words,
        \begin{equation*}
            \{\text{nonempty irreducible affine subvarieties of } X\} \xleftrightarrow{1:1} \Spec A(X).
        \end{equation*}
    \end{remark}
    
    \section{Noetherian Spaces}
    \label{sec:noetherian spaces}
    In this section we'll see that any affine variety can always be written as a finite union of irreducible spaces.
    We'll actually show that this is true for a much broader class of spaces.
    These are called Noetherian spaces, having a very similar definition to that of a Noetherian ring.
    
    \begin{dfn}{Noetherian Space}{}
        A topological space, \(X\), is \define{Noetherian}\index{Noetherian!topological space} if every \emph{descending} chain of closed subsets,
        \begin{equation}
            X \supseteq X_1 \supseteq X_2 \supseteq \dotsb,
        \end{equation}
        stabilises.
        That is, for sufficiently large \(i\) we have \(X_{i+1} = X_i\).
    \end{dfn}
    
    Note that the corresponding definition for Noetherian \emph{rings} has an ascending chain of ideals, \(I_1 \subseteq I_2 \subseteq \dotsb\).
    We can reformulate the definition of Noetherian spaces in terms of ascending chains of \emph{open} subsets.
    We can also view this as the reversal of inclusions under \(X \mapsto I(X)\).
    
    \begin{lma}{}{}
        Any affine variety with the Zariski topology is a Noetherian topological space.
        \begin{proof}
            Suppose \(X\) is an affine variety admitting an infinite descending chain, \(X_1 \supsetneq X_2 \supsetneq \dotsb\).
            Then by the relative Nullstellensatz (\cref{thm:relative nullstellensatz}) this gives rise to an infinite ascending chain, \(I(X_1) \subsetneq I(X_2) \subsetneq \dotsb\), in \(A(X)\), but \(A(X)\) is always Noetherian as it is a quotient of the polynomial ring, which is Noetherian (\cref{thm:hilberts basis theorem,crl:poly ring over noetherian is noetherian}) and a quotient of a Noetherian ring is always Noetherian (\cref{lma:quotient of Noetherian is Noetherian}).
        \end{proof}
    \end{lma}
    
    \begin{lma}{}{}
        Any subspace of a Noetherian space is Noetherian.
        \begin{proof}
            Let \(X\) be a Noetherian topological space and \(Y\) a subspace of \(X\).
            Consider a descending chain, \(Y_1 \supseteq Y_2 \supseteq \dotsb\), of closed subsets of \(Y\).
            By definition of the subspace topology each of these closed subsets is of the form \(Y_i = Y \cap X_i\) with \(X_i \subseteq X\) some closed subset of \(X\).
            Thus, we have the chain \(Y \cap X_1 \supseteq Y \cap X_2 \supsetneq \dotsb\) in \(X\).
            This gives rise to a descending chain \(X_1 \supseteq X_1 \cap X_2 \supseteq X_1 \cap X_2 \cap X_3 \supseteq \dotsb\).
            This must stabilise, so \(X_1 \cap \dotsb \cap X_{n+1} = X_1 \cap \dotsb \cap X_n\) for sufficiently large \(n\).
            This then implies that \(Y \cap X_{n+1} =  \cap Y \cap X_n\) for sufficiently large \(n\), and thus \(Y_{n+1} = Y_n\) for sufficiently large \(n\), so our original chain stabilises and \(Y\) is Noetherian.
        \end{proof}
    \end{lma}
    
    \begin{crl}{}{}
        Any subspace of an affine variety is a Noetherian topological space.
    \end{crl}
    
    \begin{prp}{Irreducible Decomposition}{}
        Any Noetherian space, \(X\), decomposes as a finite union, \(X = X_1 \cup \dotsb \cup X_r\), of nonempty irreducible closed subsets.
        Further, if \(X_i \nsubseteq X_j\) for \(i \ne j\) then the \(X_i\) are unique up to order.
        We call the \(X_i\) the \define{irreducible components}\index{irreducible component} of \(X\).
        \begin{proof}
            If \(X = \emptyset\) then \(X\) is such a union with \(r = 0\), so suppose that \(X \ne \emptyset\).
            
            Suppose that \(X\) doesn't admit such a decomposition.
            This means that \(X\) is reducible, else it decomposes as itself with \(r = 1\).
            This means \(X = X_1 \cup X_1'\) for some closed proper subsets \(X_1, X_1' \subsetneq X\).
            If both of these sets admit such a decomposition then so would \(X\), so it must be that at least one of them doesn't, say \(X_1'\).
            Then by the same logic \(X_1'\) is reducible, so \(X_1' = X_2 \cup X_2'\) for some closed proper subsets \(X_2, X_2' \subsetneq X_1'\).
            Again, one of these must not admit a decomposition, so is reducible.
            Repeating like this we define an infinite chain \(X \supsetneq X_1 \supsetneq X_2 \supsetneq \dotsb\).
            This contradicts the assumption that \(X\) is Noetherian, proving existence.
            
            Suppose now that we have two such decompositions for \(X\),
            \begin{equation}
                X = X_1 \cup \dotsb \cup X_r = X_1' \cup \dotsb \cup X_s'.
            \end{equation}
            For any \(i \in \{1, \dotsc, r\}\) we have \(X_i \subseteq \bigcup_j X_j'\), and so \(X_i = \bigcup_j (X_i \cap X_j')\).
            By assumption \(X_i\) is irreducible, so we must have that all but one of these terms is empty, and so \(X_i = X_i \cap X_j'\) for some \(j\), meaning \(X_i \subseteq X_j'\) for some \(j\).
            Similarly, we have that \(X_j' \subseteq X_k\) for some \(k\).
            Thus, we have \(X_i \subseteq X_j' \subseteq X_k\), and by assumption this is only possible for \(i = k\), which then implies that \(X_i = X_j'\).
            Thus, every set on the left appears on the right.
            The same logic can be applied to show that every set on the right appears on the left.
            Thus the two decompositions are the same, up to the order of terms.
        \end{proof}
    \end{prp}
    
    \begin{remark}{}{}
        One can compute the irreducible decomposition of an affine variety from the corresponding primary decomposition (\cref{def:primary decomposition}) of its ideal, which always exists (\cref{lma:noetherian ring ideals have primary decomposition}).
        Let \(X \subseteq \affine^n\) be an affine variety, and let \(I(X) = Q_1 \cap \dotsb \cap Q_r\) with \(Q_i\) primary ideals of \(K[x_1, \dotsc, x_n]\) be the primary decomposition of \(I(X)\).
        Then by Hilbert's Nullstellensatz (\cref{thm:hilberts nullstellensatz}) and \cref{lma:union of ideals with V} we have
        \begin{multline}
            X = V(I(X)) = V(Q_1 \cap \dotsb \cap Q_r) = V(Q_1) \cup \dotsb \cup V(Q_r)\\
            = V(\sqrt{Q_1}) \cup \dotsb \cup V(\sqrt{Q_r})
        \end{multline}
        and since \(\sqrt{Q_i}\) is prime the \(V(\sqrt{Q_i})\) are irreducible by \cref{rmk:bijection between prime ideals and irreducible subvars}.
        Keeping only the minimal prime ideals, corresponding to maximal affine subvarieties, we obtain the irreducible decomposition of \(X\).
        
        This gives us the following bijection:
        \begin{equation}
            \{\text{irreducible components of }X\} \xleftrightarrow{1:1} \{\text{minimal prime ideals of } A(X)\}.
        \end{equation}
    \end{remark}
    
    We have previously remarked that open sets are \enquote{big} in the Zariski topology.
    For example, in \(\affine^1\) the open sets are precisely the cofinite sets.
    We see this particularly when we consider irreducible affine varieties.
    
    Let \(X\) be an irreducible topological space, and let \(U, U' \subsetneq X\) be open and nonempty.
    Then \(U \cap U'\) is never empty.
    Suppose that \(U \cap U' = \emptyset\), then taking the complement of this we have \(X \setminus (U \cap U') = (X \setminus U) \cup (X \setminus U') = X \setminus \emptyset = X\), and since \(U\) and \(U'\) are open their complements are closed, so this contradicts \(X\) being irreducible.
    Intuitively, any two open sets are (edge cases aside) always so large that they overlap, no matter how we choose them.
    
    Further, the closure of \(U\), the smallest closed subset containing \(U\), denoted \(\overline{U}\), is all of \(X\).
    That is, \(U\) is \defineindex{dense} in \(X\).
    To see this suppose that \(Y \subseteq X\) is a closed subset containing \(U\).
    Then \(X = Y \cup (X \setminus U)\), and since \(X\) is irreducible and \(X \setminus U \ne X\) it must be that \(Y = X\), and in particular this is true when \(Y = \overline{U}\).
    Intuitively, this means that if \(U\) is open then while it may not contain all of \(X\) it contains something \enquote{close} to any given point of \(X\).
    
    \chapter{Dimension}
    We have an intuitive notion of dimension, from our knowledge of vector spaces or manifolds.
    The dimension is the number of degrees of freedom, it's the number of pieces of information we need to specify to pick out a particular point.
    We know from manifolds that precisely how this information specifies a point only works in a neighbourhood of the point.
    
    Here we'll define the dimension in terms of topological properties.
    Then we'll show that it aligns with a notion of dimension for the corresponding coordinate rings.
    
    \section{Dimension of a Topological Space}
    The key idea here is that if \(X\) is irreducible then any closed proper subset aught to have a smaller dimension than \(X\).
    If we want this to hold then we have to look at all chains of inclusions of closed subsets, and define the dimension to be large enough that all of the subsets can have lower dimension, remembering that of course we want the dimension to be a natural number if finite.
    
    \begin{dfn}{Dimension}{}
        Let \(X\) be a nonempty topological space.
        The \define{dimension}\index{dimension!of a topological space} of \(X\), \(\dim X\), is the supremum over all \(n \in \naturals\) such that there exists a chain,
        \begin{equation}
            \emptyset \neq Y_0 \subsetneq Y_1 \subsetneq \dotsb \subsetneq Y_n,
        \end{equation}
        of length \(n\) consisting of irreducible closed subsets, \(Y_i \subseteq X\).
        If the supremum doesn't exist the dimension is \(\infty\).
    \end{dfn}
    
    The idea here is that we can take \(Y_i\) to have dimension \(i\), so that \(X\) having dimension \(n\) still leaves room to fit all of these smaller spaces.
    
    \begin{dfn}{Codimension}{}
        Let \(X\) be a nonempty topological space, and let \(Y\) be a nonempty irreducible closed subset of \(X\).
        The \define{codimension}\index{codimension!of a topoloigcal space} of \(Y\) in \(X\), \(\codim_X Y\), is the supremum over all \(n \in \naturals\) such that there exists a chain,
        \begin{equation}
            Y \subseteq Y_0 \subsetneq Y_1 \subsetneq \dotsb \subsetneq Y_n
        \end{equation}
        of length \(n\) consisting of irreducible closed subsets of \(X\) containing \(Y\).
        If the supremum doesn't exist the codimension is \(\infty\).
    \end{dfn}
    
    Similar to the notion of dimension, the codimension of \(Y_i\) being \(i + \dim Y\) lets us fit all of these spaces between \(Y\) and \(X\), and so we should have \(\dim X = n + \dim Y\), or \(n = \dim X - \dim Y\), which intuitively is what the codimension should be.
    
    \begin{ntn}{}{}
        For the dimension of a vector space, \(V\), over \(K\) we write \(\dim_K V\), leaving \(\dim X\) without a subscript for the topological dimension.
    \end{ntn}
    
    \begin{exm}{}{}
        The affine space, \(\affine^1\), has dimension 1, since the maximal chains of nonempty irreducible closed subsets of \(\affine^1\) are just \(\{p\} \subsetneq \affine^1\) for \(p \in \affine^1\), which all have length 1.
        Similarly, \(\codim_{\affine^1} \{p\} = 1\).
    \end{exm}
    
    \begin{remark}{}{}
        We typically think of being Noetherian as a finiteness condition.
        However, it is not strong enough to imply finite dimension.
        For example, consider \(X = \naturals\) equipped with the topology in which the closed subsets are \(\emptyset\), \(X\), and \(Y_n = \{0, \dotsc, n\}\) for \(n \in \naturals\).
        Then \(X\) is Noetherian, but has chains \(Y_0 \subsetneq Y_1 \subsetneq \dotsb \subsetneq Y_n\) of nonempty irreducible closed subsets of arbitrary length, and thus the supremum of their lengths is \(\infty\).
    \end{remark}
    
    Fortunately, for affine varieties this infinite-dimension problem cannot occur.
    To see this we need an algebraic notion of dimension.
    
    \section{Dimension of a Ring}
    We now give an algebraic notion of the dimension of a ring.
    This definition is constructed precisely so that it corresponds to the notion of dimension in the previous section.
    
    \begin{dfn}{Krull Dimension}{}
        Let \(R\) be a ring.
        The \defineindex{Krull dimension}\index{dimension!of a ring}, \(\Kdim R\), of \(R\) is the supremum over all \(n \in \naturals\) such that there exists a chain,
        \begin{equation}
            \ideal{p}_0 \subsetneq \ideal{p}_1 \subsetneq \dotsb \subsetneq \ideal{p}_n
        \end{equation}
        of length \(n\) consisting of prime ideals, \(\ideal{p}_i \subideal R\).
    \end{dfn}
    
    Similarly, we can give an algebraic definition of codimension.
    Note that since we've moved to the algebraic side we're looking at chains ending with \(\ideal{p}\), whereas on the topology side we looked at chains starting with \(Y\).
    
    \begin{dfn}{Height}{}
        Let \(R\) be a ring with prime ideal \(\ideal{p}\).
        The \defineindex{height} of \(\ideal{p}\), also known as the \define{codimension}\index{codimension!of a ring}, \(\codim_R \ideal{p}\), is the supremum over all \(n\) such that there exists a chain,
        \begin{equation}
            \ideal{p}_0 \subsetneq \ideal{p}_1 \subsetneq \dotsb \subsetneq \ideal{p}_n \subsetneq \ideal{p}
        \end{equation}
        of length \(n\) consisting of prime ideals contained in \(\ideal{p}\).
    \end{dfn}
    
    We can now show that these two notions of (co)dimension actually agree for affine varieties.
    
    \begin{lma}{}{}
        Let \(X\) be a nonempty affine variety.
        Then \(\dim X = \Kdim A(X)\).
        
        Further, if \(Y\) is a nonemtpy irreducible affine subvariety of \(X\) then \(\codim_X Y = \codim_{A(X)} I(Y)\).
        \begin{proof}
            Every chain of nonempty irreducible closed subsets of \(X\) corresponds to a chain of prime ideals of \(A(X)\).
            Thus, the corresponding notions of dimension are equivalent.
            
            We know that \(I(Y)\) is a prime ideal of \(A(X)\).
            If we require that the chain in \(X\) starts with \(Y\) this is equivalent to requiring that the corresponding chain in \(A(X)\) ends with \(I(Y)\), since \(I\) reverses inclusions (\cref{lma:I reverses inclusion}).
            Thus, the corresponding notions of codimension are equivalent.
        \end{proof}
    \end{lma}
    
    Note that a finitely generated algebra over a field always has finite dimension.
    Hence \(A(X)\) has finite dimension, since it's a quotient of \(K[x_1, \dotsc, x_n]\) which is the free commutative algebra over \(K\) generated by \(x_1, \dotsc, x_n\).
    Thus, \(X\) has finite dimension.
    Note that \(\Kdim K[x_1, \dotsc, x_n] = n\) \cite[Prop 11.9(a)]{gathmann.comm.alg}.
    
    \begin{prp}{}{prp:dimension facts}
        Let \(X\) and \(Y\) be nonempty irreducible affine varieties.
        \begin{enumerate}
            \item \label{itm:dim product is sum dims}\(\dim (X \times Y) = \dim X + \dim Y\) (where \(X \times Y\) is equipped with the Zariski topology, not the product topology).
            \item As a special case of the above, \(\dim \affine^n = n\).
            \item \label{itm:dim is dim plus codim}If \(Y \subseteq X\) then \(\dim X = \dim Y + \codim_X Y\).
            \item As a special case of the above \(\codim_X \{p\} = \dim X\) for all \(p \in X\).
            \item \label{itm:irreducible components of V(f) have codim 1}If \(f \in A(X)\) is nonzero then every irreducible component of \(V(f)\) has codimension \(1\) in \(X\), and hence dimension \(\dim X - 1\).
        \end{enumerate}
        \begin{proof}
            \Cref{itm:dim product is sum dims} follows from the equivalent statement for the ideals, which in turn follows from \cite[Ex 11.33]{gathmann.comm.alg}.
            
            \Cref{itm:dim is dim plus codim} holds because all maximal chains of prime ideals in \(A(X)\) have the same length (which is not the case in an arbitrary ring) \cite[Crl 11.12]{gathmann.comm.alg}.
            Thus, any maximal chain containing the prime ideal \(I(Y)\) has length \(\dim X\).
            
            \Cref{itm:irreducible components of V(f) have codim 1} follows from the equivalent algebraic statement, which is known as Krull's principal ideal theorem \cite[Prop 11.15]{gathmann.comm.alg}.
        \end{proof}
    \end{prp}
    
    \begin{exm}{}{}
        Consider the affine variety \(X = V(x_2 - x_1^2) \subseteq \affine_{\complex}^2\).
        The real points of this are shown in \cref{fig:real points of x squared}.
        
        This is irreducible, since its coordinate ring is \(A(X) = \complex[x_1, x_2] / \langle x_2 - x_1^2 \rangle \isomorphic \complex[x_1, x_1^2] = \complex[x_1]\).
        
        The dimension of this variety is, as expected, \(1\), since it is the zero locus of a single nonzero polynomial in \(\affine_{\complex}^2\) and \(\dim \affine_{\complex}^2 = 2\) so \(\dim X = \dim \affine^2 - 1\).
    \end{exm}
    
    \begin{figure}
        \centering
        \tikzsetnextfilename{quadratic-variety}
        \begin{tikzpicture}
            \draw [thick, my blue, ->] (-3, 0) -- (3, 0) node [above] {\(x_1\)};
            \draw [thick, my blue, ->] (0, -1) -- (4.5, 0) node [left] {\(x_2\)};
            \draw [very thick, my red, domain=-3:3, samples=100] plot (\x, \x*\x/2) node [below right] {\(X_1\)};
            \fill [my green] (0, 0) circle [radius = 0.1] node [below] {\(X_1 \cap X_2\)};
        \end{tikzpicture}
        \caption[Quadratic variety.]{The real points of the affine variety \(V(x_2 - x_1^2)\).}
        \label{fig:real points of x squared}
    \end{figure}
    
    Note that irreducibility is required for the above statements to be true.
    However, if we relax this condition then we can still say something provided we know the irreducible decomposition of the affine variety, \(X = X_1 \cup \dotsb \cup X_r\).
    The dimension of \(X\) is simply the largest dimension of any of its irreducible components,
    \begin{equation}
        \dim X = \max\{\dim X_1, \dotsc, \dim X_r\}.
    \end{equation}
    We must have that \(\dim X\) is at least the greatest dimension of an irreducible component, since any chain in an irreducible component is also a chain in \(X\).
    We must have that \(\dim X\) is bounded above by the largest dimension of one of its irreducible components because if \(Y_0 \subsetneq \dotsb \subsetneq Y_n\) is a chain of nonempty irreducible affine subvarieties of \(X\) then \(Y_n = (Y_n \cap X_1) \cup \dotsb \cup (Y_n \cap X_r)\) is a union of closed subsets, and since \(Y_n\) is irreducible it must be that these are empty except for one term, so \(Y_n = Y_n \cap X_i\), but then this chain is also a chain in \(X_i\), meaning that \(\dim X_i \ge n\).
    
    This result allows us to mostly focus on irreducible spaces when we're considering dimension.
    
    Another result that can allow us to determine the dimension of \(X\) is that, even if \(X\) is reducible,
    \begin{equation}
        \dim X = \sup\{\codim_X \{a\} \mid a \in X\}.
    \end{equation}
    If \(\codim_X \{a\} \ge n\) there must be some chain, \(\{a\} \subseteq Y_0 \subsetneq \dotsb \subsetneq Y_n\) of irreducible affine subvarieties of \(X\), which shows \(\dim X \ge n\).
    If \(\dim X \ge n\) then there is a chain \(Y_0 \subsetneq \dotsb \subsetneq Y_n\) of nonempty affine subvarieties of \(X\), and then for any \(a \in Y_0\) this chain shows that \(\codim_X \{a\} \ge n\).
    
    \begin{exm}{}{}
        Consider the affine variety \(X = V(x_1x_3, x_2x_3) \subseteq \affine^3\).
        Looking at the equations we see that a point in \(X\) must either have \(x_3 = 0\) or both \(x_1 = 0\) and \(x_2 = 0\).
        That is, \(X = V(x_3) \cup V(x_1, x_2)\).
        Both of these are irreducible, since their defining equations are linear.
        The first, \(V(x_3)\), consists of all points \((x_1, x_2, 0)\), so it's the \((x_1, x_2)\)-plane.
        The second, \(V(x_1, x_2)\), consists of all points \((0, 0, x_3)\), so it's the \(x_3\)-axis.
        This is shown in \cref{fig:plane line variety}.
        
        We have that \(\dim V(x_3) = 1\), because it's defined by a single nonzero equation.
        Alternatively, the largest chain we can make inside \(V(x_3)\) is \(X_0 \subsetneq X_1\) where \(X_0\) is a point on the \(x_3\)-axis and \(X_1 = V(x_3)\) is the whole \(x_3\)-axis.
        This is shown in \cref{fig:plane line variety line chain}.
        
        We also have \(\dim V(x_1, x_2) = 2\) since the largest chain we can make in this space is \(Y_0 \subsetneq Y_1 \subsetneq Y_2\) where \(Y_0\) is a point in the \((x_1, x_2)\)-plane, \(Y_1\) is a line in the \((x_1, x_2)\) plane containing \(Y_0\), and \(Y_0 = V(x_1, x_2)\) is the entire \((x_1, x_2)\)-plane.
        This is shown in \cref{fig:plane line variety plane chain}.
        
        Of course, these are exactly the dimensions we would expect a line and a plane to have.
        By the remark above we have that \(\dim X = \max\{1, 2\} = 2\).
        Intuitively, \(\dim X\) is the maximum number of degrees of freedom needed to specify a point anywhere on the variety, even if some parts of the variety, the line in this case, don't require that amount of information.
        
        Continuing with this example note that \(X_0\), a point on the line, has codimension \(1\), and \(Y_0\), a point on the plane, has codimension \(2\).
        This demonstrates how we can think of the codimension of a point as being the local dimension of the affine variety.
        Then \cref{prp:dimension facts} \cref{itm:dim is dim plus codim} is a statement that the local dimension of an \emph{irreducible} affine variety is the same everywhere.
    \end{exm}
    
    \begin{figure}
        \centering
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{variety-plane-line}
            \begin{tikzpicture}[scale=0.5]
                \fill [my green] (-3, 0, -2) -- (3, 0, -2) -- (3, 0, 2) node [right, xshift=0.1cm] {\(V(x_1, x_2)\)}  -- (-3, 0, 2) -- cycle;
                \draw [very thick, my blue] (0, 0, 0) -- (0, 3, 0)  node [below right, yshift=0.2cm] {\(V(x_3)\)};
                \draw [very thick, my blue] (0, -0.77, 0) -- (0, -3, 0);
            \end{tikzpicture}
            \caption[The affine variety \(V(x_1x_2, x_2x_3)\).]{The affine variety \(V(x_1x_3, x_2x_3) = V(x_3) \cup V(x_1, x_2)\).}
            \label{fig:plane line variety}
        \end{subfigure}
        
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{variety-plane-line-line-chain}
            \begin{tikzpicture}[scale=0.5]
                \fill [lightgray] (-3, 0, -2) -- (3, 0, -2) -- (3, 0, 2) -- (-3, 0, 2) -- cycle;
                \draw [very thick, gray] (0, 0, 0) -- (0, 3, 0);
                \draw [very thick, gray] (0, -0.77, 0) -- (0, -3, 0);
                \fill [my red] (0, 2, 0) circle [radius=0.1cm] node [right] {\(X_0\)};
                \begin{scope}[xshift=7cm]
                    \fill [lightgray] (-3, 0, -2) -- (3, 0, -2) -- (3, 0, 2) -- (-3, 0, 2) -- cycle;
                    \draw [very thick, my red] (0, 0, 0) -- (0, 3, 0) node [below right, yshift=0.1cm, xshift=-0.1cm] {\(X_1\)};
                    \draw [very thick, my red] (0, -0.77, 0) -- (0, -3, 0);
                    \fill [my red] (0, 2, 0) circle [radius=0.1cm];
                \end{scope}
            \end{tikzpicture}
            \caption{A maximal length chain in \(V(x_3)\).}
            \label{fig:plane line variety line chain}
        \end{subfigure}
        
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{variety-plane-line-plane-chain}
            \begin{tikzpicture}[scale=0.5]
                \fill [lightgray] (-3, 0, -2) -- (3, 0, -2) -- (3, 0, 2) -- (-3, 0, 2) -- cycle;
                \draw [very thick, gray] (0, 0, 0) -- (0, 3, 0);
                \draw [very thick, gray] (0, -0.77, 0) -- (0, -3, 0);
                \fill [my red] (2, 0, 1) circle [radius=0.1cm] node [above] {\(Y_0\)};
                \begin{scope}[xshift=7cm]
                    \fill [lightgray] (-3, 0, -2) -- (3, 0, -2) -- (3, 0, 2) -- (-3, 0, 2) -- cycle;
                    \draw [very thick, gray] (0, 0, 0) -- (0, 3, 0);
                    \draw [very thick, gray] (0, -0.77, 0) -- (0, -3, 0);
                    \fill [my red] (2, 0, 1) circle [radius=0.1cm];
                    \draw [my red, very thick] (3, 0, 1.5) -- (-3, 0, -1.5) node [above, shift={(0.3, -0.15)}] {\(Y_1\)};
                \end{scope}
                \begin{scope}[xshift=14cm]
                    \fill [my red] (-3, 0, -2) node [above right, yshift=-0.1cm] {\(Y_2\)} -- (3, 0, -2) -- (3, 0, 2) -- (-3, 0, 2) -- cycle;
                    \draw [very thick, gray] (0, 0, 0) -- (0, 3, 0);
                    \draw [very thick, gray] (0, -0.77, 0) -- (0, -3, 0);
                \end{scope}
            \end{tikzpicture}
            \caption{A maximal length chain in \(V(x_1, x_2)\).}
            \label{fig:plane line variety plane chain}
        \end{subfigure}
        \caption[The affine variety \(V(x_1x_3, x_2x_3)\).]{The affine variety \(V(x_1x_3, x_2x_3)\) with its irreducible decomposition, and maximal chains in each irreducible component.}
    \end{figure}
    
    Often it's useful to restrict to cases where all irreducible components have the same dimension.
    For this we introduce the following terminology.
    
    \begin{dfn}{Pure Dimension}{}
        A Noetherian topological space, \(X\), is of \defineindex{pure dimension}\index{dimension!pure} \(n\) if every irreducible component of \(X\) has dimension \(n\).
    \end{dfn}
    
    There are common shorthands for some special pure (co)dimensions.
    
    \begin{dfn}{}{}
        An affine variety is
        \begin{enumerate}
            \item a \defineindex{curve} if it has pure dimension \(1\);
            \item a \defineindex{surface} if it has pure dimension \(2\);
            \item a \defineindex{hypersurface} in a pure-dimensional affine variety \(Y\) if it is an affine subvariety of \(Y\) of pure dimension \(\dim Y - 1\).
        \end{enumerate}
    \end{dfn}
    
    \begin{wrn}
        These terms are not used consistently.
        Some authors require that a curve is irreducible, and others allow a curve to refer to any affine variety whose irreducible components have dimension at most \(1\).
        Our choice is somewhere between these, we do not require that a curve is irreducible, but we do require that its irreducible components have dimension \emph{exactly} \(1\).
    \end{wrn}
    
    Notice that \cref{prp:dimension facts} \cref{itm:irreducible components of V(f) have codim 1} is a statement that if \(f \in A(X)\) is nonzero then \(V(f)\) is a hypersurface.
    
    This suggests that we should ask if \emph{every} hypersurface is of this form.
    It turns out that the answer actually depends on some algebraic properties of \(A(X)\).
    Specifically, whether \(A(X)\) is a UFD.
    This is because of the following result.
    
    \begin{prp}{}{prp:ufd iff prime ideal codim 1 principal}
        Let \(R\) be a Noetherian integral domain.
        Then the following are equivalent:
        \begin{enumerate}
            \item \label{itm:ufd}\(R\) is a UFD.
            \item \label{itm:prime ideal codim 1 principal}Every prime ideal of codimension \(1\) in \(R\) is principal.
        \end{enumerate}
        \begin{proof}
            We first show that \cref{itm:prime ideal codim 1 principal} implies \cref{itm:ufd}.
            Since \(R\) is Noetherian we can decompose any nonzero nonunit, \(f \in R\), as a product of irreducible elements.
            If this were not the case then \(f\) could not itself be irreducible, and so \(f = f_1 f_1'\) and one of these must also not be decomposable, say \(f_1'\), so \(f_1' = f_2f_2'\).
            Repeating this gives a chain \(\langle f \rangle \subsetneq \langle f_1' \rangle \subsetneq \langle f_2' \rangle \subsetneq\), contradicting the fact that \(R\) is Noetherian.
            
            To prove that \(R\) is a UFD it is sufficient to show that every irreducible element, \(f \in R\), is prime.
            To do so choose a minimal prime ideal, \(\ideal{p}\), containing \(f\).
            Then by Krull's principal ideal theorem (\cref{prp:dimension facts} \cref{itm:irreducible components of V(f) have codim 1}) we have that \(\codim \ideal{p} = 1\), and so \(\ideal{p}\) is principal by assumption.
            That is, \(\ideal{p} = \langle g \rangle\) for some prime element, \(g \in R\).
            However, \(g\) divides \(f\) and \(f\) is irreducible, so up to units \(f = g\), and thus \(f\) is also prime.
            
            We now show that \cref{itm:ufd} implies \cref{itm:prime ideal codim 1 principal}.
            Let \(\ideal{p}\) be a prime ideal of codimension 1 in \(R\).
            Then we can choose a nonzero element, \(f \in \ideal{p}\).
            Since \(\ideal{p} \ne \langle 1 \rangle\) we know that \(f\) is not a unit.
            Since \(R\) is a UFD we can uniquely (up to order) write \(f = f_1 \dotsm f_k\) for \(f_i \in R\) prime.
            Then since \(\ideal{p}\) is prime it must be that at least one of the \(f_i\) is in \(\ideal{p}\).
            Since the codimension of \(\ideal{p}\) is 1 this requires that \(\ideal{p} = \langle f_i \rangle\), and thus \(\ideal{p}\) is principal.
        \end{proof}
    \end{prp}
    
    Let \(X\) be an irreducible hypersurface in \(\affine^n\).
    Then \(I(X) \subideal K[x_1, \dotsc, x_n]\) is a prime ideal of codimension \(1\).
    Since \(K[x_1, \dotsc, x_n]\) is a UFD it follows that \(I(X) = \langle f \rangle\) for some \(f \in K[x_1, \dotsc, x_n]\).
    
    If \(X\) is a hypersurface, but not necessarily irreducible, then we can apply the same argument to each irreducible component of \(X = X_1 \cup \dotsb \cup X_r\), showing that \(I(X_i) = \langle f_i \rangle\) for some \(f_i \in K[x_1, \dotsc, x_n]\).
    Then \(I(X) = \langle f \rangle\) with \(f = f_1 \dotsm f_k\), which is again principal.
    
    \begin{dfn}{}{}
        Let \(X\) be an affine hypersurface in \(\affine^n\) with ideal \(I(X) = \langle f \rangle\).
        Then the \defineindex{degree} of \(X\) is the degree of \(f\) as a polynomial.
    \end{dfn}
    
    This degree is well defined because of the uniqueness of factorisation.
    For example, over \(\complex\), up to units and reordering, \(f(x) = (x - a_1) \dotsm (x - a_k)\) with \(a_i\) the roots of \(f\), and then \(f\) has degree \(k\).
    This lets us talk of linear, quadric, or cubic hypersurfaces, and so on.
    
    It is generally a hard problem to find out if \(A(X)\) is a UFD for a given affine vareity.
    The following example is just one case in which \(A(X)\) is not principal.
    
    \begin{exm}{}{exm:coordinate ring which isnt a ufd}
        Let \(R = K[x_1, x_2, x_3, x_4] / \langle x_1x_4 - x_2x_3 \rangle\).
        This is a three dimensional integral domain.
        The elements \(x_1\), \(x_2\), \(x_3\) and \(x_4\) are irreducible, but not prime.
        Thus, \(R\) is not a UFD.
        Both \(x_1x_4\) and \(x_2x_3\) are decompositions of the same element of \(R\) into irreducible elements, and they don't agree up to units.
        The ideal \(\langle x_1, x_2\rangle\) is prime and of codimension \(1\) in \(R\), but it is not principal.
        
        Thus, by \cref{prp:ufd iff prime ideal codim 1 principal} the plane, \(V(x_1, x_2)\), is a hypersurface in \(X = V(x_1x_4 - x_2x_3)\), but the ideal of \(V(x_1, x_2)\) cannot be generated by a single element of \(A(X)\).
    \end{exm}
    
    \chapter{The Sheaf of Regular Functions}
    Now that we've defined affine varieties, and given them some structure, we're ready to look at maps between them.
    As usual, we'll look for maps preserving the relevant structure.
    This is actually a fairly hard question, requiring us to define something called a sheaf.
    For this section we'll only consider the simplest example, we'll look for morphisms from an affine variety, \(X\), to the ground field, which we view as an affine variety, \(K = \affine^1\).
    When we say \enquote{function} (on \(X\)) we will mostly mean functions \(X \to K\).
    
    \section{Regular Functions}
    Much of our thinking will be inspired by the theory of manifolds.
    So keep in mind the idea of smooth functions from a manifold to \(\reals\).
    These are just normal functions, but with an extra local condition of smoothness.
    Local meaning that smoothness can be checked on a neighbourhood of a point, and we get that a function is smooth everywhere precisely when it is smooth on any open neighbourhood of all points.
    
    Unlike the manifold case we don't have a notion of smoothness, at least not yet.
    Instead our local condition will be that our functions should look like rational functions in a neighbourhood of any given point.
    They need not have this structure globally, by which we mean that the polynomials forming our rational function need not be the same on different neighbourhoods.
    
    Of course, the assumption that we're working with polynomials is valid only if we're working with a subvariety of \(\affine^n\), if we want to work relative to some other variety then we have to talk of quotients of polynomial functions in \(A(X)\).
    
    \begin{dfn}{Regular Function}{}
        Let \(X\) be an affine variety, and let \(U \subseteq X\) be open.
        A \defineindex{regular function} on \(U\) is a map, \(\varphi \colon U \to K\), with the following property: for all \(a \in U\) there are polynomial functions, \(f, g \in A(X)\), with \(g(x) \ne 0\) and
        \begin{equation}
            \varphi(x) = \frac{f(x)}{g(x)}
        \end{equation}
        for all \(x \in U_a\) where \(U_a \subseteq U\) is an open neighbourhood of \(a\).
        
        We write \(\sheaf{O}_X(U)\) for the set of all regular functions on \(U\).
    \end{dfn}
    
    Note that \(\sheaf{O}_X(U)\)\ is a \(K\)-algebra under pointwise operations.
    However, the common terminology is to refer to \(\sheaf{O}_X(U)\) as the \emph{ring} of regular functions on \(U\), ignoring the additional vector space structure.
    
    \begin{ntn}{}{}
        For the condition that \(\varphi(x) = f(x)/g(x)\) for all \(x \in U_a\) we usually say that \(\varphi = f/g\) on \(U_a\), although this is really an abuse of notation.
        In this case \(f/g\) is pointwise division of functions, not say, some element of a ring localised at \(g\), although sometimes it can be interpreted as such.
    \end{ntn}
    
    \begin{exm}{}{}
        Consider the three dimensional affine variety \(X = V(x_1x_4 - x_2x_3) \subseteq \affine^4\).
        An open subset of this is give by
        \begin{equation}
            U = X \setminus V(x_2, x_4) = \{(x_1, x_2, x_3, x_4) \in X \mid \text{one of } x_2 \text{ and } x_3 \text{ is nonzero}\}.
        \end{equation}
        We can define a function on \(U\) by
        \begin{align}
            \varphi \colon U &\to K\\
            (x_1, x_2, x_3, x_4) &\mapsto
            \begin{cases}
                \frac{x_1}{x_2} & x_2 \ne 0;\\
                \frac{x_3}{x_4} & x_4 \ne 0.
            \end{cases}
        \end{align}
        Notice that since \(x_1 x_4 - x_2 x_3 = 0\) on \(X\) when both fractions are defined we always have that \(x_1/x_2 = x_3/x_4\).
        This means that this is a well-defined function.
        Clearly this function is locally a quotient of polynomials.
        In a neighbourhood of \(x_2 = 0\) it's given by \(x_3/x_4\), and in a neighbourhood of \(x_4 = 0\) it's given by \(x_1/x_2\).
        However, neither of these two ratios can be used to define the function on all of \(U\), since one is undefined at \((0, 0, 0, 1)\) and the other at \((0, 1, 0, 0)\).
        
        Algebraically we're using the fact that, as mentioned in \cref{exm:coordinate ring which isnt a ufd}, \(A(X)\) is not a UFD.
    \end{exm}
    
    While regular functions are not (in general) polynomials it still makes sense to consider their zero loci, and we can in fact see that regular functions are sufficiently close to being polynomial for several facts to carry over to zero loci of regular functions.
    
    \begin{dfn}{}{}
        Let \(X\) be an affine variety and \(U \subseteq X\) open.
        The zero locus of a regular function, \(\varphi \in \sheaf{O}_X(U)\), is
        \begin{equation}
            V(\varphi) = \{x \in U \mid \varphi(x) = 0\}.
        \end{equation}
    \end{dfn}
    
    \begin{lma}{}{lma:zero locus of regular function is closed}
        The zero locus of a regular function is closed.
        \begin{proof}
            Let \(X\) be an affine variety, \(U \subseteq X\) an open subset, and \(\varphi \in \sheaf{O}_X(U)\) a regular function.
            Then any \(a \in U\) admits an open neighbourhood, \(U_a \subseteq U\), on which \(\varphi = f_a/g_a\) for some \(f_a, g_a \in A(X)\) with \(g_a\) nonzero on \(U_a\).
            Then we have that
            \begin{equation}
                U_a \setminus V(\varphi) = \{x \in U_a \mid \varphi(x) \ne 0\} = U_a \setminus V(g_a),
            \end{equation}
            since \(\varphi\) is only nonzero on \(U_a\) when \(g_a\) is nonzero.
            Thus, \(U_a \setminus V(\varphi)\) is the complement of an open set by a closed one, so is open, and hence \(U_a \setminus V(\varphi)\) is open in \(X\).
            Then the union over \(a\) of all such sets is also open, and this union is just \(U \setminus U(\varphi)\).
            Thus, \(V(\varphi)\) is closed in \(U\).
        \end{proof}
    \end{lma}
    
    A consequence of this result is the following.
    If we have nonempty open subsets, \(U \subseteq V \subseteq X\), with \(X\) an irreducible affine variety then for regular functions \(\varphi_1, \varphi_2 \in \sheaf{O}_X(U)\) if \(\varphi_1\) and \(\varphi_2\) agree on \(U\) they must agree on all of \(V\).
    The reason for this is that the locus \(V(\varphi_1 - \varphi_2)\), where the two functions agree, contains \(U\), and thus is closed in \(V\).
    Thus it also contains the closure, \(\overline{U}\), of \(U\) in \(V\), but \(\overline{V} = X\) by our earlier remark that open sets in the Zariski topology are dense (end of \cref{sec:noetherian spaces}).
    Thus, \(V\) is irreducible, and then again this means that the closure of \(U\) in \(V\) is \(V\), and so it must be that \(\varphi_1 - \varphi_2\) actually vanishes on \(V\), so \(\varphi_1 = \varphi_2\) on all of \(V\).
    
    This statement is true because open subsets in the Zariski topology are so large, so their overlap is always substantial.
    For example, over \(\complex\) it is also true that the closure of \(U\) in \(V\) is all of \(V\), and thus \(\varphi_1 = \varphi_2\) on \(V\) follows from the fact that \(\varphi_1|_U = \varphi_2|_U\) and the \(\varphi_i\) are continuous.
    In fact, this statement also holds if we replace regular functions in the standard topology with holomorhpic functions.
    Two holomorphic functions on a connected open subset, \(V \subseteq \complex^n\), must be the same function if they agree on a smaller nonemptysubset \(U \subseteq V\).
    This is known as the \defineindex{identity theorem} for holomorphic functions, so we might call our result the \define{identity theorem} for regular functions.
    Much of the power of complex analysis comes from the fact that \(U\) can be very small, such as being the boundary of \(V\).
    This makes the result much more surprising than the same result in the Zariski topology, where \(U\) will always be large.
    This is just one of many results that has both a complex-analytic version and an algebro-geometric version.
    Another such result which we'll see soon is the existence of removable singularities (\cref{exm:extending regular functions over a point}).
    
    Next we'll compute what the \(K\)-algebra \(\sheaf{O}_X(U)\) is in some cases.
    An important case is when \(U\) is the complement of the zero locus of a single polynomial function.
    It turns out in this case that it's always possible to define regular functions globally as a ratio of polynomial functions, and that the denominator is always just some power of the original polynomial function.
    
    \begin{dfn}{Distinguished Open Subset}{}
        Let \(X\) be an affine variety and \(f \in A(X)\) a polynomial function on \(X\).
        We call
        \begin{equation}
            D(f) = X \setminus V(f) = \{x \in X \mid f(x) \ne 0\}
        \end{equation}
        the \defineindex{distinguished open subset} of \(f\) in \(X\).
    \end{dfn}
    
    The nice thing about the distinguished open subsets is that they behave nicely with respect to intersections and unionts.
    For any \(f, g \in A(x)\) we have that
    \begin{equation}
        D(f) \cap D(g) = D(fg)
    \end{equation}
    since \(x \in D(f) \cap D(g)\) if and only if \(f(x) \ne 0\) and \(g(x) \ne 0\) if and only if \(f(x)g(x) \ne 0\) if and only if \(x \in D(fg)\).
    In particular, this means that finite intersections of distinguished open sets are distinguished open sets.
    
    Further, all open sets, \(U \subseteq X\), arise in this way.
    By definition to be open \(U\) must be the complement of some closed subset, so \(U = X \setminus V(f_1, \dotsc, f_k)\) for some \(f_i \in A(X)\).
    Then by \cref{lma:intersection of defining equations} and De Morgan's laws
    \begin{equation}
        U = X \setminus V(f_1, \dotsc, f_k) = X \setminus (V(f_1) \cap \dotsb \cap V(f_k)) = D(f_1) \cup \dotsb \cup D(f_k).
    \end{equation}
    
    This means that, in a sense, the distinguished open subsets are the \enquote{smallest} open subsets of \(X\).
    In a more precise sense, the distinguished open subsets form a basis of the Zariski topology.
    
    For this reason it's particularly important to understand the regular functions on distinguished open subsets, which we do with the following result.
    
    \begin{prp}{}{prp:regular functions on distinguished open}
        Let \(X\) be an affine variety, and let \(f \in A(X)\).
        Then
        \begin{equation}
            \sheaf{O}_X(D(f)) = \left\{ \frac{g}{f^n} \,\middle|\, g \in A(X), n \in \naturals \right\}.
        \end{equation}
        In particular, on a distinguished open subset a regular function is always globally the quotient of two polynomial functions.
        \begin{proof}
            The inclusion of the right hand side in the left is clear, every function of the form \(f/g^n\) with \(g \in A(X)\) is a regular function on \(D(f)\).
            
            For the opposite inclusion let \(\varphi \colon D(f) \to K\) be a regular function.
            Then for any \(a \in D(f)\) there exists some local representation, \(\varphi = g_a/f_a\) for some \(f_a, g_a \in A(X)\), valid on an open neighbourhood, \(U_a \subseteq U\), of \(a\).
            We can always then find within \(U_a\) a distinguished open subset, \(D(h_a)\), for some \(h_a \in A(X)\).
            We can then write \(g_a/f_a = g_ah_a / f_ah_a\) on \(D(h_a)\), since by definition \(h_a\) is nonzero on \(D(h_a)\).
            Then both the numerator and denominator of this representation of \(\varphi\) vanish on \(V(h_a)\), which is the complement of \(D(h_a)\).
            This means that the denominator vanishes on \(V(h_a)\) and not on \(D(h_a)\), meaning the denominator has exactly the same zero locus as \(h_a\).
            This allows us to assume that the denominator is \(h_a\).
            
            As a consequence we have that in \(A(X)\) \(g_af_b = g_bf_a\) for all \(a, b \in D(f)\), since these two functions must agree on \(D(f_a) \cap D(f_b)\) as on this region both are valid representations of \(\varphi\), so must be equal, and outside this region both vanish, so are again equal.
            
            
            We have that \(D(f) = \bigcup_{a \in D(f)} D(f_a)\), and taking the complement
            \begin{equation}
                V(f) = \bigcap_{a \in D(f)} V(f_a) = V(\{f_a \mid a \in D(f)\}).
            \end{equation}
            Then by the relative Nullstellensatz (\cref{thm:relative nullstellensatz}) we have
            \begin{equation}
                f \in I(V(f)) = I(V(\{f_a \mid a \in D(f)\})) = \sqrt{\langle f_a \mid a \in D(f) \rangle}.
            \end{equation}
            Thus, \(f^n = \sum_a k_a f_a\) for some \(n \in \naturals\) and \(k_a \in A(X)\), and \(k_a\) is nonzero for only finitely many \(a \in D(f)\).
            Then if we set \(g = \sum_a k_a g_a\), with the same coefficients as \(f^n\), we have that \(\varphi = g/f^n\) on \(D(f)\) since for all \(b \in D(f)\) we have \(\varphi = g_b / f_b\) and
            \begin{equation}
                gf_b = \sum_a k_a g_a f_b = \sum_a k_a g_b f_a = g_b f^n,
            \end{equation}
            having used that \(g_af_b = g_bf_a\), which shows that these functions agree on \(D(f_b)\), and since these open subsets cover \(D(f)\) these functions agree on all of \(D(f)\).
        \end{proof}
    \end{prp}
    
    \begin{crl}{}{}
        Let \(X\) be an affine variety.
        Then \(\sheaf{O}_X(X) = A(X)\).
        \begin{proof}
            Setting \(f = 1\) in \cref{prp:regular functions on distinguished open} we have that \(D(1) = X \setminus V(1) = X \setminus \emptyset = X\), and thus
            \begin{equation}
                \sheaf{O}_X(X) = \sheaf{O}_X(D(1)) = \left\{ \frac{g}{1^n} \,|\, g \in A(X), n \in \naturals \right\} = A(X). \qedhere
            \end{equation}
        \end{proof}
    \end{crl}
    
    This result is not true without the Nullstellensatz.
    For example, over the non-algebraically closed field \(\reals\) we get everywhere defined functions which are not polynomial functions, such as \(1/(x^2 + 1)\).
    
    This result is really one of commutative algebra.
    We've worked with polynomial functions here where there's an existing notion of division, but it's possible to restate things in terms of localisations.
    
    \begin{crl}{}{crl:regular functions on distinguished are localisation}
        Let \(X\) be an affine variety and \(f \in A(X)\).
        Then \(\sheaf{O}_X(D(f))\) is isomorphic as a \(K\)-algebra to the localisation, \(A(X)_f\), of the coordinate ring at the multiplicatively closed subset \(\{f^n \mid n \in \naturals\}\).
        \begin{proof}
            Consider the obvious \(K\)-algebra homomorphism
            \begin{align}
                A(X)_f &\to \sheaf{O}_X(D(f))\\
                \frac{g}{f^n} &\mapsto \frac{g}{f^n}.
            \end{align}
            This is interpreting a formal fraction in \(A(X)_f\) as an honest-to-god quotient of polynomials on \(D(f)\).
            We have to show that this is well-defined.
            If \(g/f^n = g'/f^m\) in \(A(X)_f\) then by definition there exists \(k \in \naturals\) such that \(f^k(gf^m - g'f^n) = 0\) in \(A(X)\).
            Then, since we work over a field, \(g^m = g'f^n\), and so \(g/f^n = g'/f^m\) as ratios of polynomials.
            
            The homomorphism is surjective since by \cref{prp:regular functions on distinguished open} all elements of \(\sheaf{O}_X(D(f))\) are of the form \(g/f^n\).
            It is injective since \(g/f^n = 0\) as a function on \(D(f)\) if and only if \(g = 0\) on \(D(f)\), and thus \(fg = 0\) on all of \(X\) and so \(f(g \cdot 1 - 0 \cdot f^n) = 0\) in \(A(X)\), and thus \(g/f^n = 0/1\) as formal fractions in \(A(X)_f\), and \(0/1\) is exactly zero in \(A(X)_f\), so this map has trivial kernel.
        \end{proof}
    \end{crl}
    
    \begin{exm}{}{exm:extending regular functions over a point}
        Consider \(U = \affine^2 \setminus \{0\}\).
        This is an open subset since \(\{0\} = V(x_1, x_2)\) is closed.
        We claim that
        \begin{equation}
            \sheaf{O}_{\affine^2}(\affine^2 \setminus \{0\}) = K[x_1, x_2].
        \end{equation}
        This then means that \(\sheaf{O}_X(U) = \sheaf{O}_X(X)\), that is, every regular function on \(U\) can be extended to \(X\).
        This is another example of a result which is similar in the algebraic-geometry and complex-analysis settings.
        
        To see why this is true let \(\varphi \in \sheaf{O}_X(U)\).
        Then \(\varphi\) is regular on \(D(x_1) = (\affine^1 \setminus \{0\}) \times \affine^1\) and \(D(x_2) \setminus \affine^1 \times (\affine^1 \setminus \{0\})\).
        Thus, \(\varphi = f/x_1^m\) on \(D(x_1)\) and \(\varphi = g/x_2^n\) for some \(f, g \in A(\affine^2 \setminus \{0\}) = K[x_1, x_2]\) and \(m, n \in \naturals\).
        We can choose \(m\) and \(n\) such that \(f/x_1^m\) and \(g/x_2^n\) are reduced.
        
        On the intersection, \(D(x_1) \cap D(x_2)\), both representations are valid, and so \(fx_2^n = gx_1^m\).
        The locus \(V(fx_2^n - gx_1^m)\), upon which this equation holds, is closed, and so \(fx_2^n = gx_1^m\) on \(\overline{D(x_1) \cap D(x_2)} = \affine^2\).
        Thus, \(fx_2^n = gx_1^m\) in the polynomial ring, \(A(\affine^2) = K[x_1, x_2]\).
        
        If \(m > 0\) then \(x_1\) must divide \(fx_2^n\), and since \(K[x_1, x_2]\) is a unique factorisation domain this means that \(x_1\) must divide \(f\), but this contradicts our assumption that \(f/x_1^m\) is reduced.
        So \(m = 0\).
        Then \(\varphi = f\) is a polynomial, and so \(\sheaf{O}_{\affine^2}(\affine^2 \setminus \{0\}) = K[x_1, x_2]\) as claimed.
    \end{exm}
    
    \section{Sheaves}
    In this section we'll develop some machinery to help us work with function-like objects with some local property.
    This puts a lot of the learning work up front, once we've learned the things covered in this section a lot of things just work out in later sections.
    
    The key idea is that we want to combine all of the rings \(\sheaf{O}_X(U)\) into some object as \(U\) varies over open sets.
    This should of course be subject to constraints that mean like the elements of \(\sheaf{O}_X(U)\) are sufficiently \enquote{function like}, although they need not be functions in the abstract definition.
    
    \begin{dfn}{Presheaf}{}
        A \defineindex{presheaf}, \(\sheaf{F}\), of rings on a topological space, \(X\), consists of the following data
        \begin{enumerate}
            \item for every open set, \(U \subseteq X\), a ring, \(\sheaf{F}(U)\);
            \item for every inclusion of open sets, \(U \subseteq V \subseteq X\), a ring homomorphism, \(\rho_{V,U} \colon \sheaf{F}(V) \to \sheaf{F}(U)\), called the \defineindex{restriction map}.
        \end{enumerate}
        This is subject to the following conditions
        \begin{enumerate}
            \item \(\sheaf{F}(\emptyset) = 0\);
            \item \(\rho_{U,U} = \id_{\sheaf{F}(U)}\);
            \item for any inclusions, \(U \subseteq V \subseteq W\), of open sets in \(X\) we have \(\rho_{V,U} \circ \rho_{W,V} = \rho_{W,U}\).
        \end{enumerate}
        The elements of \(\sheaf{F}(U)\) are called \define{sections}\index{section} of \(\sheaf{F}\) over \(U\).
        We often write \(\rho_{V,U}(\varphi) = \varphi|_U\).
    \end{dfn}
    
    The idea is that sections, elements of \(\sheaf{F}(U)\), are like functions on \(U\), and the restriction maps are like restriction of a function.
    See the following example.
    
    \begin{exm}{}{}
        Let \(X\) be a topological space.
        Consider the sheaf, \(\sheaf{F}\), of functions on \(X\).
        That is, for open sets \(U \subseteq X\) we set \(\sheaf{F}(U)\) to be the ring of functions, \(U \to K\).
        Then \(\rho_{V,U}\) is restricting a function from the domain \(V\) to the domain \(U\).
        
        We have that \(\sheaf{F}(\emptyset)\) consists of the single function \(\emptyset \to \reals\).
        Thus, \(\sheaf{F}(\emptyset)\) must be the zero ring.
        The fact that \(\rho_{U,U} = \id_{\sheaf{C}(U)}\) simply means that restricting a function to its domain doesn't do anything.
        The composition of restriction maps also makes sense: \(\rho_{V,U} \circ \rho_{W,V}\) first restricts from \(W\) to \(V\) then from \(V\) to \(U\), which is clearly the same as \(\rho_{W,U}\), which restricts directly from \(W\) to \(U\).
    \end{exm}
    
    The word \enquote{section} comes from fibre bundles, \(\pi \colon E \to B\), where a local section is a map \(\sigma \colon U \to E\) (for \(U \subseteq B\) open) such that \(\pi(\sigma(x)) = x\) for all \(x \in U\).
    The set of all local sections forms an important example of a presheaf (in fact a sheaf).
    
    \begin{remark}{}{}
        We have defined above a presheaf of rings.
        We can replace rings with many other categories, such as sets, \(K\)-algebras, abelian groups, or modules.
        The only changes that we have to make to the definition are
        \begin{enumerate}
            \item \(\sheaf{F}(U)\) should be an object in the relevant category;
            \item \(\rho_{V,U}\) should be a morphism in the relevant category;
            \item \(\sheaf{F}(\emptyset)\) should be the terminal object of the relevant category (that is the object which is both initial and terminal).
        \end{enumerate}
    \end{remark}
    
    \begin{remark}{Presheaf is a Functor}{}
        Let \(\cat{U}\) be the poset category of open sets of \(X\).
        That is, objects are open sets, \(U \subseteq X\), and there is a unique morphism \(i_{U,V} \colon U \to V\) if \(U \subseteq V\).
        Consider a functor \(F \colon \cat{U}^{\op} \to \Ring\).
        This assigns to each open subset, \(U \subseteq X\), a ring, \(F(U)\).
        To each pair of open subsets, \(U \subseteq V \subseteq X\), it assigns a map \(r_{V,U} = F(i_{U,V}) \colon F(V) \to F(U)\).
        
        The fact that this is a contravariant functor means that
        \begin{enumerate}
            \item \(F(\emptyset) = 0\), since a contravariant functor sends the initial object to the terminal objects.
            \item for \(U \subseteq V \subseteq W \subseteq X\) open we have unique maps \(i_{U,V} \colon U \to V\) and \(i_{V,W} \colon V \to W\), which we can compose to get a map \(i_{V,W} \circ i_{U,V} \colon U \to W\), which by uniqueness of maps in \(\cat{U}\) must just be \(i_{U,W} \colon U \to W\).
            Applying \(F\) we have \(F(i_{V,W} \circ i_{U,V}) = F(i_{V,W}) \circ F(i_{U,V}) = r_{W,V} \circ r_{V,U}\).
            Applying \(F\) to \(i_{U,W}\) we get \(F(i_{U,W}) = r_{W,U}\).
            Thus, \(r_{W,V} \circ r_{V,U} = r_{W,U}\).
            \item for \(U \subseteq X\) we have the (unique) identity arrow, \(\id_U \colon U \to U\), and applying \(F\) to this we get \(F(\id_U) = \id_{F(U)}\).
        \end{enumerate}
        We see that we can define a presheaf, \(\sheaf{F}\), by taking \(\sheaf{F}(U) = F(U)\) and \(\rho_{V,W} = r_{V,W}\).
        Conversely, any sheaf defines such a functor.
        So a presheaf is nothing but a functor \(\cat{U}^{\op} \to \Ring\) (or replace \(\Ring\) with some other category).
    \end{remark}
    
    \begin{exm}{Preheaf of Functions}{}
        Let \(X\) be a topological space.
        The sheaf of functions, \(\sheaf{F}\), on \(X\) has \(\sheaf{F}(U) = \{f \colon U \to \complex\}\), which is a ring under pointwise operations.
        There's a unique function \(\emptyset \to \complex\), and so \(\sheaf{F}(\emptyset) = 0\) is the zero ring.
        The restriction maps are just the normal restriction of functions, which then work out to have all the desired properties.
    \end{exm}
    
    \begin{exm}{Constant Preheaf}{}
        Let \(X\) be a topological space, and let \(S\) be a set.
        The constant presheaf, \(\underline{S}_{\symrm{pr}}\), consists of all constant functions.
        That is, \(\underline{S}_{\symrm{pr}}(U)\) consists of functions \(U \to S\) which are constant.
        The restriction maps are the usual restriction of functions.
        Since there is a unique function \(\emptyset \to S\), which is vacuously constant, we have that \(\underline{S}_{\symrm{pr}}(\emptyset) = 0\), and as discussed restriction works out.
    \end{exm}
    
    The notion of a presheaf captures a lot of what it means to be a function, even if the sections aren't actually functions.
    The notion of a sheaf captures a lot of what it means to be a function with some additional local property, such as smoothness, or more importantly for us, regularity.
    
    \begin{dfn}{Sheaf}{}
        A \defineindex{sheaf} of rings is a presheaf, \(\sheaf{F}\), satisfying the \defineindex{gluing property}: if \(U \subseteq X\) is an open set with an open cover, \(\{U_i\}_{i \in I}\), and there are \(\varphi_i \in \sheaf{F}(U_i)\) such that \(\varphi|_{U_i \cap U_j} = \varphi|_{U_i \cap U_j}\) then there exists some unique \(\varphi \in \sheaf{F}(U)\) such that \(\varphi|_{U_i} = \varphi_i\) for all \(i \in I\).
    \end{dfn}
    
    \begin{remark}{}{}
        Sometimes the gluing property is split up into two parts, uniqueness and existence:
        \begin{enumerate}
            \item locality/identity: if \(\varphi, \psi \in \sheaf{F}(U)\) are such that \(\varphi|_{U_i} = \psi|_{U_i}\) for all \(i\) then \(\varphi = \psi\);
            \item gluability: if \(\varphi_i \in \sheaf{F}(U_i)\) are such that \(\varphi_i|_{U_i \cap U_j} = \varphi_j|_{U_i \cap U)j}\) then there exists \(\varphi \in \sheaf{F}(U)\) such that \(\varphi_i = \varphi|_{U_i}\) for all \(i \in I\).
        \end{enumerate}
        As we've stated it our gluability axiom has \enquote{there exists some unique \(\varphi\)}, and this takes care of the locality property also.
    \end{remark}
    
    The idea here is that we can take the \(\varphi_i\) to be functions defined on covering sets, and then as long as they agree on the overlap of these sets we can glue them together into a single function defined on the whole set.
    For this to be possible we usually require some nice property of our functions.
    For example, they may need to be continuous, smooth, or holomorphic, depending on whether we want the resulting function to be continuous, smooth, or holomorphic, so depending on whether we're doing topology, differential geometry, or complex analysis.
    Functions on their own rarely glue together nicely.
    
    \begin{exm}{}{}
        Let \(X\) be an affine variety.
        Then the \defineindex{sheaf of regular functions} is \(\sheaf{O}_X\) where \(\sheaf{O}_X(U)\) is the ring of regular functions on the open set \(U \subseteq X\).
    \end{exm}
    
    \begin{exm}{Locally Constant Sheaf}{}
        Let \(X\) be a topological space, and let \(S\) be a set.
        The locally constant sheaf (of sets), \(\underline{S}\), consists of all locally constant functions.
        That is, \(\underline{S}(U)\) consists of functions \(U \to S\) where for \(p \in U\) there exists a neighbourhood of \(p\), \(U_p \subseteq U\), on which the function is constant.
        The restriction maps are the usual restriction of functions.
        Since there is a unique function \(\emptyset \to S\) which is vacuously locally constant we have that \(\underline{S}(\emptyset) = 0\).
        We have the gluing property.
        Let \(\{U_i\}_{i \in I}\) be an open cover of \(U\) and \(\varphi_i \in \underline{S}(U_i)\) with \(\varphi_i|_{U_i \cap U_j} = \varphi_j|_{U_i \cap U_j}\).
        We claim that these glue uniquely to give \(\varphi \in \underline{S}(U)\) defined by \(\varphi(p) = \varphi_i(p)\) if \(p \in U_i\).
        We need only to show that this is well-defined, that is, if \(p \in U_i \cap U_j\) then \(\varphi_i(p) = \varphi_j(p)\).
        This is true since \(\varphi_i|_{U_i \cap U_j} = \varphi_j|_{U_i \cap U_j}\).
        
        Note that we have to take \emph{locally constant} functions, not just constant ones, if we want a sheaf, as opposed to a presheaf.
        The reason for this is if we take \(U = U_1 \sqcup U_2\), then we may define \(\varphi_1(p) = s\) for \(p \in U_1\) and \(\varphi_2(p) = s'\) for \(p \in U_2\) with \(s \ne s'\).
        Then these don't glue to define a function which is constant on \(U = U_1 \sqcup U_2\).
        However, if our space is connected then we cannot have this scenario arise and we do get a sheaf of constant functions.
    \end{exm}
    
    \begin{dfn}{Restriction}{def:restriction of sheaves}
        Let \(\sheaf{F}\) be a presheaf on \(X\).
        Then we define the restriction of \(\sheaf{F}\) to an open set, \(U \subseteq X\), to be the presheaf \(\sheaf{F}|_U\), on \(U\), where \(\sheaf{F}|_U(V) = \sheaf{F}(V)\) for all open sets \(V \subseteq U\), and the restriction maps are those of \(\sheaf{F}\).
        
        If \(\sheaf{F}\) is a sheaf so is \(\sheaf{F}|_U\).
    \end{dfn}
    
    \begin{dfn}{Stalks}{}
        Let \(\sheaf{F}\) be a presheaf on \(X\).
        The \defineindex{stalk} of \(\sheaf{F}\) at \(a \in X\) is
        \begin{equation}
            \sheaf{F}_a = \{(U, \varphi) \mid U \subseteq X \text{ open}, a \in U, \varphi \in \sheaf{F}(U)\} / {\sim}
        \end{equation}
        where \((U, \varphi) \sim (U', \varphi')\) if there exists some open subset, \(V \subseteq U \cap U'\), on which \(\varphi|_V = \varphi'|_V\).
        
        We call elements of \(\sheaf{F}_a\) \define{germs}\index{germ} of \(\sheaf{F}\) at \(a\).
    \end{dfn}
    
    The stalk, \(\sheaf{F}_a\), inherits the structure of a ring from the \(\sheaf{F}(U)\) for \(U\) a neighbourhood of \(a\).
    For example, \((U, \varphi) + (V, \psi) = (U \cap V, \varphi + \psi)\).
    Of course, one needs to show that this is well-defined.
    
    There is a morphism \(\sheaf{F}(U) \to \sheaf{F}_a\), given by \(\varphi \mapsto (U, \varphi)\).
    
    The idea here is that \(\sheaf{F}(U)\) contains information about the sheaf in a neighbourhood and \(\sheaf{F}_a\) contains information about the sheaf at a point.
    That is, we think of \(\sheaf{F}(U)\) as consisting of functions defined on an open set, \(U\), and we think of \(\sheaf{F}_a\) as consisting of functions defined on an arbitrarily small open neighbourhood of \(a\).
    This can be made more precise by defining the stalk to be a directed limit:
    \begin{equation}
        \sheaf{F}_a = \varinjlim_{U \ni a} \sheaf{F}(U).
    \end{equation}
    Here we have a directed system of functions on open neighbourhoods of \(a\), joined by restrictions, and part of the definition of a directed limit is that we consider two elements the same if they eventually are the same in this limit, that is, if after sufficient restriction they are the same.
    Intuitively, we take some nested neighbourhoods of \(a\) and if we can keep getting smaller and smaller, \enquote{zooming in} on \(a\), until the two functions agree, we consider them to be the same function.
    
    Despite stalks seemingly having less information it is often sufficient to look at stalks to determine whether a given property holds for a sheaf.
    
    Note that when we have a sheaf with a name like \(\sheaf{O}_X\) we typically denote the stalk at \(a\) as \(\sheaf{O}_{X,a}\), rather than, say \((\sheaf{O}_X)_a\), \(\sheaf{O}_{Xa}\), or some other clunky notation.
    
    \begin{exm}{}{}
        Let \(\underline{S}\) be the locally constant sheaf.
        Then \(\underline{S}_a = S\).
        We identify a germ, \((U, \varphi)\), with \(\varphi(a) \in S\), and there is one such germ for each value of \(S\).
        Then two germs, \((U, \varphi)\) and \((U', \varphi')\) are only the same if they agree on some open subset of \(U \cap U'\) containing \(a\), but because \(\varphi\) and \(\varphi'\) are locally constant this just means that \(\varphi(a) = \varphi'(a)\), so this identification provides a bijection between \(\underline{S}_a\) and \(S\).
        This is all taking place with sheaves of sets, so we have an isomorphism, \(\underline{S}_a \isomorphic S\) for all \(a \in X\), as claimed.
    \end{exm}
    
    Consider the sheaf of differentiable functions on the real line (with the standard topology).
    A germ at \(a \in \reals\) allows us to compute the value of the corresponding function at \(a\), and the value of the derivative of the function at \(a\).
    It does not allow us to compute the value of the function anywhere else.
    
    Consider the sheaf of holomorhpic functions on \(\complex\) (with the standard topology).
    Then since the value of such functions is fully determined by the value on some smaller open set the germs of these functions contain enough information to compute the value of the function at other points (as long as they're part of the same connected open set as the point at which we take the germ).
    
    Given an affine variety, \(X\), there is a well-defined evaluation map, \(\sheaf{O}_{X,a} \to K\), \((U, \varphi) \mapsto \varphi(a)\).
    This tells us the value of \(\varphi\) at \(a\), but not at any other point.
    
    It is possible to describe regular functions algebraically in terms of a localisation of the coordinate ring.
    This is, in fact, the reason why we call localisations localisations.
    
    \begin{lma}{}{}
        Let \(a\) be a point in the affine variety \(X\).
        Then the stalk, \(\sheaf{O}_{X,a}\), is isomorphic as a \(K\)-algebra to the localisation \(A(X)_{I(a)}\) at the maximal ideal \(I(a) \subideal A(X)\).
        That is,
        \begin{equation}
            \sheaf{O}_{X,a} \isomorphic \left\{ \frac{f}{g} \,\middle|\, f, g \in A(X), g(a) \ne 0 \right\}.
        \end{equation}
        This means that \(\sheaf{O}_{X,a}\) is a local ring (in the sense of \cref{def:local ring}), having the unique maximal ideal
        \begin{equation}
            I_a \coloneq \{(U, \varphi) \in \sheaf{O}_{X,a} \mid \varphi(a) = 0\} \isomorphic \left\{ \frac{f}{g} \mid f, g \in A(X), f(a) = 0, g(a) \ne 0 \right\}.
        \end{equation}
        We call this the \defineindex{local ring} of \(X\) at \(a\).
        \begin{proof}
            Consider the map
            \begin{equation}
                \begin{aligned}
                    F \colon A(X)_{I(a)} &\to \sheaf{O}_{X,a}\\
                    \frac{f}{g} &\mapsto \left( D(g), \frac{f}{g} \right).
                \end{aligned}
            \end{equation}
            This sends a formal fraction, \(f/g\), to the corresponding quotient of polynomial functions on the open set \(D(g)\) on which the denominator doesn't vanish.
            Notice that \(a \in D(g)\) since \(g(a) \ne 0\) by definition.
            This is a \(K\)-algebra homomorphism by construction of the operations on \(\sheaf{O}_{X,a}\).
            This map is well-defined, if \(f/g = f'/g'\) in \(A(X)_{I(a)}\) then \(h(fg' - f'g) = 0\) for some \(h \in A(X) \setminus I(a)\).
            Thus, the functions \(f/g\) and \(f'/g'\) agree on the open neighbourhood \(D(h) \cap D(g) \cap D(g')\) of \(a\), and so determine the same element of the stalk.
            
            Further, \(F\) is surjective since by definition any regular function in a sufficiently small neighbourhood of \(a\) is representable as a fraction, \(f/g\), with \(f \in A(X)\) and \(g \in A(X) \setminus I(a)\).
            
            This map is injective.
            Suppose \(f/g\) is mapped to the zero element.
            That is, \(f/g\) is zero on an open neighbourhood of \(a\).
            We can always shrink this open neighbourhood to be \(D(h)\) for some \(h \in A(X)\), since the distinguished open sets form a basis for the Zariski topology.
            Further, since \(h(a) \ne 0\) (as we have \(a \in D(h)\) by assumption) we know that \(h \notin I(a)\), so \(h \in A(X) \setminus I(a)\).
            Thus, we have \(h(f \cdot 1 - 0 \cdot g) = 0\) on all of \(X\), and thus this function is zero in \(A(X)\).
            Therefore \(g/f = 0/1\) in \(A(X)_{I(a)}\), so the map has trivial kernel.
        \end{proof}
    \end{lma}
    
    \chapter{Morphisms}
    We have looked at regular functions on some affine variety \(X\).
    These are maps from some open subset of \(X\) to the field, \(K\).
    Thinking of \(K\) as itself being the affine variety \(\affine^1\) we will consider these regular functions to be our first example of morphisms between affine varieties.
    Our goal in this chapter is to extend this definition to define morphisms between any two affine varieties.
    
    It turns out that the correct way to define morphisms, \(X \to Y\), is actually to look at regular functions out of both \(X\) and \(Y\).
    This gives rise to two sheaves, and morphisms between sheaves give us what we want, although of course we still have to define morphisms between sheaves.
    
    \section{Ringed Spaces}
    In order to make these definitions it's important that the data of the regular functions is attached to our affine variety, as later we'll want to be able to define an affine variety abstractly in such a way that changing the regular functions also changes the structure of the affine variety.
    To this end we make the following definition pairing up the required data.
    
    \begin{dfn}{Ringed Spaces}{}
        A \defineindex{ringed space}, \((X, \sheaf{O}_X)\), is a pair consisting of a topological space, \(X\), and a sheaf, \(\sheaf{O}_X\), on \(X\).
        We call \(\sheaf{O}_X\) the \defineindex{structure sheaf} of the ringed space.
    \end{dfn}
    
    \begin{ntn}{}{}
        We will typically just write \(X\) for a ringed space, in which case the structure sheaf is always denoted \(\sheaf{O}_X\).
    \end{ntn}
    
    We will always consider an affine variety, \(X\), as a ringed space, \((X, \sheaf{O}_X)\) where the structure sheaf, \(\sheaf{O}_X\), is the sheaf of regular functions.
    Likewise, any open subset, \(U\), of a ringed space, \(X\) (including the case where \(X\) is an affine variety) will be considered as a ringed space with the structure sheaf given by restriction, \(\sheaf{O}_U = \sheaf{O}_X|_U\) (\cref{def:restriction of sheaves}).
    
    The reason that this is important for defining morphisms is we've attached extra information to our affine varieties.
    This means that our definition of a morphism, \(f \colon X \to Y\), should preserve this extra information.
    In fact, we can define the notion of a morphism of ringed spaces more generally, and then morphisms of affine varieties are just a special case of this.
    
    The correct notion of preserving the structure of the sheaves of regular functions is that given a regular function \(\varphi \colon U \to K\) on an open subset \(U \subseteq Y\) the composite, \(\varphi \circ f \colon f^{-1}(U) \to K\) should again be a regular function.
    Note that this requires that \(f^{-1}(U)\) is an open subset of \(X\), so at the very least \(f\) must be continuous.
    
    There is a problem with this requirement if we're aiming for full generality.
    While the composite \(\varphi \circ f\) is defined for regular functions, \(\varphi\), if we take an arbitrary ringed space then we cannot always assume that the elements of \(\sheaf{O}_X(U)\) are functions, that is, composition isn't necessarily defined.
    There are two ways around this problem:
    \begin{enumerate}
        \item Lots of technicalities.
        \item Ignore it.
    \end{enumerate}
    We'll pick the later.
    \begin{important}
        From now on until we specify otherwise we will assume that all sheaves of rings are actually sheaves of \(K\)-valued functions.
    \end{important}
    Note that this also makes all sheaves sheaves of \(K\)-algebras, since we can always define pointwise scalar multiplication.
    This allows us to make the following definitions.
    
    \section{Morphisms}
    \begin{dfn}{Pullback}{}
        Let \(f \colon X \to Y\) be a map between ringed spaces.
        For any map, \(\varphi \colon U \to K\), from the open subset \(U \subseteq Y\) we define the \defineindex{pullback} of \(\varphi\) by \(f\), \(f^*\varphi \colon f^{-1}(U) \to K\) by precomposition, \(f^*\varphi = \varphi \circ f\).
    \end{dfn}
    
    \begin{dfn}{Morphism of Ringed Spaces}{}
        Let \(f \colon X \to Y\) be a map of ringed spaces.
        This is a \defineindex{morphism of ringed spaces} if
        \begin{enumerate}
            \item \(f\) is continuous; and
            \item for all open subsets \(U \subseteq Y\) and for all \(\varphi \in \sheaf{O}_Y(U)\) we have \(f^*\varphi \in \sheaf{O}_X(f^{-1}(U))\).
            That is, pulling back by \(f\) defines a \(K\)-algebra homomorphism
            \begin{equation}
                \begin{aligned}
                    f^* \colon \sheaf{O}_Y(U) &\to \sheaf{O}_X(f^{-1}(U))\\
                    \varphi &\mapsto f^*\varphi.
                \end{aligned}
            \end{equation}
        \end{enumerate}
        As usual, we say that a morphism of ringed spaces is an isomorphism of ringed spaces if it has a two sided inverse which is also a morphism of ringed spaces.
    \end{dfn}
    
    \begin{dfn}{Morphism of Affine Varieties}{}
        A morphism of (open subsets of) affine varieties is exactly a morphism of the corresponding ringed spaces.
    \end{dfn}
    
    \begin{remark}{}{}
        Here are some of the technicalities we avoid by assuming all sheaves are sheaves of \(K\)-valued functions.
        Let \(\sheaf{F}\) and \(\sheaf{G}\) be sheaves on \(X\).
        A \defineindex{morphism of sheaves}, \(\varphi \colon \sheaf{F} \to \sheaf{G}\), is a collection of morphisms, \(\varphi_U \colon \sheaf{F}(U) \to \sheaf{G}(U)\) for \(U \subseteq X\) an open subset.
        These must be compatible with restriction, that is, for \(U \subseteq V \subseteq X\) open the diagram
        \begin{equation}
            \begin{tikzcd}
                \sheaf{F}(V) \arrow[r, "\varphi_V"] \arrow[d, "{\rho^{\sheaf{F}}_{V,U}}"'] & \sheaf{G}(U) \arrow[d, "{\rho^{\sheaf{G}}_{V,U}}"]\\
                \sheaf{F}(U) \arrow[r, "\varphi_U"'] & \sheaf{G}(U)
            \end{tikzcd}
        \end{equation}
        must commute, where \(\rho_{V,U}^{\sheaf{F}}\) and \(\rho_{V,U}^{\sheaf{G}}\) are the restriction maps of \(\sheaf{F}\) and \(\sheaf{G}\) respectively.
        
        Composition of morphisms of sheaves is given by \((\varphi \circ \varphi')_U = \varphi_U \circ \varphi'_U\).
        
        With this definition sheaves of objects from some category, \(\cat{C}\), on a topological space, \(X\), form a category themselves, often denoted \(\cat{C}_X\) or \(\operatorname{Sh}_X(\cat{C})\).
        
        Note that if we interpret our sheaves as functors then \(\varphi \colon \sheaf{F} \to \sheaf{G}\) is precisely a natural transformation.
        
        Let \(f \colon X \to Y\) be a continuous map of topological spaces.
        The \defineindex{direct image functor}, \(f_* \colon \cat{C}_X \to \cat{C}_Y\) sends a sheaf, \(\sheaf{F}\), on \(X\) to the sheaf, \(f_*\sheaf{F}\), on \(Y\) defined by \(f_*\sheaf{F}(U) = \sheaf{F}(f^{-1}(U))\).
        If \(\varphi \colon \sheaf{F} \to \sheaf{G}\) is a morphism of sheaves then \(f_*\varphi \colon f_*\sheaf{F}(U) \to f_*\sheaf{G}(U)\) is a morphism of sheaves given by the family of morphisms \(\sheaf{F}(f^{-1}(U)) \to \sheaf{G}(f^{-1}(U))\) for \(U \subseteq Y\) open given by \(\psi \mapsto \varphi_{f^{-1}(U)}(\psi)\).
        
        A \defineindex{morphism of ringed spaces}, \((X, \sheaf{O}_X) \to (Y, \sheaf{O}_Y)\), is a pair, \((f, \varphi)\) where \(f \colon X \to Y\) is a continuous map between the underlying topological spaces and \(\varphi \colon \sheaf{O}_Y \to f_* \sheaf{O}_X\) is a morphism of sheaves.
        
        Unpacking this definition a little, a morphism of ringed spaces is a continuous function, \(f \colon X \to Y\), and a family of morphisms \(\varphi_U \colon \sheaf{O}_Y \to \sheaf{O}_X(f^{-1}(U))\) for all open sets \(U \subseteq Y\) such that if \(U \subseteq V \subseteq Y\) are open then
        \begin{equation}
            \begin{tikzcd}
                \sheaf{O}_Y(V) \arrow[r, "\varphi_V"] \arrow[d, "{\rho_{V,U}^{\sheaf{O}_Y}}"'] & \sheaf{O}_X(f^{-1}(V)) \arrow[d, "{\rho_{V,U}^{f_*\sheaf{O}_X}}"]\\
                \sheaf{O}_Y(U) \arrow[r, "\varphi_U"'] & \sheaf{O}_X(f^{-1}(U))
            \end{tikzcd}
        \end{equation}
        commutes.
    \end{remark}
    
    Note that if \(f \colon X \to Y\) and \(g \colon Y \to Z\) are morphisms of ringed spaces then so is \(g \circ f \colon X \to Z\).
    This follows immediately from the definition since \(g \circ f\) is also continuous and for \(\varphi \in \sheaf{O}_Z(U)\) we have \((g \circ f)^*\varphi = \varphi \circ g \circ f = f^*(g \circ \varphi) = f^*(g^*\varphi)\) and since \(f^* \colon \sheaf{O}_Y(g^{-1}(U)) \to \sheaf{O}_X(f^{-1}(g^{-1}(U)))\) and \(g^* \colon \sheaf{O}_Z(U) \to \sheaf{O}_Y(g^{-1}(U))\) are both \(K\)-algebra homomorphisms so is \((g \circ f)^* = f^* \circ g^*\).
    
    The identity map of ringed spaces is \(\id_X \colon X \to X\) and \(\id_X^*\varphi \colon  \sheaf{O}_X(U) \to \sheaf{O}_X(\id_X^{-1}(U)) = \sheaf{O}_X(U)\) is defined by \(\varphi \mapsto \id_X^*\varphi = \varphi \circ \id_X = \varphi\).
    
    Associativity of composition follows from associativity of composition of continuous functions and ring homomorphisms.
    Thus, ringed spaces form a category.
    Since affine varieties are just special cases of ringed spaces there is a full subcategory of this which is the category of affine varieties.
    Call this category \(\affvar\).
    
    Restrictions of morphisms are also morphisms.
    That is, if \(f \colon X \to Y\) is a morphism of ringed spaces and we have open subsets \(U \subseteq X\) and \(V \subseteq Y\) such that \(f(U) \subseteq V\) then the restricted map \(\tilde{f} \colon U \to V\) given by \(\tilde{f}(x) = f(x)\) is again a morphism of ringed spaces.
    This again essentially follows from the definition and the fact that sheaves are set up to work with restriction.
    
    There is also a gluing property similar to that of sheaves.
    
    \begin{lma}{Gluing Property of Morphisms}{}
        Let \(f \colon X \to Y\) be a map of ringed spaces, and let \(\{U_i\}_{i \in I}\) be an open cover of \(X\) such that all restrictions, \(f|_{U_i} \colon U_i \to Y\), are morphisms of ringed spaces.
        Then \(f\) is a morphism of ringed spaces.
        \begin{proof}
            We need to check two things.
            We start with continuity.
            Let \(V \subseteq Y\) be open.
            Then
            \begin{equation}
                f^{-1}(V) = \bigcap_{i \in I} (U_i \cap f^{-1}(V)) = \bigcup_{i \in I} (f|_{U_i})^{-1}(V).
            \end{equation}
            Since the restrictions are all continuous and \(V\) is open we know that \((f|_{U_i})^{-1}(V)\) is open in \(U_i\) and thus their union is open in \(X\).
            
            The second thing we have to show is that \(f\) maps pullback sections of \(\sheaf{O}_Y\) to sections of \(\sheaf{O}_X\).
            Again, let \(V \subseteq Y\) be open, and let \(\varphi \in \sheaf{O}_Y(V)\).
            Then
            \begin{equation}
                (f^*\varphi)|_{U_i \cap f^{-1}(V)} = (f|_{U_i \cap f^{-1}(V)})^*\varphi \in \sheaf{O}_X(U_i \cap f^{-1}(V))
            \end{equation}
            since \(f|_{U_i}\) and therefore also \(f|_{U_i \cap f^{-1}(V)}\) are morphisms.
            Then by the gluing property for sheaves this means that \(f^*\varphi \in \sheaf{O}_X(f^{-1}(V))\).
        \end{proof}
    \end{lma}
    
    We can apply this result to morphisms between (open subsets of) affine varieties.
    
    \begin{prp}{}{prp:morphisms between affine varieties is just tuple of regular functions}
        Let \(U\) be an open subset of an affine variety, \(X\), and let \(Y \subseteq \affine^n\) be an affine variety.
        Then a morphism, \(f \colon U \to Y\), is a map of the form
        \begin{equation}
            \begin{aligned}
                f = (\varphi_1, \dotsc, \varphi_n) \colon U &\to Y\\
                x &\mapsto (\varphi_1(x), \dotsc, \varphi_n(x))
            \end{aligned}
        \end{equation}
        where \(\varphi_i \in \sheaf{O}_X(U)\).
        \begin{proof}
            Suppose \(f \colon U \to Y\) is a morphism of affine varieties.
            Then for \(i = 1, \dotsc, n\) we can define the \(i\)th coordinate function, \(y_i \colon Y \to K\) to simply be projecting out the \(i\)th coordinate, \(y_i(a_1, \dotsc, a_n) = a_i\).
            This is a regular function on \(Y\), and thus we have that \(\varphi_i \coloneq f^*y_i \in \sheaf{O}_X(f^{-1}(Y)) = \sheaf{O}_X(U)\) by the properties of a morphism.
            We then also have that \(f^*y_i = y_i \circ f\), which is just the \(i\)th component function of \(f\).
            Thus, we have \(f = (\varphi_1, \dotsc, \varphi_n)\).
            
            Conversely, suppose that \(f = (\varphi_1, \dotsc, \varphi_n)\) with \(\varphi_i \in \sheaf{O}_X(U)\) and \(f(U) \subseteq Y\).
            First, we show that \(f\) is continuous.
            Let \(Z\) be any closed subset of \(Y\).
            Then \(Z = V(g_1, \dotsc, g_m)\) for some \(g_i \in A(Y)\) and
            \begin{equation}
                f^{-1}(Z) = \{x \in U \mid g_i(\varphi_1(x), \dotsc, \varphi_n(x)) = 0 \forall i = 1, \dotsc, m\}.
            \end{equation}
            The functions \(x \mapsto g_i(\varphi_1(x), \dotsc, \varphi_n(x))\) are regular, since the \(\varphi_i\) are regular and the \(g_i\) are polynomials, and evaluating a polynomial at a quotient of polynomials again gives a quotient of polynomials locally.
            Thus, \(f^{-1}(Z)\) is closed in \(U\) since the zero loci of regular functions are closed (\cref{lma:zero locus of regular function is closed}).
            Thus, \(f\) is continuous.
            
            Now suppose that \(\psi \in \sheaf{O}_Y(W)\) is a regular function on an open subset, \(W \subseteq Y\).
            Then we have
            \begin{equation}
                \begin{aligned}
                    f^* \psi = \psi \circ f \colon f^{-1}(W) &\to K\\
                    x &\mapsto \psi(\varphi_1(x), \dotsc, \varphi_n(x)),
                \end{aligned}
            \end{equation}
            which is again regular, since replacing the variables in a quotient of polynomials by other quotients of polynomials results again in a quotient of polynomials.
            Thus, \(f^*\psi \in \sheaf{O}_X(f^{-1}(W))\), and so \(f\) is indeed a morphism.
        \end{proof}
    \end{prp}
    
    \begin{crl}{}{}
        Regular functions from \(U \to \affine^1\) are precisely the regular functions in \(\sheaf{O}_X(U)\).
    \end{crl}
    
    These results are a sanity check on our definitions.
    A morphism mapping to an affine subvariety of \(\affine^n\) is simply an \(n\)-tuple of regular functions whose image lies in said affine subvariety.
    Further, we see that regular functions are really just the special case of \(n = 1\).
    
    We can take \(U = X\).
    Then in this case we can interpret morphisms entirely algebraically through the following corollary.
    
    \begin{crl}{}{}
        Let \(X\) and \(Y\) be affine varieties.
        Then there is a bijection
        \begin{equation}
            \{\text{morphisms } X \to Y\} \xleftrightarrow{1:1} \{K\text{-algebra homomorphisms } A(Y) \to A(X)\}.
        \end{equation}
        \begin{proof}
            By definition, any morphism, \(f \colon X \to Y\), determines a \(K\)-algebra homomorphism, \(f^* \colon \sheaf{O}_Y(Y) \to \sheaf{O}_X(X)\), and since \(\sheaf{O}_Y(Y) = A(Y)\) and \(\sheaf{O}_X(X) = A(X)\) this gives us one direction of the bijection.
            
            Conversely, let \(g \colon A(Y) \to A(X)\) be a \(K\)-algebra homomorphism.
            Take \(Y \subseteq \affine^n\) and let \(y_1, \dotsc, y_n\) be the coordinate functions of \(\affine^n\).
            Then we can define \(\varphi_i \coloneqq g(y_i) \in A(X) = \sheaf{O}_X(X)\).
            Setting \(f = (\varphi_1, \dotsc, \varphi_n) \colon X \to \affine^n\) we then have that for any \(h \in K[y_1, \dotsc, y_n]\)
            \begin{equation}
                (f^*h)(x) = h(f(x)) = h(\varphi_1(x), \dotsc, \varphi_n(x)) = g(h)(x)
            \end{equation}
            for all \(x \in X\).
            The last equality holds because both sides of the equation are \(K\)-algebra homomorphisms in \(h\) and on the generators \(y_i\) they both give \(\varphi_i(x)\), so they must be the same \(K\)-algebra homomorphisms.
            
            This shows that \(h(f(x)) = 0\) for all \(h \in I(Y)\), since these are the polynomials which map to zero in \(A(Y)\), and thus \(g\) will vanish on these polynomials.
            Then the image of \(f\) is in \(V(I(Y)) = Y\), so we have a map \(f \colon X \to Y\) as needed.
            Its coordinate functions are regular, since they are just \(\varphi_i\), and so by \cref{prp:morphisms between affine varieties is just tuple of regular functions} \(f\) is a morphism.
            The calculation above shows that \(f^* = g\), and so this is indeed inverse to the first map stated.
        \end{proof}
    \end{crl}
    
    \begin{crl}{}{}
        Under the above bijection isomorphisms of affine varieties correspond to isomorphisms of \(K\)-algebras.
        \begin{proof}
            This follows immediately upon noting that for \(f \colon X \to Y\) and \(g \colon Y \to X\) we have
            \begin{equation}
                (f \circ g)^* = g^* \circ f^* \qand (g \circ f)^* = f^* \circ g^*
            \end{equation}
            and so if \(f\) and \(g\) are inverses then we have \(\id_Y^* = \id_{A(Y)} = g^* \circ f^*\) so \(f^*\) has a left inverse and \(\id_X^* = \id_{A(X)} = f^* \circ g^*\) so \(f^*\) has a right inverse.
            The converse also holds, if we assume that \(A(Y) \to A(X)\) is an isomorphism it must arise as the pullback of some invertible morphism of affine varieties.
        \end{proof}
    \end{crl}
    
    \begin{remark}{}{}
        We can state this all a bit more formally with the language of category theory.
        There is a contravariant functor, \(A\), from the category of affine varieties to the full subcategory of \(K\)-algebras which can arise as the coordinate rings of affine varieties\footnote{This is, as best I can tell, the full subcategory of finitely generated \(K\)-algebras with no nilpotent elements.}\footnote{One way to get around having to take this subcategory is to work with schemes, then we will have a corresponding functor between the category of affine schemes and the category of commutative unital rings. In fact, this functor is an equivalence, and can be used abstractly to define schemes.}.
        On objects this map is \(X \mapsto A(X)\), and on morphisms it is \(f \mapsto f^*\).
        The correspondence of isomorphisms in both categories is due to the fact that this functor both preserves and reflects isomorphisms.
    \end{remark}
    
    Note that an isomorphism of affine varieties is \emph{not} a bijective morphism, just as for topological spaces where the inverse of a continuous map need not be continuous.
    This is demonstrated in the following example.
    
    \begin{exm}{}{}
        Let \(X = V(x_1^2 - x_2^3) \subseteq \affine^2\).
        Consider the map
        \begin{equation}
            \begin{aligned}
                f \colon \affine^1 &\to X\\
                t &\mapsto (t^3, t^2).
            \end{aligned}
        \end{equation}
        Note that \((t^3, t^2) \in X\) since \((t^3)^2 - (t^2)^3 = 0\).
        Thus, \(f\) is a morphism of affine varieties since its component functions, \(t \mapsto t^3\) and \(t \mapsto t^2\), are regular (even polynomial) functions.
        
        The corresponding \(K\)-algebra homomorphism is \(f^* \colon A(X) \to A(\affine^1)\).
        We have \(A(X) = K[x_1, x_2]/\langle x_1^2 - x_2^3\rangle\) and \(A(\affine^1) = K[t]\).
        Then \(f^*(\overline{x_1}) = t^3\) and \(f^*(\overline{x_2}) = t^2\), which we get by composing \(f\) with the coordinate functions on \(\affine^2\).
        
        The function \(f\) is a bijection, with inverse
        \begin{equation}
            \begin{aligned}
                f^{-1} \colon X &\to \affine^1\\
                (x_1, x_2) &\mapsto
                \begin{cases}
                    \frac{x_1}{x_2} & x_2 \ne 0,\\
                    0 & x_2 = 0.
                \end{cases}
            \end{aligned}
        \end{equation}
        However, \(f\) is not an isomorphism, that is, \(f^{-1}\) is not a morphism, since this would require that \(f^*\) is an isomorphism, which it isn't as we can readily check that the linear polynomial, \(t\), is not in the image of \(f^*\).
    \end{exm}
    
    \section{Products}
    Recall that when we defined the product of affine varieties we didn't equip it with the product topology, instead we equipped it with the subspace topology viewing it as a subspace of \(\affine^m \times \affine^n\) with the Zariski topology.
    This is the \enquote{correct} topology for the product because it means that the product is indeed an affine variety and satisfies the universal property of products.
    We just couldn't say this until now because the universal property of products of affine varieties involves morphisms between affine varieties.
    
    \begin{prp}{}{}
        Let \(X\) and \(Y\) be affine varieties.
        Let \(\pi_X \colon X \times Y \to Y\) and \(\pi_Y \colon X \times Y \to Y\) be projections onto the corresponding factors.
        Then \(X \times Y\) equipped with these projections satisfies the universal property of a product.
        \begin{proof}
            First note that \(\pi_X\) and \(\pi_Y\) are indeed morphisms of affine varieties since they are of the form \((a_1, \dotsc, a_m, a_{m+1}, \dotsc a_{m+n}) \mapsto (a_1, \dotsc, a_m)\) and \((a_1, \dotsc, a_m a_{m+1}, \dotsc, a_{m + n}) \mapsto (a_{m+1}, \dotsc, a_{m+n})\), which clearly have regular component functions (being identities).
            
            The universal property of products states that for any other affine variety, \(Z\), equipped with morphisms \(f_X \colon Z \to X\) and \(f_Y \colon Z \to Y\) there exists a unique map \(f \colon Z \to X \times Y\) such that \(f_X = \pi_X \circ f\) and \(f_Y = \pi_Y \circ f\).
            Given such a \(Z\) with \(f_X\) and \(f_Y\) we can simply take \(f(z) = (f_X(z), f_Y(z))\).
            This is then a morphism of affine varieties since its component functions are regular since \(f_X\) and \(f_Y\) are morphisms.
            By construction we have \(\pi_X \circ f = f_X\) and \(\pi_Y \circ f = f_Y\).
            Thus, \(X\times Y\) is really the product in the category of affine varieties.
        \end{proof}
    \end{prp}
    
    Under the correspondence between affine varieties and their coordinate rings the universal property of the product becomes the universal property of the coproduct of \(K\)-algebras.
    The coproduct of \(K\)-algebras is just the tensor product over \(K\).
    Thus, the coordinate ring of \(A(X \times Y)\) is precisely \(A(X) \otimes_K A(Y)\).
    In other words, the functor from affine varieties to \(K\)-algebras, \(X \mapsto A(X)\), is contravariant, sending products to coproducts.
    
    \section{Redefining Affine Varieties}
    So far we've constructed a functor \(\affvar^{\op} \to \CAlg{K}\), sending an affine variety, \(X\), to its coordinate ring, \(A(x)\), and sending a morphism, \(f \colon X \to Y\), to its pullback, \(f^* \colon A(Y) \to A(X)\).
    In this section we'll construct a functor going the other way.
    
    The first problem we have is that not every \(K\)-algebra can be the coordinate ring of an affine variety.
    One immediate requirement is that the coordinate ring of an affine variety is always reduced, that is, it has no nilpotent elements.
    This is because \(A(X) = K[x_1, \dotsc, x_n]/I(X)\) and \(I(X)\) is a radical ring (\cref{lma:quotient by radical is reduced}).
    Another condition is that since \(K[x_1, \dotsc, x_n]\) is Noetherian so is its quotient, \(A(X)\).
    In particular, this means that \(A(X)\) is finitely generated.
    
    Thus, it makes sense to restrict our attention to finitely generated reduced \(K\)-algebras, \(R\).
    The question we ask is if we can construct an affine variety which has \(R\) as its coordinate ring.
    
    To start we pick generators, \(a_1, \dotsc, a_n\), for \(R\).
    This gives a \(K\)-algebra homomorphism
    \begin{equation}
        \begin{aligned}
            g \colon K[x_1, \dotsc, x_n] &\to R\\
            f &\mapsto f(a_1, \dotsc, a_n).
        \end{aligned}
    \end{equation}
    Further, if \(J = \ker g\) then the isomorphism theorems give us \(R \isomorphic K[x_1, \dotsc, x_n] / J\).
    Since \(R\) is reduced this means that \(J\) is a radical ideal by \cref{lma:quotient reduced implies ideal radical}.
    Thus, \(X = V(J)\) is an affine variety in \(\affine^n\) with \(I(X) = I(V(J)) = \sqrt{J} = J\) and so the coordinate ring of \(X\) is \(A(X) = K[x_1, \dotsc, x_n]/I(X) = K[x_1, \dotsc, x_n]/J \isomorphic R\).
    
    Notice that the construction here of \(X\) depends on a choice of generators of \(R\), and different choices may produce different affine varieties.
    However, these affine varieties will be isomorphic since by construction they have the same coordinate rings.
    Thus all that really differs is the embedding of these affine varieties in \(\affine^n\).
    
    What we have done here is construct a map from potential coordinate rings (finitely generated reduced \(K\)-algebras) to affine varieties.
    This extends to a functor, and in fact this (contravariant) functor is an equivalence of categories.
    
    So far we have considered all affine varieties as subsets of \(\affine^n\) for some \(n\).
    This has been fine so far, just as it's usually ok to think of manifolds as being embedded in \(\reals^n\) for some \(n\).
    However, it's not the most general definition.
    The following definition relaxes this condition, by simply requiring that affine varieties are things that are \emph{isomorphic} to things we've been calling affine varieties up to this point.
    
    \begin{dfn}{Affine Variety}{}
        An \defineindex{affine variety} is a ringed space which is isomorphic to a ringed space \((X, \sheaf{O}_X)\) where \(X\) is a closed subset of \(\affine^n\) for some \(n\) in the Zariski topology and \(\sheaf{O}_X\) is the sheaf of regular functions on \(X\).
    \end{dfn}
    
    With this definition we now have a bijection
    \begin{equation}
        \{\text{affine varieties}\}/{\isomorphic} \xleftrightarrow{1:1} \{\text{finitely generated reduced } K\text{-algebras}\}/{\isomorphic}.
    \end{equation}
    These maps are actually contravariant functors, and actually form an equivalence of categories.
    Specifically, we can actually define the category of affine varieties to be the category which is (up to equivalence of categories) dual to the category of finitely generated reduced \(K\)-algebras.
    This lets us give a purely algebraic definition of the geometric concept of affine varieties.
    
    Importantly, with this new definition of affine varieties all of the results we've stated so far carry over.
    For example, given a \enquote{new definition} affine variety, \((X, \sheaf{O}_X)\), \(X\) is still a topological space, so all topological properties continue to hold, and we can still interpret elements of \(\sheaf{O}_X\) as regular functions on \(X\).
    We can define the coordinate ring \(A(X)\) to just be \(A(X) \coloneq \sheaf{O}_X(X)\), since we've seen that this equality holds with the \enquote{old definition}.
    Other things, like products, can be defined by first picking an embedding of \(X\) into affine space and then making definitions relative to this embedding.
    
    With this new definition there are things which we missed before.
    The most important of which are distinguished open sets.
    
    \begin{prp}{}{}
        Let \(X\) be an affine variety and let \(f \in A(X)\).
        Then the distinguished open subset, \(D(f)\), is an affine variety with coordinate ring \(A(D(f)) \isomorphic A(X)_f\).
        \begin{proof}
            First note that
            \begin{equation}
                Y = \{(x, t) \in X \times \affine^1 \mid tf(x) = 1\} \subseteq X \times \affine^1
            \end{equation}
            is an affine variety since it is the zero locus of the polynomial \(tf(x) - 1\).
            For \(x \in Y\) since \(tf(x) = 1\) we know that \(f(x) \ne 0\), and so \(1/f(x)\) makes sense, and in particular \(t = 1/f(x)\). 
            
            Consider the projection map
            \begin{equation}
                \begin{aligned}
                    g \colon Y &\to D(f)\\
                    (x, t) &\mapsto x.
                \end{aligned}
            \end{equation}
            This is a morphism of ringed spaces.
            It has an inverse given by
            \begin{equation}
                \begin{aligned}
                    g^{-1} \colon D(f) &\to Y\\
                    x &\mapsto \left( x, \frac{1}{f(x)} \right).
                \end{aligned}
            \end{equation}
            Here we use \(t = 1/f(x)\).
            Thus, \(g\) is an isomorphism (of ringed spaces) between \(D(f)\) and the affine variety \(Y\), and so \(D(f)\) is itself an affine variety.
            
            Since \(D(f)\) is a subset of \(X\) it is a subvariety, and thus it's coordinate ring is \(\sheaf{O}_X(D(f)) \isomorphic A(X)_f\) (\cref{crl:regular functions on distinguished are localisation}, this still holds with the new definition of an affine variety).
        \end{proof}
    \end{prp}
    
    \chapter{Varieties}
    In the last chapter we redefined affine varieties to be slightly more general.
    There are still some things which are affine-variety-like but are not affine varieties, even with this new definition.
    For example, consider \(U = \affine^2 \setminus \{0\} \subseteq \affine^2 = X\).
    If \(U\) was an affine subvariety of \(X\) then it would have coordinate ring \(\sheaf{O}_X(U)\), and as previously claimed (\cref{exm:extending regular functions over a point}) \(\sheaf{O}_X(U) = K[x_1, x_2]\).
    However, \(K[x_1, x_2] = A(X)\), which would imply that \(U\) and \(X\) are isomorphic as affine varieties, and that the isomorphism is simply the identity map (since this is an equality of coordinate rings, not just an isomorphism).
    However, clearly this is clearly not an isomorphism (its not even a bijection) and so \(U\) is not an affine variety.
    
    We can cover \(U\) with two distinguished open sets,
    \begin{equation}
        D(x_1) = \{(x_1, x_2) \in \affine^2 \mid x_1 \ne 0\}, \qand D(x_2) = \{(x_1, x_2) \in \affine^2 \mid x_2 \ne 0\}.
    \end{equation}
    These are affine varieties, as we showed at the end of the previous chapter, and so \(U\) can be covered by affine varieties.
    
    This suggests that we should extend our thinking to include things which are covered by affine varieties.
    This is analgous to considering a manifold as being covered by copies of (open subsets of) \(\reals^n\).
    There needs to be some compatibility condition on this covering, which for a manifold comes from conditions on the transition maps.
    
    Another motivation for these definitions is that in the standard topology affine varieties over \(\complex\) are never bounded, and thus never compact, unless they are a finite set.
    This is undesirable, and we often want to take something which isn't compact and add a \enquote{point at infinity} to make it compact.
    This can be achieved by gluing affine varieties together where some of them include points at infinity.
    This will lead us to the definition of projective varieties later, but for now we won't have any such points.
    
    \section{Prevarieties}
    A space which is covered by affine varieties is called a prevariety.
    Later we'll define varieties as prevarieties with an extra condition.
    
    \begin{dfn}{Prevariety}{}
        A \defineindex{prevariety} is a ringed space, \(X\), with a finite open cover by affine varieties.
        Morphisms of prevarieties are morphisms of ringed spaces.
        The elements of \(\sheaf{O}_X(U)\) for \(U \subseteq X\) an open set are called \define{regular functions}\index{regular function} on \(U\).
    \end{dfn}
    
    Note that the requirement is the \emph{existence} of an open cover by affine varieties, the open cover is not part of the data of the prevariety.
    
    Any affine variety is trivially a prevariety, having a finite cover open cover by distinguished open subsets, which are themselves affine varieties.
    
    The simplest way to construct new prevarieties is to glue them together from affine varieties, or from other prevarieties.
    To do so let \(X_1\) and \(X_2\) be two prevarieties.
    Let \(U_{1,2} \subseteq X_1\) and \(U_{2,1} \subseteq X_2\) be open subsets.
    Let \(f \colon U_{1,2} \to U_{2,1}\) be an isomorphism of ringed spaces.
    Then we can define a new prevariety, \(X\), by gluing \(X_1\) and \(X_2\) along \(f\).
    That is, we identify \(U_{1,2} \subseteq X_1\) and \(U_{2,1} \subseteq X_2\) using \(f\).
    This identification happens at multiple levels.
    \begin{enumerate}
        \item As a set, \(X = (X_1 \sqcup X_2)/{\sim}\) where \(a \sim f(a)\) and \(f(a) \sim a\) for \(a \in U_{1,2}\) and \(a \sim a\) for \(a \in X_1 \cup X_2\) defines an equivalence relation.
        This gives us natural embeddings \(i_1 \colon X_1 \to X\) and \(i_2 \colon X_2 \to X\) mapping \(x \in X_i\) to its equivalence class in \((X_1 \sqcup X_2) / {\sim}\).
        \item As a topological space, \(U \subseteq X\) is declared to be open if \(i_1^{-1}(U)\) and \(i_2^{-1}(U)\) are open, that is, we equip \(X_1 \sqcup X_2\) with the obvious topology and then \(X\) with the quotient topology.
        \item As a ringed space, we define the structure sheaf of \(X\) by
        \begin{equation}
            \sheaf{O}_X(U) = \{\varphi \colon U \to K \mid i_1^*\varphi \in \sheaf{O}_{X_1}(i_1^{-1}(U)), i_2^*\varphi \in \sheaf{O}_{X_2}(i_2^{-1}(U))\}.
        \end{equation}
        Intuitively, this means that a function on \(X\) is regular if it is regular when restricted to \(X_1\) and \(X_2\).
    \end{enumerate}
    
    When \(X\) is constructed in such a way the images of \(i_1\) and \(i_2\) are open subsets of \(X\) which are isomorphic (as ringed spaces) to \(X_1\) and \(X_2\) respectively.
    Since \(X_1\) and \(X_2\) are prevarieties they have a covering by affine open subsets, and then this provides a covering of \(X\) by such subsets.
    
    \begin{remark}{}{}
        I believe that the construction above makes \(X\) the pushout \(X = X_1 +_{U_{2,1}} X_2\), that is, it's the colimit of the diagram
        \begin{equation}
            \begin{tikzcd}
                X_1 & U_{1,2} \arrow[l, hook'] \arrow[r, "f"] & X_2
            \end{tikzcd}
        \end{equation}
        This is called the cograph of \(f\), being dual to the graph, which is the pullback of \(f\) along the identity on \(U_{2,1}\).
    \end{remark}
    
    \begin{exm}{}{}
        Consider the case of \(X_1 = X_2 = \affine^1\) and \(U_{1,2} = U_{2,1} = \affine^1 \setminus \{0\}\).
        We can consider two different gluing isomorphisms, \(f \colon U_{1,2} \to U_{2,1}\):
        \begin{enumerate}
            \item Let \(f(x) = 1/x\).
            Then \(X_1 = \affine^1\) is an open subset of \(X\) with complement \(X \setminus X_1 = X_2 \setminus U_{2,1}\), which is just a single point corresponding to \(0\) in \(X_2\).
            We interpret this as \enquote{\(\infty = 1/0\)} in the \(X_1\) coordinate.
            We think of the glued space as \(\affine^1 \cup \{\infty\}\), which is the compactification, \(\projective^1\), of the affine line.
            
            When \(K = \complex\) \(X\) is the Riemann sphere, as shown in \cref{fig:projective space from gluing}.
            The gluing shown here gives us morphisms \(X_1 \to X_2 \subseteq \projective^1\), \(x \mapsto x\) and \(X_2 \to X_1 \subseteq \projective^1\), \(x \mapsto x\).
            These correspond to reflecting across the horizontal axis in our picture of the Riemann sphere.
            These glue together to a single morphism, \(\projective^1 \to \projective^1\), which can be thought of as \(x \mapsto 1/x\) when we interpret \(\projective^1\) as \(\affine^1 \cup \{\infty\}\).
            
            \item Instead, we can take \(f \colon U_{1,2} \to U_{2,1}\) to be the identity map.
            Then the space given by gluing \(X_1\) and \(X_2\) along \(f\) is given in the picture \cref{fig:double zero from gluing}.
            We interpret this space as the \enquote{affine line with two zeros}.
            
            This is a slightly weirder space, in particular when we take \(K = \complex\).
            For example, any sequence in \(\complex\) which tends to zero now has two possible limits in \(X\), either copy of \(0\).
            As before we have maps \(X_1 \to X_2 \subseteq X\) and \(X_2 \to X_1 \subseteq X\) both given by \(x \mapsto x\).
            These glue to give a morphism \(g \colon X \to X\) which acts as the identity on the nonzero points and exchanges the two zero points.
            This means that the set \(\{x \in X \mid g(x) = x\} = \affine^1\setminus \{0\}\) is not closed in \(X\), even though it is defined by an equality of two continuous maps.
            
            This space is \emph{too} weird for many of our purposes, so we will not allow such spaces to be varieties.
        \end{enumerate}
    \end{exm}
    
    
    \begin{figure}
        \centering
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{gluing-projective-space}
            \begin{tikzpicture}[baseline=(current bounding box), scale=0.6]
                \draw [very thick, my blue] (262:2) arc (262:-82:2);
                \draw [very thick, my blue] (85:3) arc (85:-265:3);
                \node [my blue] at (90:1.5) {\(0\)};
                \node [my blue] at (45:1.5) {\(1/2\)};
                \node [my blue] at (135:1.5) {\(-1/2\)};
                \node [my blue] at (0:1.5) {\(1\)};
                \node [my blue] at (180:1.5) {\(-1\)};
                \node [my blue] at (-45:1.5) {\(2\)};
                \node [my blue] at (225:1.5) {\(-2\)};
                \node [my blue] at (270:3.5) {\(0\)};
                \node [my blue] at (45:3.5) {\(2\)};
                \node [my blue] at (135:3.5) {\(-2\)};
                \node [my blue] at (0:3.5) {\(1\)};
                \node [my blue] at (180:3.5) {\(-1\)};
                \node [my blue] at (-45:3.5) {\(1/2\)};
                \node [my blue] at (225:3.5) {\(-1/2\)};
                \foreach \i in {100, 120, ..., 260} {
                    \draw [my blue, very thick, <->] (\i:2.1) -- (\i:2.9);
                }
                \foreach \i in {80, 60, ..., -80} {
                    \draw [my blue, very thick, <->] (\i:2.1) -- (\i:2.9);
                }
                \draw [my blue, very thick, ->] (4, 0) -- ++ (1, 0) node [midway, above] {Glue};
                \draw [very thick, my blue] (8, 0) circle [radius=2.5];
                \fill [my blue] (8, 2.5) circle [radius=0.075] node [above] {\(\infty\)};
                \fill [my blue] (8, -2.5) circle [radius=0.075] node [below] {\(0\)};
            \end{tikzpicture}
            \caption[Projective space]{Gluing together two copies of \(\affine^1\) along \(\affine^1 \setminus \{0\}\) to produce \(\projective^1\).}
            \label{fig:projective space from gluing}
        \end{subfigure}
        \begin{subfigure}{0.8\textwidth}
            \centering
            \tikzsetnextfilename{gluing-double-origin}
            \begin{tikzpicture}[baseline=(current bounding box)]
                \draw [very thick, my blue] (-4, 0) -- (4, 0);
                \draw [very thick, my blue] (-4, 1) -- (4, 1);
                \foreach \i in {-4, ..., 4} {
                    \node [above, my blue] at (\i, 1) {\(\i\)};
                    \node [below, my blue] at (\i, 0) {\(\i\)};
                }
                \foreach \i in {1, ..., 4} {
                    \draw [very thick, my blue, <->] (\i, 0.1) -- ++ (0, 0.8);
                    \draw [very thick, my blue, <->] (-\i, 0.1) -- ++ (0, 0.8);
                }
                \draw [very thick, my blue, ->] (0, -1) -- ++ (0, -1) node [midway, right] {Glue};
                \draw [very thick, my blue] (-4, -3) -- (-0.2, -3);
                \draw [very thick, my blue] (0.2, -3) -- (4, -3);
                \fill [my blue] (0, -2.5) circle [radius=0.075] node [above] {\(0\)};
                \fill [my blue] (0, -3.5) circle [radius=0.075] node [below] {\(0\)};
                \draw [very thick, dashed, my blue] (-0.2, -3) .. controls (-0.15, -2.8) .. (0, -2.5);
                \draw [very thick, dashed, my blue] (-0.2, -3) .. controls (-0.15, -3.3) .. (0, -3.5);
                \draw [very thick, dashed, my blue] (0.2, -3) .. controls (0.15, -2.8) .. (0, -2.5);
                \draw [very thick, dashed, my blue] (0.2, -3) .. controls (0.15, -3.3) .. (0, -3.5);
            \end{tikzpicture}
            \caption[Double zero]{Gluing together two copies of \(\affine^1\) along \(\affine^1\setminus \{0\}\) to produce the line with two origins.}
            \label{fig:double zero from gluing}
        \end{subfigure}
        \caption{Different ways to glue two punctured affine lines.}
    \end{figure}
    
    In order to glue together an arbitrary number of sets we need to do the same as the case of two sets and also add a compatibility condition for the overlap of the gluings.
    This is what we define here.
    
    Let \(I\) be a finite index set and let \(X_i\) be prevarieties for \(i \in I\).
    Then for \(i, j \in I\) with \(i \ne j\) let \(U_{i,j} \subseteq X_i\) be an open subset equipped with an isomorphism of ringed spaces, \(f_{i,j} \colon U_{i,j} \to U_{j,i}\) such that for \(i, j, k \in I\) all distinct we have
    \begin{enumerate}
        \item \(f_{j,i} = f_{i,j}^{-1}\); and
        \item \(f_{i,j}^{-1}(U_{j,k}) \subseteq U_{i,k}\) and \(f_{j,k} \circ f_{i,j}|_{f^{-1}_{i,j}(U_{j,k})} = f_{i,k}|_{f^{-1}_{i,j}(U_{j,k})}\).
    \end{enumerate}
    The first condition just says that we can glue \(i\) to \(j\) or \(j\) to \(i\), in the case of 2 sets we just ignored this and glued \(1\) to \(2\).
    The second condition says if we glue \(i\) to \(j\) and then to \(k\) that should be the same as gluing \(i\) directly to \(j\).
    The construction then proceeds in an analogous way to the case of two sets.
    We define \(X = \left( \bigcup_{i \in I} X_i \right)/{\sim}\) where \(a \sim f_{i,j}(a)\) for all \(a \in U_{i,j}\) and \(a \sim a\) for all \(a\).
    The conditions above are exactly what is required for this to define an equivalence relation.
    Then \(X\) is made into a prevariety by the obvious topology and structure sheaf generalising the case of gluing two sets.
    That is, we have embeddings \(i_j \colon X_j \to X\) and \(U \subseteq X\) is open if \(i_j^{-1}(U)\) is open in \(X_j\) for all \(j \in I\), and we define
    \begin{equation}
        \sheaf{O}_X(U) = \{\varphi \colon U \to K \mid i_j^*\varphi \in \sheaf{O}_{X_j}(i_j^{-1}(U)) \text{ for all} j \in I\}.
    \end{equation}
    
    \section{Properties of Prevarieties}
    First note that all topological concepts, such as connectedness, irreducibility and dimension, carry over from affine varieties to prevarities.
    In particular, the decomposition into irreducible subspaces holds.
    For properties involving the structure of the ringed spaces we need to look at to what extent subsets, images, and preimages under morphisms and products are again prevarieties.
    
    \subsection{Subprevarieties}
    Let \(X\) be a prevariety and let \(U \subseteq X\) be an open subset.
    Then \(U\) is a a prevariety, with the structure sheaf \(\sheaf{O}_U = \sheaf{O}_{X}|_U\).
    Since \(X\) can be covered by affine varieties \(U\) can be covered by open subsets of affine varieties, which can then themselves be covered by affine varieties (such as distinguished open sets).
    We call \(U\) an \defineindex{open subprevariety} of \(X\).
    
    Things are a little more complicated for \(Y \subseteq X\) a closed subset.
    An open subset, \(U \subseteq Y\), is not, generally, open in \(X\).
    So, we can't define a structure sheaf on \(Y\) by setting \(\sheaf{O}_Y(U)\) to be \(\sheaf{O}_X(U)\).
    Instead, we can define \(\sheaf{O}_Y(U)\) to be the \(K\)-algebra of functions \(U \to K\) which are locally restrictions of functions on \(X\).
    That is,
    \begin{multline}
        \sheaf{O}_Y(U) \coloneq \{\varphi \colon U \to K \mid \forall a \in U \exists \text{ an open neighbourhood, } V \text{, of }a \text{ in }X\\
        \text{ and } \psi \in \sheaf{O}_X(V) \text{ with } \varphi = \psi|_{U \cap V}\}.
    \end{multline}
    The local nature of this definition makes \(\sheaf{O}_Y\) a sheaf, and thus \((Y, \sheaf{O}_Y)\) is a ringed space.
    One can show that \(Y\) is indeed a prevariety in this way, and we call it a \defineindex{closed subprevariety}.
    
    For a general (neither open nor closed) subset of \(X\) there is no way to make it into a prevariety in a natural way.
    Worse than this, the notions of open and closed subprevarieties do not mix well, taking a union of an open and closed subprevariety need not naturally form an open or closed subprevariety.
    For example, taking \(X = \affine^2\) there's an open subprevariety \(U = \affine^1 \times (\affine^1 \setminus \{0\})\), and a closed subprevariety \(Y = \{0\}\).
    The union of these does not have a natural structure as a subprevariety of \(\affine^2\) since at the origin it does not look like an affine variety (\cref{fig:not subprevariety}).
    
    \begin{figure}
        \centering
        \tikzsetnextfilename{not-subprevariety}
        \begin{tikzpicture}[baseline=(current bounding box), scale=0.8]
            \fill [my blue] (0, 0.05) rectangle (3, 2);
            \fill [my blue] (0, -0.05) rectangle (3, -2);
            \fill [my blue] (1.45, -0.1) rectangle (1.55, 0.1);
        \end{tikzpicture}
        \caption[Not a subprevariety]{The union of \(U = \affine^1 \times (\affine^1 \setminus \{0\})\) and \(Y = \{0\}\) is not a subprevariety of \(X = \affine^2\).}
        \label{fig:not subprevariety}
    \end{figure}
    
    Let \(Y\) be a closed subprevariety of \(X\).
    Then the inclusion map, \(Y \hookrightarrow X\), is a morphism, since inclusions are continuous and regular functions are, by construction, still regular when restricted to \(Y\).
    
    If \(f \colon Z \to X\) is a morphism from some prevariety, \(Z\), and is such that \(f(Z) \subseteq Y\) then we can also think of \(f\) as a morphism \(Z \to Y\), sinec the pullback of a regular function on \(Y\) by \(f\) is locally a pullback of a regular function on \(X\), and thus regular since \(f \colon X \to Z\) is a morphism.
    
    \subsection{Images and Preimages}
    Let \(f \colon X \to Y\) be a morphism of prevarieties.
    The image of an open or closed subprevariety of \(X\) is not necessarily an open or closed subprevariety of \(Y\).
    
    For example, consider the affine variety \(X = V(x_2x_3 - 1) \cup \{0\} \subseteq \affine^3\).
    On this variety \(x_1\) can take any value, while \(x_2\) must be invertible, since \(x_2x_3 = 1\), or we can have\(x_1 = x_2 = x_3 = 0\).
    Thus, \(x_2\) can only be zero if all three coordinates are zero.
    Take the projection morphism, \(f \colon X \to \affine^2\), onto the first two coordinates.
    The image, \(f(X)\), is \(\affine^1 \times (\affine^2 \setminus \{0\}) \cup \{0\}\), that is, \(x_1 \in \affine^1\) and \(x_2 \in \affine^1\) with \(x_2 = 0\) only if \(x_1 = 0\) also.
    This space, \(\affine^1 \times (\affine^1 \setminus \{0\}) \cup \{0\}\), is neither an open nor closed subprevariety as argued with \cref{fig:not subprevariety}.
    
    Conversely, if we take the inverse image of an open or closed subprevariety of \(Y\) under the morphism \(f \colon X \to Y\) then the result is again an open or closed subprevariety.
    
    \subsection{Products}
    A naive definition of the product, \(X \times Y\), of two prevarieties is to choose open affine covers, \(\{U_i\}_{i \in I}\) and \(\{V_j\}_{j \in J}\), and then take the affine product varieties, \(U_i \times V_j\) as an open cover of \(X \times Y\).
    This is the right idea, but proving that the resulting space doesn't depend on the choice of affine cover is hard.
    Fortunately, all we need to do is show that this space satisfies the universal property of products and then it's guaranteed to be unique (up to isomorphism).
    
    \begin{prp}{Existence of Products}{}
        Let \(X\) and \(Y\) be prevarieties.
        Their product exists.
        \begin{proof}
            Let \(\{U_1, \dotsc, U_n\}\) and \(\{V_1, \dotsc, V_m\}\) be coverings of \(X\) and \(Y\) by affine varieties.
            We cn form all pairs \(U_i \times V_j\), which are affine varieties, and we can glue any two such products along their common open subset, that is, we glue \(U_i \times V_j\) and \(U_{i'} \times V_{j'}\) along the identity morphism of \((U_i \cap U_{i'}) \cap (V_j \cap V_{j'})\).
            These identity maps clearly satisfy the requirements of the gluing construction.
            The resulting space covered by these \(U_i \cap V_j\) is exactly the Cartesian product \(X \times Y\).
            
            The affine products come with projection morphisms, \(U_i \times V_j \to U_i \subseteq X\) and \(U_i \times V_j \to V_j \subseteq Y\).
            We can glue these to morphisms \(\pi_X \colon X \times Y \to X\) and \(\pi_Y \colon X \times Y \to Y\).
            
            It remains only to check that \(X \times Y\) with these projection morphisms satisfies the universal property of a product.
            Suppose that \(Z\) is another prevariety equipped with morphisms \(f_X \colon Z \to X\) and \(f_Y \colon Z \to Y\).
            We're looking to have a unique morphism \(f \colon Z \to X \times Y\) such that \(\pi_X \circ f = f_X\) and \(\pi_Y \circ f = f_Y\).
            These conditions impose that \(\pi_X(f(z)) = f_X(z)\) and \(\pi_Y(f(z)) = f_Y(z)\) and since \(\pi_X\) and \(\pi_Y\) are just projection onto the first coordinate it must be that \(f(z) = (f_X(z), f_Y(z))\).
            There is no choice in defining \(f\), so it is unique, and indeed \(X \times Y\) is the product.
        \end{proof}
    \end{prp}
    
    Suppose \(X\) and \(Y\) are two prevarieties with closed subprevarieties \(X' \subseteq X\) and \(Y' \subseteq Y\).
    Then \(X' \times Y'\) has a prevariety structure as a product of prevarieties, but it also has a prevariety structure as a closed subset of \(X \times Y\).
    Fortunately, these two structures agree.
    
    \subsection{Varieties}
    We now impose a condition which removes pathalogical spaces such as the line with two origins.
    If we were working with manifolds we wouldn't allow this space as it isn't Hausdorff.
    However, we've already seen that most affine varieties \emph{aren't} Hausdorff, so this is the wrong condition to impose here.
    The solution is to use the characterisation of being Hausdorff of \cref{lma:hausdorff iff diagonal closed} but modified to our purposes.
    This lets us check if a topological space, \(X\), is Hausdorff by first forming the product, \(X \times X\), with the product topology, and then \(X\) is Hausdorff if the diagonal, \(\Delta = \{(x, x) \mid x \in X\} \subseteq X \times X\), is closed with the subspace topology.
    Now, as stated this is equivalent to being Hausdorff in terms of separating neighbourhoods, so we need to modify it.
    The correct change happens to be that \(X \times X\) should not be equipped with the product topology, but instead is equipped with its own Zariski topology.
    
    \begin{dfn}{Separated}{}
        A prevariety \(X\) is called a \defineindex{variety} or \defineindex{separated} if the diagonal, \(\Delta = \{(x, x) \mid x \in X\}\), is closed in \(X \times X\) (when \(X \times X\) is equipped with the Zariski topology).
    \end{dfn}
    
    Let's check this rules out the line with two origins, \(X\).
    Let \(a\) and \(b\) be the two origins.
    Then \(X \times X\) has \((a, a)\), \((a, b)\), \((b, a)\), and \((b, b)\).
    However, of these only \((a, a)\) and \((b, b)\) are in \(\Delta\).
    This means that \(\Delta\) is not closed, because the closure of \(\Delta\) also contains \((a, b)\) and \((b, a)\), since any polynomials which vanish at \((a, a)\) and \((b, b)\) also vanish at \((a, b)\) and \((b, a)\), since \(a\) and \(b\) are both just copies of \(0\).
    
    We will almost always assume that we are working with separated spaces.
    Fortunately, the following shows that this doesn't mean we lose too much, just the pathalogical cases like the line with two origins.
    
    \begin{lma}{}{}
        \begin{enumerate}
            \item Affine varieties are varieties.
            \item Open and closed subprevarieties of varieties are varieties.
            Therefore we call them \define{open}\index{open subvariety} and \define{closed subvarieties}\index{closed subvariety}.
        \end{enumerate}
        \begin{proof}
            \begin{enumerate}
                \item Let \(X \subseteq \affine^n\) be an affine variety.
                Then we can identify \(X \times X\) as having coordinates \(x_1, \dotsc, x_n\) on the first factor and \(y_1, \dotsc, y_n\) on the second factor.
                Then we have \(\Delta = V(x_1 - y_1, \dotsc, x_n - y_n)\), and so \(\Delta\) is closed.
                \item If \(Y \subseteq X\) is either an open or closed subset then we can take the inclusion morphism \(i \colon Y \times Y \to X \times X\).
                This exists by the universal property of the product and the fact that \((a, b) \mapsto a\) and \((a, b) \mapsto b\) define morphisms \(Y \to X \times X\).
                Then we have \(\Delta_Y = i^{-1}(\Delta_X)\) and since \(\Delta_X\) is closed by assumption \(\Delta_Y\) is closed since \(i\) is continuous.
            \end{enumerate}
        \end{proof}
    \end{lma}
    
    Many of the definitions we've made for affine varieties still make sense for varieties.
    For example, we can talk of curves and surfaces in a variety.
    
    \begin{dfn}{}{}
        A variety of pure dimension \(1\) is called a \defineindex{curve}, and a variety of pure dimension \(2\) is called a \defineindex{surface}.
        If \(X\) is a pure-dimensional variety and \(Y\) a pure-dimensional subvariety of codimension \(1\), that is \(\dim Y = \dim X - 1\), then we say \(Y\) is a \defineindex{hypersurface} in \(X\).
    \end{dfn}
    
    There are many desirable properties of varieties, such as the following.
    
    \begin{prp}{}{}
        Let \(f, g \colon X \to Y\) be a morphism of prevarieties, and let \(Y\) be a variety.
        Then
        \begin{enumerate}
            \item the graph, \(\Gamma_f = \{(x, f(x)) \mid x \in X\}\) is closed in \(X \times Y\);
            \item the set \(\{x \in X \mid f(x) = g(x)\}\) is closed in \(X \times Y\).
         \end{enumerate}
         \begin{proof}
             \begin{enumerate}
                 \item Notice that there are two maps \(X \times Y \to Y\), given by \((x, y) \mapsto f(x)\) and \((x, y) \mapsto y\).
                 Thus, by the universal property of the product, there is a unique morphism \(X \times Y \to Y \times Y\), and it must be given by \((x, y) \mapsto (f(x), y)\).
                 Then \(\Gamma_f\) is the preimage of \(\Delta_Y\) under this map, and since \(\Delta_Y\) is closed and this map is continuous \(\Gamma_f\) is closed.
                 \item There are two maps \(X \to Y\), namely \(f\) and \(g\), and thus by the universal property of the product there's a unique map \(X \to Y \times Y\), and we can check that for the required diagram to commute it must be given by \(x \mapsto (f(x), g(x))\).
                 Then the given set is the preimage of \(\Delta_Y\) under this map, and thus, by continuity of this map, the given set is closed.
             \end{enumerate}
         \end{proof}
    \end{prp}
    
    Note that the set \(\{x \in X \mid f(x) = g(x)\}\) is the equaliser of \(f\) and \(g\) in the category of varieties.
    
    \chapter{Projective Varieties: Topology}
    An affine variety is only compact (in the standard topology of, say, \(\complex\)) if it consists of finitely many points.
    In the previous chapter we saw that by gluing together two copies of \(\affine^1\) we produced the compact \(\projective^1\).
    Unfortunately, the description of such spaces in terms of gluing of affine patches is fairly cumbersome.
    In this chapter we'll look at a better description for compact spaces that are defined similarly to affine varieties.
    That is, we'll look at spaces (have a covering of spaces) defined to be the vanishing sets of some functions.
    The idea is to work with projective space in place of affine space, which involves adding \enquote{points at infinity} to compactify.
    In fact, it turns out that the class of varieties we construct this way is massive, so large that we won't see any examples that aren't open subsets of such a projective variety.
    
    \section{Projective Space}
    \begin{dfn}{Projective Space}{}
        For \(n \in \naturals\) we define the \define{projective \(\symbf{n}\)-space}\index{projective space} over a field, \(K\), to be the set, \(\projective^n_K = \projective^n\), of all 1-dimensional linear subspaces of the vector space \(K^{n + 1}\).
    \end{dfn}
    
    Note that this definition defines \(\projective^n\) as \(\Gr(1, n+1)\), the Grassmannian of \(1\)-dimensional subspaces of \(n + 1\) dimensional space.
    In a couple of chapters we'll see that Grassmannians can be generalised greatly to \(k\)-dimensional subspaces.
    
    Dealing with all \(1\)-dimensional subspaces is a little tricky.
    The solution is to identify each subspace with a point in that subspace.
    The problem then is that we can choose any nonzero point for this description.
    Fortunately, all of these points are related by scalar multiplication.
    We therefore make the identification
    \begin{equation}
        \projective^n = (K^{n + 1} \setminus \{0\}) / {\sim}
    \end{equation}
    where \(\sim\) is the equivalence relation given by declaring \((x_0, \dotsc, x_n) \sim (y_0, \dotsc, y_n)\) if there exists some \(\lambda \in K^*\) such that for all \(i\) we have \(x_i = \lambda y_i\).
    Note that \(\lambda\) must be the same for all \(i\).
    It's also common to write this as \(\projective^n = (K^{n+1} \setminus \{0\}) / K^*\).
    We index our coordinates starting at \(0\) when working with projective spaces so that the last index is \(n\), this is just a choice, but a convenient one.
    We denote the equivalence class of \((x_0, \dotsc, x_n)\) by \(\projCoord{x_0, \dotsc, x_n}\), and we will generally think of these as being the points of \(\projective^n\).
    We call these the \defineindex{homogeneous coordinates} of a point.
    Note that as part of the definition we cannot have all of the \(x_i\) zero.
    
    There is an obvious embedding of affine \(n\)-space in projective \(n\)-space, given by
    \begin{equation}
        \begin{aligned}
            f \colon \affine^n &\to \projective^n\\
            (x_1, \dotsc, x_n) &\mapsto \projCoord{1, x_1, \dotsc, x_n}.
        \end{aligned}
    \end{equation}
    Fixing the first coordinate to be \(1\) removes the ability to scale within the image of this function, and thus we can see that the map is injective.
    The image of the map is \(U_0 = \{\projCoord{x_0, x_1, \dotsc, x_n} \mid x_0 \ne 0\}\).
    On this image the inverse map is given by
    \begin{equation}
        \projCoord{x_0, \dotsc, x_n} \mapsto \left( \frac{x_1}{x_0}, \dotsc, \frac{x_n}{x_0} \right).
    \end{equation}
    With this we can think of \(\affine^n\) as being embedded as the open subset \(U_0 \subseteq \projective^n\).
    We call \(\affine^n\) viewed in this way the \defineindex{affine part} of \(\projective^n\) and we call \((x_1/x_0, \dotsc, x_n/x_0)\) the \defineindex{affine coordinates} of \(\projCoord{x_0, \dotsc, x_n}\).
    
    The remaining points, \(\projCoord{0, x_1, \dotsc, x_n}\), are viewed as \enquote{points at infinity}, since their affine coordinates (which aren't really defined) have \(x_1/0 \enquote{=} \infty\).
    Forgetting the first coordinate, which is always zero here, we can identify the points at infinity with a copy of \(\projective^{n-1}\).
    Thus,
    \begin{equation}
        \projective^n = \affine^n \sqcup \projective^{n-1}.
    \end{equation}
    So, projective space breaks up into affine space plus points at infinity.
    Once we give \(\projective^n\) the structure of a variety we will see that in this decomposition \(\affine^n\) is an open subvariety and \(\projective^{n-1}\) is a closed subvariety.
    
    Note that when \(K = \complex\) with the standard topology we can give \(\complex^n\) the product topology, and then \(\complex^n \setminus \{0\}\) and \(\complex^{\times}\) get a subspace topology, and finally \((\complex^n \setminus \{0\})/\complex^{\times}\) gets the quotient topology.
    This makes \(\projective^n_{\complex}\) into a compact space.
    Recall that the quotient topology has as open sets those sets which have open preimage under the quotient map, \(\pi \colon \complex^{n+1} \setminus \{0\} \twoheadrightarrow \projective^{n+1}_{\complex}\).
    Let
    \begin{equation}
        S^{n-1} = \{(x_0, \dotsc, x_n) \in \complex^{n + 1} \mid \abs{x_0}^2 + \dotsb + \abs{x_n}^2 = 1\}
    \end{equation}
    be the unit sphere in \(\complex^{n+1}\).
    This is compact since it is a closed and bounded subset of \(\complex^{n + 1}\).
    Further, every point in \(\projective^n\) can always be represented by choosing a point which lies on \(S^{n-1}\), so the map \(\pi|_{S^{n-1}} \colon S^{n-1} \to \projective^n\) is surjective, and so \(\projective^n\) is compact as it's the image of a compact set under a continuous map.
    
    \section{Homogeneous Polynomials}
    We want to define projective varieties in analogy to affine varieties, that is, as the zero loci of polynomials.
    However, if \(f \in K[x_0, \dotsc, x_n]\) is an arbitrary polynomial then defining this to be something like
    \begin{equation}
        \{\projCoord{x_0, \dotsc, x_n} \mid f(x_0, \dotsc, x_n) = 0\}
    \end{equation}
    doesn't make sense, since homogeneous coordinates are only defined up to a scalar and whether \(f\) vanishes at a point will therefore depend on the choice of that scalar.
    For example, if we take \(n = 1\) and \(f(x_0, x_1) = x_1^2 - x_0\) then \(f(1, 1) = 0\) and \(f(-1, -1) = 2 \ne 0\) even though \(\projCoord{1,1}\) and \(\projCoord{-1,{-}1}\) represent the same point in \(\projective^1\).
    To get around this problem we restrict the polynomials we consider.
    
    \begin{dfn}{Homogeneous Polynomials}{}
        A polynomial, \(f \in K[x_0, \dotsc, x_n]\), is \defineindex{homogeneous} (of degree \(d\)) if all of its monomials have the same total degree (\(d\)).
        Write \(K[x_0, \dotsc, x_n]_d\) for the homogeneous polynomials of degree \(d\).
     \end{dfn}
    
    For example, \(x_0x_1 + x_1^2 - x_0x_2\) is homogeneous of degree \(2\).
    For a homogeneous polynomial if we scale by some nonzero \(\lambda \in K\) then each monomial picks up a factor of \(\lambda^d\), and thus \(f(\lambda x_0, \dotsc, \lambda x_n) = \lambda^d f(x_0, \dotsc, x_n)\), which crucially means that the zeros of \(f\) are unaffected by scaling.
    This lets us define the zero locus of \(f\) in the obvious way.
    
    The ring \(R = K[x_0, \dotsc, x_n]\) is graded, taking \(R_d = K[x_0, \dotsc, x_n]_d\) to consist of all degree \(d\) homogeneous polynomials.
    
    \begin{dfn}{Homogeneous Ideal}{}
        An ideal in a graded ring is \define{homogenous}\index{homogeneous ideal} if it is generated by homogeneous elements.
    \end{dfn}
    
    Note that the elements of a homogeneous ideal \emph{are not} homogeneous.
    For example, taking \(R = K[x]\) the ideal \(\langle x \rangle\) is homogeneous, since it is generated by the homogeneous polynomial \(x\).
    However, \(x^2 + x^3 = x(x + x^2)\) is in this ideal, and this is not homogeneous.
    
    Another example is \(R = K[x, y]\) with the ideal \(\langle x, xy + y^2 \rangle\).
    Each generating polynomial is homogeneous, but not of the same degree, that isn't a requirement.
    
    \begin{lma}{Properties of Homogeneous Ideals}{lma:homogeneous ideal properties}
        Let \(R\) be a graded ring with ideals \(J\), \(J_1\) and \(J_2\).
        \begin{enumerate}
            \item The ideal \(J\) is homogeneous if and only if for all \(f \in J\) with homogeneous decomposition \(f = \sum_{d \in \naturals} f_d\) we have \(f_d \in J\) for all \(d \in \naturals\).
            \item If \(J_1\) and \(J_2\) are homogeneous ideals then so are \(J_1 + J_2\), \(J_1J_2\), \(J_1 \cap J_2\), and \(\sqrt{J_1}\).
            \item If \(J\) is homogeneous then the quotient ring, \(R/J\), is a graded ring with homogeneous decomposition \(R/J = \bigoplus_{d \in \naturals} R_d/(R_d \cap J)\).
        \end{enumerate}
        \begin{proof}
            \begin{enumerate}
                \item Let \(J = \langle h_i \mid i \in I \rangle\) be a homogeneous ideal generated by homogeneous \(h_i \in R\).
                Let \(f \in J = \sum_{i \in I} g_i h_i\) for some (not-necessarily-homogeneous) \(g_i \in R\), of which only finitely many are nonzero.
                Let \(g_i = \sum_{e \in \naturals} g_{i,e}\) be the homogeneous decomposition of \(g_i\) into homogeneous elements, \(g_{i,e} \in R_e\).
                Then we have
                \begin{equation}
                    f = \sum_{i \in I} g_{i} h_i = \sum_{i \in I} \sum_{e \in \naturals} g_{i,e}h_i
                \end{equation}
                and from this and uniqueness of decompositions we have
                \begin{equation}
                    f_d = \sum_{\substack{i \in I, e \in \naturals\\ e + \deg h_i = d}} g_{i,e} h_i
                \end{equation}
                which shows that \(f_d \in J\).
                
                Now suppose that if \(f \in J\) then \(f_d \in J\) for all \(f_d\).
                We claim that \(J\) is generated by the homogeneous parts of all polynomials in \(J\), that is, \(J = \langle h_d \mid h \in J, d \in \naturals \rangle\), so \(J\) is a homogeneous ideal.
                Clearly we have \(J \subseteq \langle h_d \mid h \in J, d \in \naturals \rangle\) since \(h = \sum_{d \in \naturals} h_d\) and so \(h \in J\), and we also have that \(J \supseteq \langle h_d \mid h \in J, d \in \naturals\) by assumption that \(J\) contains all homogeneous parts of its elements, and thus everything they generate.
                
                \item Suppose that \(J_1\) and \(J_2\) are homogeneous ideals.
                Then they are generated by homogeneous elements.
                The ideal \(J_1 + J_2\) is generated by \(J_1 \cup J_2\) and \(J_1 \cap J_2\) is generated by \(J_1 \cap J_2\), both of which consist of homogeneous elements, and \(J_1J_2\) is generated by products of homogeneous elements, which are again homogeneous.
                
                It remains only to show that \(\sqrt{J_1}\) is homogeneous.
                We do this by checking that the previous part applies.
                Take \(f \in \sqrt{J_1}\).
                We will work by induction on \(d = \deg f\).
                Let \(f = f_0 + \dotsb + f_d\) be the homogeneous decomposition of \(f\).
                Then for some \(n \in \naturals\) we have that
                \begin{equation}
                    f^n = (f_0 + \dotsb + f_d)^n = f_d^n + \text{lower degree terms}
                \end{equation}
                is in \(J_1\).
                Since \(J_1\) is homogeneous by the previous point it must be that the degree \(nd\) part \(f_d^n\) is in \(J_1\), and thus \(f_d \in \sqrt{J_1}\).
                Then we have that the difference of two elements of \(\sqrt{J_1}\), \(f - f_d = f_0 + \dotsb + f_{d-1}\), is in \(\sqrt{J_1}\) also.
                Then, by induction, we have that \(f_0, \dotsc, f_{d-1} \in \sqrt{J_1}\), so \(\sqrt{J_1}\) contains all homogeneous parts of any of its elements, and so is itself homogeneous.
                
                \item Consider the map \(R_d / (R_d \cap J) \to R/J\) sending \(f + R_d \cap J\) to \(f + J\).
                This is a clearly a group homomorphism.
                The kernel of this map consists of elements \(f + R_d \cap J\) which map to \(0 + J\), which is to say \(f\) is an element of \(J\), but then \(f \in R_d \cap J\) so \(f + R_d \cap J = 0 + R_d \cap J\), and thus the kernel is trivial, so this map is injective.
                This injection allows us to consider \(R_d/(R_d \cap J)\) as a subgroup of \(R/J\) for any fixed \(d \in \naturals\).
                
                Now let \(f \in R\) have homogeneous decomposition \(f = \sum_{d \in \naturals} f_d\).
                Then using this subgroup we have the homogeneous decomposition \(f + R_d \cap J = \sum_{d \in \naturals} (f + R_d \cap J) = \sum_{d \in \naturals} (f_d + R_d \cap J)\), so \(f + J\) has a homogeneous decomposition in \(R/J\).
                It remains to show that this is unique.
                Suppose \(\sum_{d \in \naturals} (f_d + J) = \sum_{d \in \naturals} (f_d' J)\) are two decompositions of \(f + J\).
                Then equality in \(R/J\) means that the difference, \(\sum_{d \in \naturals} (f_d - f_d')\) lies in \(J\), and so by the first part of this lemma \(f_d - f_d' \in J\) for all \(d\), and thus \(f_d + R_d \cap J = f_d' + R_d \cap J\), and equality in the subgroup means equality in \(R/J\), and thus we have the result.
            \end{enumerate}
        \end{proof}
    \end{lma}
    
    Take for example \(J = \langle x^2 \rangle \subideal K[x]\).
    This is homogeneous, and contains elements like \(f(x) = 2x^2 + x^3 = (2 + x)x^2\).
    Then according to this result the homogeneous parts, \(f_2(x) = 2x^2\) and \(f_3(x) = x^3\), must also be in \(J\), and indeed they are.
    
    \section{Projective Varieties}
    We are now equipped to define projective varieties in the same way we defined affine ones.
    For simplicity for \(f \in K[x_0, \dotsc, x_n]\) a homogeneous polynomial and \(x = \projCoord{x_0, \dotsc, x_n} \in \projective^n\) we write the condition that \(f(x_0, \dotsc, x_n) = 0\) (which is invariant under scaling of coordinates) as \(f(x) = 0\).
    
    \begin{dfn}{Projective Variety}{}
        Fix \(n \in \naturals\) and some subset \(S \subseteq K[x_0, \dotsc, x_n]\) of homogeneous polynomials.
        The \define{projective zero locus}\index{zero locus!projective} of \(S\) is defined to be the set
        \begin{equation}
            V(S) \coloneq \{x \in \projective^n \mid f(x) = 0 \forall f \in S\} \subseteq \projective^n.
        \end{equation}
        Any set of this form is called a \defineindex{projective variety}.
        For \(S = \{f_1, \dotsc, f_k\}\) we write \(V(S) = V(f_1, \dotsc, f_k)\).
    \end{dfn}
    
    For a homogeneous ideal, \(J \subideal K[x_0, \dotsc, x_n]\), we write
    \begin{equation}
        V(J) = \{x \in \projective^n \mid f(x) = 0 \text{ for all homogeneous } f \in J\} \subseteq \projective^n,
    \end{equation}
    If \(J\) is the ideal generated by the set \(S\) of homogeneous polynomials then clearly \(V(J) = V(S)\).
    
    \begin{dfn}{}{}
        Let \(X \subseteq \projective^n\) be any subset of projective space.
        We define its \defineindex{ideal} to be
        \begin{equation}
            I(X) \coloneq \langle f \in K[x_0, \dotsc, x_n] \mid f \text{ homogeneous}, f(x) = 0 \forall x \in X \rangle \subideal K[x_0, \dotsc, x_n].
        \end{equation}
    \end{dfn}
    
    Note that this definition is slightly different to the affine case.
    The homogeneous polynomials vanishing on \(X\) do not form an ideal, instead we take they ideal they generate.
    This wasn't the case in the affine setting where polynomials vanishing on \(X\) automatically form an ideal.
    
    \begin{ntn}{}{}
        Where we wish to distinguish constructions in the affine setting and projective setting we will write \(V_{\symrm{p}}\) and \(I_{\symrm{p}}\) for the projective setting and \(V_{\symrm{a}}\) and \(I_{\symrm{a}}\) for the affine setting.
    \end{ntn}
    
    For the most part in this and the next chapter we'll stick with \(V\) and \(I\) for the projective case and \(V_{\symrm{a}}\) and \(I_{\symrm{a}}\) if we want to compare to the affine case.
    
    \begin{exm}{}{}
        We have that
        \begin{equation}
            V(1) = \{x \in \projective^n \mid 1 = 0\} = \emptyset,
        \end{equation}
        and
        \begin{equation}
            V(0) = \{x \in \projective^n \mid 0 = 0\} = \projective^n.
        \end{equation}
        So, \(\emptyset\) and \(\projective^n\) are projective varieties.
    \end{exm}
    
    \begin{exm}{}{}
        If \(f_1, \dotsc, f_r \in K[x_0, \dotsc, x_n]\) are homogeneous linear polynomials in the \(x_i\) then we call \(V(f_1, \dotsc, f_r) \subseteq \projective^n\) a linear subspace of \(\projective^n\).
        
        For example, taking \(n = 1\) we can consider \(x - y \in K[x, y]\), which gives the linear subspace \(V(x - y)\), which consists of the points \(\projCoord{x, {-}x}\) for \(x \in K\).
        All of these points are equivalent to \(\projCoord{1, {-}1}\), so in this case our linear subspace is just a single point, which makes sense, we've got a line, \(\projective^1\), and we've taken a linear subspace which certainly isn't all of \(\projective^1\), so we've been left with a single intersection point.
    \end{exm}
    
    \begin{exm}{}{}
        For \(a = \projCoord{a_0, \dotsc, a_n} \in \projective^n\) the set \(\{a\}\) is a projective variety.
        This variety is defined by the equation \(x - a = 0\), however, this is not homogeneous.
        Let \(i \in \{0, \dotsc, n\}\) be such that \(a_i \ne 0\), such an \(i\) exists as projective coordinates cannot all be zero.
        Then we have
        \begin{equation}
            V(a_ix_0 - a_0x_i, a_ix_1 - a_1x_i, \dotsc, a_ix_n - a_nx_i) = \{a\}
        \end{equation}
        since the first equation, \(a_i x_0 - a_0x_i = 0\), forces us to take \(x_0 = a_0x_i/a_i\), the second forces \(x_1 = a_1x_i/a_i\), and so on.
        Thus we always have that \(x_0 \propto a_0\), \(x_1 \propto a_1\), and so on, and the constant of proportionality is \(x_i/a_i\) in each case.
        Hence, \(\projCoord{x_0, x_1, \dotsc, x_n} = \projCoord{a_0 x_i/a_i, a_1 x_i/a_i, \dotsc, a_n x_i/a_i} = \projCoord{a_0, a_1, \dotsc, a_n}\), so if \(x\) satisfies all equations it must be that \(x = a\) as points in projective space.
    \end{exm}
    
    \begin{exm}{}{}
        Let \(f = x_1^2 - x_2^2 - x_0^2 \in \complex[x_0, x_1, x_2]\).
        The real part of the affine zero locus, \(V_{\symrm{a}}(f) \subseteq \affine^3\), is the 2-dimensional cone.
        The projective zero locus, \(V_{\symrm{p}}(f) \subseteq \projective^2\), is the set of all one-dimensional linear subspaces contained in this cone.
        We have seen that we can think of \(\projective^2\) as \(\affine^2\).
        We can embed \(\affine^2\) in \(\affine^3\) by setting \(x_0 = 1\)).
        We should think of \(\projective^2\) as being this copy of \(\affine^2\) plus some points (actually a whole copy of \(\projective^1\)) at infinity.
        Note that we're making a choice to embed at \(x_0 = 1\), any nonzero \(x_0\) value would work just as well.
        With this interpretation the real part of \(V_{\symrm{p}}(f)\) consists of the hyperbola \(x_1^2 - x_2^2 - 1 = 0\), which comes from setting \(x_0 = 1\) in \(f\), (so is the intersection of the cone and the \(x_0 = 1\) plane) as well as the two points \(a\) and \(b\), at infinity which are where this hyperbola tends to.
        These two points in projective space correspond to two lines through the origin, specifically, they correspond to the lines making up the asymptotes of the hyperbola.
        
        In this case both the affine and zero locus of \(f\) carry essentially the same information.
        For the affine case we view this information as the points of the cone.
        For the projective case we view the cone as being formed from linear subspaces, and we then view the locus as only being one point per such a linear subspace, the point at which it intersects the (arbitrary) plane \(x_0 = 1\).
    \end{exm}
    
    We can formalise and generalise the correspondence between the affine and projective cases when we have cones like this.
    
    \begin{dfn}{Cone}{}
        Let \(\pi \colon \affine^{n+1} \setminus \{0\} \to \projective^n\) be the obvious map \((x_0, \dotsc, x_n) \mapsto \projCoord{x_0, \dotsc, x_n}\).
        \begin{enumerate}
            \item An affine variety, \(X \subseteq \affine^{n+1}\), is called a \defineindex{cone} if \(0 \in X\) and for all \(x \in X\) we have \(\lambda x \in X\) for \(\lambda \in K\).
            That is, \(X\) consists of the origin and a union of lines through the origin.
            \item For a cone, \(X \subseteq \affine^{n+1}\), its \defineindex{projectivsation} is
            \begin{equation}
                \projective(X) \coloneq \pi(X \setminus \{0\}) = \{\projCoord{x_0, \dotsc, x_n} \in \projective^n \mid (x_0, \dotsc, x_n) \in X\setminus \{0\}\} \subseteq \projective^n.
            \end{equation}
            \item For a projective variety, \(X \subseteq \projective^n\), the \define{cone} over \(X\) is
            \begin{equation}
                C(X) \coloneq \{0\} \cup \pi^{-1}(X) = \{0\} \cup \{(x_0, \dotsc, x_n) \mid \projCoord{x_0, \dotsc, x_n} \in X\} \subseteq \affine^{n+1}.
            \end{equation}
        \end{enumerate}
    \end{dfn}
    
    Note that the cone over the projective variety \(X\) is a cone in the first sense, since it contains \(0\) and the scaling invariance of the projective coordinates ensures it contains all scalar multiples of any of its points.
    
    Let \(S \subseteq K[x_0, \dotsc, x_n]\) be a set of non-constant homogeneous polynomials.
    Then \(V_{\symrm{a}}(S)\) is a cone.
    We have that \(0 \in V_{\symrm{a}}(S)\) as any non-constant homogeneous polynomial consists of monomials of the form \(x_{i_1} \dotsm x_{i_d}\) which vanish at \(0\).
    Further, if \(\lambda \in K\) and \(x \in V_{\symrm{a}}(S)\) then \(f(x) = 0\) for all \(f \in S\) and since the \(f\) are homogeneous we have \(f(\lambda x) = \lambda^{\deg f}f(x) = 0\) and thus \(\lambda x \in V_{\symrm{a}}(S)\) also.
    
    Conversely, if we take the ideal of a cone it is always homogeneous.
    Let \(X \subseteq \affine^{n+1}\) be a cone, and take \(f \in I_{\symrm{a}}(X)\).
    Then \(f\) has a homogeneous decomposition as a polynomial, \(f = \sum_{d \in \naturals} f_d\).
    For \(x \in X\) and \(\lambda \in K\) we have \(\lambda x \in X\) since \(X\) is a cone, and thus we have \(f(\lambda x) = 0\).
    Then we have
    \begin{equation}
        0 = f(\lambda x) = \sum_{d \in \naturals} f_d(\lambda x) = \sum_{d \in \naturals} \lambda^d f_d(x)
    \end{equation}
    and the right hand side can only be the zero polynomial if \(f_d(x) = 0\) for all \(x \in X\) and all \(d \in \naturals\), and thus \(f_d \in I_{\symrm{a}}(X)\), so \(I_{\symrm{a}}(X)\) is homogeneous by \cref{lma:homogeneous ideal properties}.
    
    \begin{lma}{}{}
        There is a bijection
        \begin{equation}
            \begin{aligned}
                \{\text{cones in } \affine^{n+1}\} &\leftrightarrow \{\text{projective varieties in } \projective^n\},\\
                X &\mapsto \projective(X),\\
                C(X) &\mapsfrom X.
            \end{aligned}
        \end{equation}
        \begin{proof}
            For a set \(S \subseteq K[x_0, \dotsc, x_n]\) of non-constant homogeneous polynomials we have
            \begin{equation}
                \projective(V_{\symrm{a}}(S)) = V_{\symrm{p}}(S), \qqand C(V_{\symrm{p}}(S)) = V_{\symrm{a}}(S).
            \end{equation}
            But \(V_{\symrm{a}}(S)\) is really itself just a cone by the work above, and further every cone is of this form, namely coming from a set of homogeneous generators of a homogeneous ideal, and every projective variety is also associated to such a set of homogeneous generators of a homogeneous ideal and so we are done.
        \end{proof}
    \end{lma}
    
    The correspondence between cones and projective varieties works by passing from the affine to the projective zero locus of the same set of homogeneous polynomials.
    
    Due to all these similarities in definitions and zero loci it is reasonable to expect that many results from the affine case carry over to the projective, and indeed this is the case.
    However, one of the most important results, Hilbert's Nullstellensatz, doesn't quite carry over without a slight change.
    We would like to have \(V(I(X)) = X\) and \(I(V(J)) = \sqrt{J}\), but there's a problem.
    This is usually true by reducing to the affine case with the identification with cones.
    However, the origin in \(\affine^{n+1}\) doesn't correspond to a point in \(\projective^n\), having all coordinates zero.
    The corresponding ideal to the origin of \(\affine^{n+1}\) is \(\langle x_0, \dotsc, x_n \rangle\), and we must exclude this idea from consideration.
    
    \begin{dfn}{Irrelevant Ideal}{}
        The radical homogeneous ideal
        \begin{equation}
            I_0 \coloneq \langle x_0, \dotsc, x_n \rangle \subideal K[x_0, \dotsc, x_n]
        \end{equation}
        is called the \defineindex{irrelevant ideal}.
    \end{dfn}
    
    \begin{prp}{Projective Nullstellensatz}{}
        \begin{enumerate}
            \item For any projective variety, \(X \subseteq \projective^n\), we have \(V(I(X)) = X\).
            \item For any homogeneous ideal, \(J \subideal K[x_0, \dotsc, x_n]\), with \(\sqrt{J} \ne I_0\) we have \(I(V(J)) = \sqrt{J}\).
        \end{enumerate}
        In particular, there is an inclusion-reversing bijection
        \begin{equation}
            \begin{aligned}
                \{\text{projective varieties in } \projective^n\} &\leftrightarrow \{\text{homogeneous radical ideals in } K[x_0, \dotsc, x_n] \text{ not equal to } I_0\},\\
                X &\mapsto I(X),\\
                 V(J) &\mapsfrom J.
            \end{aligned}
        \end{equation}
        \begin{proof}
            The first point, \(V(I(X)) = X\), follows in the same way as the affine case, and so does the inclusion \(I(V(J)) \supseteq \sqrt{J}\).
            The fact that \(V\) and \(I\) reverse inclusions also follows in the same way as the affine case.
            
            It remains then to show that \(I(V(J)) \subseteq \sqrt{J}\).
            To do so let \(J\) be a homogeneous ideal of \(K[x_0, \dotsc, x_n]\) such that \(\sqrt{J} \ne I_0\).
            Then we have
            \begin{equation*}
                I(V(J)) = \langle f \in K[x_0, \dotsc, x_n] \mid f \text{ homogeneous}, f(x) = 0 \forall x \in V(J) \rangle.
            \end{equation*}
            Viewing \(V(J)\) as a collection of lines through the origin we can replace it with the points making up these lines minus the origin, which doesn't correspond to a point in projective space.
            That is, we can replace \(V(J)\) with \(V_{\symrm{a}}(J) \setminus \{0\}\), giving
            \begin{equation*}
                I(V(J)) = \langle f \in K[x_0, \dotsc, x_n] \mid f \text{ homogeneous}, f(x) = 0 \forall x \in V_{\symrm{a}}(J) \setminus \{0\} \rangle.
            \end{equation*}
            Since the affine zero locus of polynomials is, by definition, closed we have \(\overline{V_{\symrm{a}}(J)} = V_{\symrm{a}}(J)\), and since \(\{0\}\) is an affine variety we also have \(\overline{\{0\}} = \{0\}\).
            Thus, we have \(\overline{V_{\symrm{a}}(J) \setminus \{0\}} = \overline{V_{\symrm{a}}(J)} \setminus \overline{\{0\}} = V_{\symrm{a}}(J) \setminus \{0\}\), and so
            \begin{equation*}
                I(V(J)) = \langle f \in K[x_0, \dotsc, x_n] \mid f \text{ homogeneous}, f(x) = 0 \forall x \in \overline{V_{\symrm{a}}(J) \setminus \{0\}} \rangle.
            \end{equation*}
            We know that \(V_{\symrm{a}}(J) \ne \{0\}\), because if this was the case we'd have \(\sqrt{J} = I_{\symrm{a}}(V_{\symrm{a}}(J)) = I_{\symrm{a}}(\{0\}) = I_0\), which we're assuming is not the case.
            Thus, we have \(I(V(J)) = I_{\symrm{a}}(V_{\symrm{a}}(J)) = \sqrt{J}\) where the last equality follows from the affine Nullstellensatz.
            
            The additional statement about the bijection now follows by the fact that \(I(X)\) is always radical, as the second part shows, and the fact that \(I(X) \ne I_0\) since if it was we'd have \(I_0 = I(V(I_0)) = I(\emptyset) = K[x_0, \dotsc, x_n]\), and \(I_0 \ne K[x_0, \dotsc, x_n]\), so this is a contradiction.
        \end{proof}
    \end{prp}
    
    \begin{remark}{}{}
        Most of the other properties of \(V\) and \(I\) carry over to the projective case, including the following:
        \begin{enumerate}
            \item For any two subsets, \(S_1, S_2 \subseteq K[x_0, \dotsc, x_n]\), of homogeneous polynomials we have \(V(S_1) \cup V(S_2) = V(S_1 S_2)\);
            \item For any family, \(S_i\), of subsets of \(K[x_0, \dotsc, x_n]\) of homogeneous polynomials we have \(\bigcap_i V(S_i) = V(S)\) where \(S = \bigcup_i S_i\).
            \item If \(J_1, J_2 \subideal K[x_0, \dotsc, x_n]\) are homogeneous ideals then
            \begin{equation}
                V(J_1) \cup V(J_2) = V(J_1 J_2) = V(J_1 \cap J_2), \qand V(J_1) \cap V(J_2) = V(J_1 + J_2).
            \end{equation}
            \item For any two projective varieties, \(X_1, X_2 \subseteq \projective^n\), we have \(I(X_1 \cap X_2) = \sqrt{I(X_1) + I(X_2)}\) so long as the latter is not the irrelevant ideal, and further we only get the irrelevant ideal if \(X_1\) and \(X_2\) are disjoint, for example \(X_1 = \{\projCoord{0,1}\} = V(x_0)\) and \(X_2 = \{\projCoord{1, 0}\} = V(x_1)\) in \(\projective^1\).
            Further, we have \(I(X_1 \cup X_2) = I(X_1) \cap I(X_2)\).
        \end{enumerate}
        The proofs of these results are very similar to the affine cases.
    \end{remark}
    
    Just as we did in the affine case we can construct the coordinate ring of a projective variety, and then work relative to another variety.
    
    \begin{dfn}{}{}
        Let \(X \subseteq \projective^n\) be a projective variety.
        We call
        \begin{equation}
            S(X) \coloneq K[x_0, \dotsc, x_n]/ I(X)
        \end{equation}
        the \defineindex{homogeneous coordinate ring} of \(X\).
    \end{dfn}
    
    This ring is a graded ring (\cref{lma:homogeneous ideal properties}) and so it makes sense to talk of homogeneous elements of \(S(X)\).
    Unlike in the affine case we cannot interpret elements of \(S(X)\) as functions on \(X\) since their values would be changed by rescaling of the homogeneous coordinates.
    For example, if we take \(f = x_0 \in K[x_0, x_1] = S(\projective^1)\) we have \(f(1, 1) = 1\) and \(f(-1, -1) = -1\) even though in \(\projective^1\) \(\projCoord{1,1} = \projCoord{{-}1,{-}1}\).
    Fortunately, the condition \(f(x) = 0\) is still well-defined for homogeneous \(f \in S(X)\), and so we can still define projective subvarieties of projective varieties as we did in the affine case.
    
    \begin{dfn}{}{}
        Let \(Y\) be a projective variety.
        For \(J\) a homogeneous ideal of \(S(Y)\) we set
        \begin{equation}
            V_Y(J) \coloneq \{x \in Y \mid f(x) = 0 \text{ for all homogeneous } f \in J\} \subseteq Y \subseteq \projective^n
        \end{equation}
        and for a subset, \(X \subseteq Y\), we set
        \begin{equation}
            I_Y(X) \coloneq \langle f \in S(Y) \mid f \text{ homogeneous}, f(x) = 0 \forall x \in X \rangle \subideal S(Y).
        \end{equation}
        We call all subsets of the form \(V_Y(J)\) for some homogeneous \(J \subideal S(Y)\) \define{projective subvarieties}\index{projective subvariety} of \(Y\).
    \end{dfn}
    
    As in the affine case we will usually drop the \(Y\) subscripts when it's clear we're working relative to \(Y\).
    We will also include or drop subscript \(\symrm{p}\) for projective as needed.
    
    Again, as in the affine case, projective subvarieties of \(Y\) are exactly the projective varieties which are contained entirely in \(Y\).
    Just as in the affine case the relative Nullstellensatz says that the properties of \(V\) and \(I\) transfer to this setting also.
    
    An occasionally useful property is that every projective subvariety, \(X\), of a projective variety, \(Y \subseteq \projective^n\), can be written as the zero locus of finitely many homogeneous polynomials in \(S(Y)\) of the same degree.
    This follows from the fact that \(V(f) = V(x_0^df, \dotsc, x_n^df)\) for all homogeneous \(f \in S(Y)\) and \(d \in \naturals\).
    So we can always take the polynomials we have and include finitely many more polynomials multiplied with appropriate powers of \(x_i\) to make the degrees the same.
    However, it is not true that every homogeneous ideal of \(S(Y)\) can be generated by homogeneous elements of the same degree.
    
    Following the affine case we can now define a topology on a projective variety, just as we did for the affine setting by recognising that arbitrary intersections and finite unions of subvarieties of a projective variety are again subvarieties, so the Zariski topology can be defined in the same way.
    
    \begin{dfn}{Zariski Topology}{}
        The \defineindex{Zariski topology} on a projective variety, \(X\), has as its closed sets projective subvarieties of \(X\).
    \end{dfn}
    
    From now on this is the topology we will use for all projective varieties (including \(\projective^n\)) and their subsets.
    Note that the Zariski topology on a projective subvariety is precisely the subspace topology.
    
    We want to consider \(\affine^n\) as a subset of \(\projective^n\), so we should check that the two Zariski topologies are compatible.
    To do so we need the following definition.
    
    \begin{dfn}{Homogenisation}{}
        \begin{enumerate}
            \item For a homogeneous polynomial, \(f \in K[x_0, \dotsc, x_n]\), the \defineindex{dehomogenisation} of \(f\) is the polynomial \(f^{\symrm{i}} \in K[x_1, \dotsc, x_n]\) obtained by setting \(x_0 = 1\).
            
            \item If \(f \in K[x_1, \dotsc, x_n]\) is a not-necessarily-homogeneous polynomial,
            \begin{equation}
                f = \sum_{i_1, \dotsc, i_n \in \naturals} a_{i_1, \dotsc, i_n} x_1^{i_1} \dotsm x_n^{i_n}
            \end{equation}
            its \defineindex{homogenisation} is the homogeneous polynomial, \(f^{\symrm{h}} \in K[x_0, \dotsc, x_n]\), given by
            \begin{equation}
                f^{\symrm{h}} = x_0^df\left( \frac{x_1}{x_0}, \dotsc, \frac{x_n}{x_0} \right) = \sum_{i_1, \dotsc, i_n \in \naturals} a_{i_1, \dotsc, i_n} x_0^{d - i_1 - \dotsb - i_n} x_1^{i_1} \dotsm x_n^{i_n}.
            \end{equation}
        \end{enumerate}
    \end{dfn}
    
    First, note that \(f^{\symrm{i}}\) is, in general, not homogeneous.
    For example, if \(f(x, y) = x^2 + xy + y^2\) then \(f^{\symrm{i}}(y) = 1 + y + y^2\).
    Evaluating at \(x_0 = 1\) is a ring homomorphism, that is
    \begin{equation}
        (fg)^{\symrm{i}} = f^{\symrm{i}} g^{\symrm{i}}, \qqand (f + g)^{\symrm{i}} = f^{\symrm{i}} + g^{\symrm{i}}.
    \end{equation}
    Further, this is clearly surjective, and so we can apply this construction directly to ideals.
    For a homogeneous ideal, \(J \subideal K[x_0, \dotsc, x_n]\), the dehomogeneisation is \(J^{\symrm{i}} = \{f^{\symrm{i}} \mid f \in J\}\), which is again an ideal.
    
    The construction of the homogenisation of \(f\) forces it to be homogeneous.
    However, it is not in general a ring homomorphism.
    If \(f, g \in K[x_1, \dotsc, x_n]\) are of degrees \(d\) and \(e\) respectively then
    \begin{equation}
        (fg)^{\symrm{h}} = x_0^{d + e} f\left( \frac{x_1}{x_0}, \dotsc, \frac{x_n}{x_0} \right) g\left( \frac{x_1}{x_0}, \dotsc, \frac{x_n}{x_0} \right) = f^{\symrm{h}} g^{\symrm{h}},
    \end{equation}
    but we do not in general have that \((f + g)^{\symrm{h}} = f^{\symrm{h}} + g^{\symrm{h}}\).
    In fact, if \(f\) and \(g\) have different degrees then \(f^{\symrm{h}} + g^{\symrm{h}}\) is not homogeneous.
    In order to apply this construction to an ideal, \(J \subideal K[x_1, \dotsc, x_n]\), we have to define \(J^{\symrm{h}} \subideal K[x_0, \dotsc, x_n]\) to be the ideal generated by \(f^{\symrm{h}}\) for all \(f \in J\).
    
    Note that \((f^{\symrm{h}})^{\symrm{i}} = f\) and \((f^{\symrm{i}})^{\symrm{h}}\).
    
    This now lets us view \(\affine^n\) as  a subset of \(\projective^n\).
    We want to identify the open set \(U_0 = \{\projCoord{x_0, \dotsc, x_n} \in \projective^n \mid x_0 \ne 0\} = \projective^n \setminus V(x_0)\) with \(\affine^n\) by the bijection
    \begin{equation}
        \begin{aligned}
            \affine^n &\to U_0,\\
            (x_1, \dotsc, x_n) &\mapsto \projCoord{1, x_1, \dotsc, x_n}.
        \end{aligned}
    \end{equation}
    With this identification the subspace topology of \(U_0\) is precisely the Zariski topology of \(\affine^n\) as an affine variety.
    If \(X = V(J) \cap \affine^n\) is closed in the subspace topology (for some \(J \subideal K[x_0, \dotsc, x_n]\) a homogeneous ideal) then \(X = V_{\symrm{a}}(J^{\symrm{i}})\) is also Zariski-closed.
    If \(X = V_{\symrm{a}}(J) \subseteq \affine^n\) is Zariski-closed (for some \(J \subideal K[x_1, \dotsc, x_n]\)) then \(X = V_{\symrm{p}}(J^{\symrm{h}}) \cap \affine^n\) is closed in the subspace topology as well.
    Thus this map is a homeomorphism.
    Once we've given projective varieties the structure of varieties we'll see this map is in fact an isomorphism of varieties.
    
    We can now port over all of the topological notions from the affine case, such as connectedness, irreducibility, and dimension.
    The geometric interpretation of these ideas is the same as in the affine case, since the points at infinity don't really change much of the geometric picture.
    
    All subsets, \(U_i = \{\projCoord{x_0, \dotsc, x_n} \in \projective^n \mid x_i \ne 0\}\), are homeomorphic to \(\affine^n\).
    These subsets cover \(\projective^n\) and have a non-empty intersection.
    After a small amount of work this allows one to show that \(\projective^n\) is irreducible, since each \(\affine^n\) is, and \(\dim \projective^n\) is the supremum of the dimensions of the \(\affine^n\), which is just \(n\).
    
    \begin{prp}{}{}
        Let \(J \subideal K[x_1, \dotsc, x_n]\) be an ideal.
        Consider its affine zero locus, \(X = V_{\symrm{a}}(J) \subseteq \affine^n\), and its closure, \(\overline{X}\), in \(\projective^n\).
        \begin{enumerate}
            \item \(\overline{X} = V(J^{\symrm{h}})\);
            \item if \(J = \langle f \rangle\) is a nonzero principal ideal then \(\overline{X} = V(f^{\symrm{h}})\).
        \end{enumerate}
        \begin{proof}
            Clearly \(V(J^{\symrm{h}})\) is closed and contains \(X\).
            To show that \(V(J^{\symrm{h}})\) is the smallest such set let \(Y \supseteq X\) be any closed set.
            We will prove that \(Y \supseteq V(J^{\symrm{h}})\).
            Since \(Y\) is closed \(Y = V(J')\) for some homogeneous ideal, \(J'\).
            Any homogeneous element of \(J'\) can be written as \(x_0^df^{\symrm{h}}\) for some \(d \in \naturals\) and \(f \in K[x_1, \dotsc, x_n]\).
            Then since \(X \subseteq Y\) we must have that \(x_0^df^{\symrm{h}}\) vanishes on \(X\).
            Since \(x_0 \ne 0\) on \(X \subseteq \affine^n\) it must be that \(f\) vanishes on \(X\).
            Thus, \(f \in I_{\symrm{a}}(X) = I_{\symrm{a}}(V_{\symrm{a}}(J)) = \sqrt{J}\).
            Thus, there exists \(m \in \naturals\) with \(f^m \in J\).
            Hence \((f^{\symrm{h}})^m = (f^m)^{\symrm{h}} \in J^{\symrm{h}}\) for some \(m \in \naturals\).
            Thus, \(f^{\symrm{h}} \in \sqrt{J^{\symrm{h}}}\) and so \(x_0^df^{\symrm{h}} \in \sqrt{J^{\symrm{h}}}\).
            Therefore \(J' \subseteq \sqrt{J^{\symrm{h}}}\) and so \(Y = V(J') \supseteq V(\sqrt{J^{\symrm{h}}}) = V(J^{\symrm{h}})\) as desired.
            
            Now suppose \(J = \langle f \rangle = \{fg \mid g \in K[x_1, \dotsc, x_n]\}\).
            Then we have
            \begin{equation}
                \overline{X} = V((fg)^{\symrm{h}} \mid g \in K[x_1, \dotsc, x_n]) = V(f^{\symrm{h}} g^{\symrm{h}} \mid g \in K[x_1, \dotsc, x_n]) = V(f^{\symrm{h}})
            \end{equation}
            by the first part.
        \end{proof}
    \end{prp}
    
    Let \(X\) be a hypersurface in \(\projective^n\), and assume without generality that it doesn't contain the set of points at infinity, \(V(x_0)\), as a component.
    Then \(Y = X \cap \affine^n\) is an affine hypersurface whose closure is \(X\).
    Thus, the ideal \(I(Y)\) is principal, generated by some \(g \in K[x_1, \dotsc, x_n]\).
    
    Setting \(f = g^{\symrm{h}} \in K[x_0, \dotsc, x_n]\) we have \(V(f) = \overline{Y} = X\), and since \(g\) has no repeated factors the same is true for \(f\), and thus \(I(X) = \langle f \rangle\).
    So, just as in the affine case the ideal of any projective hypersurface is principal, and so the notion of degree holds in the projective case.
    
    \begin{dfn}{}{}
        Let \(X\) be a hypersurface in \(\projective^n\) with ideal \(I(X) = \langle f \rangle\).
        Then the degree of \(f\) is also called the degree of \(X\), and we use the terms linear, quadric, and cubic for degree 1, 2, and 3 respectively.
    \end{dfn}
    
    Note, it is generally insufficient to homogenise just a set of generators.
    For example, if we take \(J = \langle x_1, x_2 - x_1^2 \rangle \subideal K[x_1, x_2]\) this has affine zero locus \(X = V_{\symrm{a}}(J) = \{0\} \subseteq \affine^2\).
    This one-point set is closed in \(\projective^2\), and thus \(\overline{X} = \{\projCoord{1,0,0}\}\) is just the corresponding point in homogeneous coordinates.
    However, if we homogenise the generators of \(J\) we get the homogeneous ideal \(\langle x_1, x_0x_2 - x_1^2\), which has projective zero locus \(V(J) = \{\projCoord{1,0,0},\projCoord{0,0,1}\} \supsetneq \overline{X}\), so we don't get the closure.
    
    The computational problem of homogenising all elements of an ideal is generally hard.
    The solution is to show that there's a special basis of \(J\), known as a Gro\"obner basis, and if we homogenise this then the result corresponds to \(\overline{X}\).
    This reduces the problem to finding such a basis and then homogenising the finite number of polynomials it contains.
    
    \chapter{Projective Varieties: Ringed Spaces}
    
    \appendixpage
    \begin{appendices}
        \include{appendices/comm-alg}
        \include{appendices/topology}
    \end{appendices}
    \printbibliography
    \backmatter
    \renewcommand{\glossaryname}{Acronyms}
    \printglossary[acronym]
    \printindex
\end{document}